"use strict";(self.webpackChunkworksheets_app_runtime=self.webpackChunkworksheets_app_runtime||[]).push([[6711],{50834:(Je,ae,p)=>{p.d(ae,{N:()=>N});var l=p(15861),u=p(65879),se=p(82668),e=p(65619),X=p(32013),E=p(16321),U=p(21473),F=p(4786);const V="$test_";function y(w){return w?w.split("\n").map(T=>{const g=T.match(/(def\s)(.*)(\(.*\)):/);return g?g[2].replace(/ /g,""):""}).filter(T=>!!T):[]}function J(w){return w.split("\n").map((T,g)=>(T.startsWith("def "+V)||T.startsWith("async def "+V))&&T.trimEnd().endsWith(":")?{line:g+1,state:"none",funcName:T.substring(T.indexOf(V)+6,T.indexOf("("))}:{}).filter(T=>T.funcName)}var k=p(24530),H=p(18942),x=p(2048),W=p(12044),I=p(96814),z=p(90690);const Y=["data = [",'\t{color: "blue", value: 10},','\t{color: "yellow", value: 20},','\t{color: "red", value: 15},','\t{color: "black", value: 25}',"]"],Q=[{group:"JSPY IDE Basics",snippets:[{title:"Print to console",script:'print("Hello World!") # Print to output console'},{title:"Asserts",script:['assert("My Test 1", 5 == 10, "Testing falsy assertion")','assert("My Test 2", 5 == 5, "Testing success assertion")'].join("\n")},{title:"Session usage",script:['# Save and restore data between "Runs" in a session object',"if session.someData == null:",'\tsession.someData = "some value" # or heavy load operation',"print(session.someData)"].join("\n")}]},{group:"Show Results As",snippets:[{title:"Show results in object explorer",script:[...Y,'showInObjectExplorer(data, "Tab title")'].join("\n")},{title:"Show results in JSON",script:[...Y,'showInJSON(data, "JSON")'].join("\n")},{title:"Create chart tab",script:"\ncountries = \"US,Canada,Mexico,Germany,UK,France,Italy,Japan,Korea,China\".split(\",\")\ndata = []\nfor country in countries:\n    item = {}\n    item.country = country\n    item.sales = Math.random() * 100 + 10\n    item.expenses = Math.random() * 200 + 10\n    item.downloads = Math.round(Math.random() * 100)\n    data.push(item)\n\n# https://www.grapecity.com/wijmo/demos/Chart/Overview/purejs\noptions = {\n    itemsSource: data,\n    bindingX: 'country',\n    legend: {\n        position: 'Bottom'\n    },\n    chartType: \"Line\",\n    legendToggle: true,\n    series: [\n        { binding: 'sales', name: 'sales' },\n        { binding: 'expenses', name: 'expenses' }\n    ]\n}\n\ncreateFlexChartTab(\"Countries Chart\", options)\n        "},{title:"Create grid tab",script:'\n  \ncountries = "US,Canada,Mexico,Germany,UK,France,Italy,Japan,Korea,China".split(",")\ndata = []\nfor country in countries:\n    item = {}\n    item.country = country\n    item.sales = Math.random() * 10000 + 1000\n    item.expenses = Math.random() * 5000 + 1000\n    item.downloads = Math.round(Math.random() * 100000)\n    data.push(item)\n    \n\n  createGridTab("Countries table").show(data)\n  '}]},{group:"IDE Notifications",snippets:[{title:"notify",script:'notify("Notification message")'},{title:"warning",script:'notify("Warning message", "Warning")'},{title:"alert",script:'alert("Alert message")'}]},{group:"Rest (HTTP) Calls",snippets:[{title:"httpGet request",script:['return httpGet("https://restcountries.com/v3.1/region/eu")'].join("\n")},{title:"httpPost request",script:['sendData = {name: "John"}','httpPost("url/to/post/data", sendData)'].join("\n")},{title:"httpDelete request",script:['httpDelete("url/to/delete/data")'].join("\n")},{title:"httpPut request",script:['updateData = {id: 1, name: "John"}','httpPut("url/to/update/data", updateData)'].join("\n")},{title:"fetch",script:["return {",'  objectValue: fetch("https://restcountries.eu/rest/v2/regionalbloc/eu").json(),','  text: fetch("https://raw.githubusercontent.com/FalconSoft/sample-data/master/CSV/sample-testing-data-100.csv").text()',"}"].join("\n")},{title:"httpRequest from sqlDataApi",script:['from "sql-data-api" import httpRequest',"","# use ","return {",'  object: httpRequest("GET", "https://restcountries.eu/rest/v2/regionalbloc/eu"),','  text: httpRequest("GET", "https://raw.githubusercontent.com/FalconSoft/sample-data/master/CSV/sample-testing-data-100.csv", null, {"Content-Type": "text/plain"})',"}"].join("\n")}]},{group:"sql Data Api",snippets:[{title:"query Sql Data",script:['from "sql-data-api" import sqlDataApi',"",'return sqlDataApi("northwind-db-connection")','\t.filter("title = @title", {title: "Sales Representative"})','\t.query("northwind.NorthwindEmployees", "Title, FirstName, LastName")'].join("\n")},{title:"Execute Stored Procedure",script:['from "sql-data-api" import sqlDataApi',"",'return sqlDataApi("northwind-db-connection")','\t.sqlExecute("northwind.NorthwindTop10CustomersList", {startDate: "2017-10-10"})'].join("\n")}]}];function A(w,L){if(1&w){const T=u.EpF();u.TgZ(0,"li")(1,"a",5),u.NdJ("click",function(){const R=u.CHM(T).$implicit,$=u.oxw(2);return u.KtG($.onSnippetClick(R.script))}),u._uU(2),u.qZA()()}if(2&w){const T=L.$implicit;u.xp6(2),u.Oqu(T.title)}}function j(w,L){if(1&w&&(u.TgZ(0,"div")(1,"h5"),u._uU(2),u.qZA(),u.TgZ(3,"ul"),u.YNc(4,A,3,1,"li",4),u.qZA()()),2&w){const T=L.$implicit;u.xp6(2),u.Oqu(T.group),u.xp6(2),u.Q6J("ngForOf",T.snippets)}}let q=(()=>{var w;class L{constructor(){this.snippetClick=new u.vpe,this.closeClick=new u.vpe,this.snippets=Q}onSnippetClick(g){this.snippetClick.next(g)}close(){this.closeClick.next(null)}}return(w=L).\u0275fac=function(g){return new(g||w)},w.\u0275cmp=u.Xpm({type:w,selectors:[["app-jspy-help-panel"]],outputs:{snippetClick:"snippetClick",closeClick:"closeClick"},decls:9,vars:1,consts:[[1,"content","m-2"],[1,"d-flex","flex-row","w-100"],["type","button","title","Close Panel",1,"btn","btn-sm","ml-auto",3,"click"],[1,"fa","fa-times"],[4,"ngFor","ngForOf"],[1,"cursor-pointer",3,"click"]],template:function(g,v){1&g&&(u.TgZ(0,"div",0)(1,"div",1)(2,"h3"),u._uU(3,"Code snippets"),u.qZA(),u.TgZ(4,"button",2),u.NdJ("click",function(){return v.close()}),u._UZ(5,"i",3),u.qZA()(),u.TgZ(6,"p"),u._uU(7," JSPython is a python-like scripting language to facilitate running multi-requests, data transformations, and testing tasks."),u.qZA(),u.YNc(8,j,5,2,"div",4),u.qZA()),2&g&&(u.xp6(8),u.Q6J("ngForOf",v.snippets))},dependencies:[I.sg],styles:['[_ngcontent-%COMP%]:root{--bg: #fff;--body-bg: #e4e5e6;--header-bg: #ebedef;--color: #4f5d73;--border-color: #c4c9d0;--ws-alt: #f7f7f7;--form-input-bg: #fff;--form-input-color: #768192;--nav-link-color: #8a93a2;--secondary-color: #c4c9d0;--opacity: .05;--hover: "#f0f3f5";--ag-edited-cell-bg: "rgba(255, 218, 218, 0.6)";--ag-added-cell-bg: "rgba(226, 255, 226, 0.5)"}.content[_ngcontent-%COMP%]{margin:1em;overflow-y:scroll}ul[_ngcontent-%COMP%]{padding-inline-start:.8em}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{list-style:none}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#20a8d8}']}),L})();function ge(w,L){if(1&w&&(u.TgZ(0,"div",9),u._uU(1),u.qZA()),2&w){const T=u.oxw();u.xp6(1),u.hij(" ",null==T.runParams?null:T.runParams.status," ")}}function vt(w,L){if(1&w&&(u.TgZ(0,"span",15),u._uU(1),u.qZA()),2&w){const T=u.oxw().$implicit;u.xp6(1),u.Oqu(T.errorMessage||"")}}function yt(w,L){if(1&w){const T=u.EpF();u.TgZ(0,"div",10)(1,"div"),u._UZ(2,"i"),u.qZA(),u.TgZ(3,"div",11)(4,"span",12),u.NdJ("click",function(){const R=u.CHM(T).$implicit,$=u.oxw();return u.KtG($.gotoLine(R))}),u._uU(5),u.qZA(),u.YNc(6,vt,2,1,"span",13),u.qZA(),u.TgZ(7,"button",14),u.NdJ("click",function(){const R=u.CHM(T).$implicit,$=u.oxw();return u.KtG($.runSelected(R))}),u._uU(8,"Run"),u.qZA()()}if(2&w){const T=L.$implicit,g=u.oxw();u.xp6(2),u.Gre("mr-2 fa fa-lg ",g.funcState(T),""),u.xp6(3),u.hij(" ",T.funcName," "),u.xp6(1),u.Q6J("ngIf","failed"===(null==T?null:T.state))}}let Ct=(()=>{var w;class L{constructor(){this.runAllClick=new u.vpe,this.runSelectedClick=new u.vpe,this.gotoLineClick=new u.vpe,this.runParallel=!1}funcName(g){return"failed"===g.state?`${g.funcName}: ${g.errorMessage}`:g.funcName}funcState(g){return"running"===g.state?"fa-spinner fa-spin":"completed"===g.state?"fa-check-square-o":"failed"===g.state?"fa-minus-square-o":"fa-square-o"}onRunParallelChange(){this.runParams&&(this.runParams.runParallel=!this.runParams.runParallel)}runAll(){this.runAllClick.next(null)}runSelected(g){this.runSelectedClick.next(g)}gotoLine(g){this.gotoLineClick.next(g)}}return(w=L).\u0275fac=function(g){return new(g||w)},w.\u0275cmp=u.Xpm({type:w,selectors:[["app-jspy-test-functions"]],inputs:{testFunctions:"testFunctions",runParams:"runParams"},outputs:{runAllClick:"runAllClick",runSelectedClick:"runSelectedClick",gotoLineClick:"gotoLineClick"},decls:11,vars:3,consts:[[1,"d-flex","flex-column","mx-2","h-100","overflow-hidden"],[1,"d-flex","flex-row","w-100"],["type","button","title","Run All",1,"btn","btn-sm","btn-success","m-1","mr-2",3,"click"],[1,"form-check","form-check-inline","mr-auto"],["type","checkbox","id","create-tabel",1,"form-check-input","mr-1",3,"checked","change"],["for","create-tabel",1,"form-check-label"],["class","d-flex flex-row w-100 my-2",4,"ngIf"],[1,"d-flex","flex-column","h-100","overflow-auto","mb-2"],["class","d-flex flex-row border-bottom border-gray align-items-center pb-1 mb-1",4,"ngFor","ngForOf"],[1,"d-flex","flex-row","w-100","my-2"],[1,"d-flex","flex-row","border-bottom","border-gray","align-items-center","pb-1","mb-1"],[1,"mr-1","w-100",2,"overflow-x","auto"],[1,"mr-2","mb-0","link-text","cursor-pointer",3,"click"],["class","text-danger",4,"ngIf"],[1,"btn","btn-run","btn-outline-success","ml-auto","mr-1",3,"click"],[1,"text-danger"]],template:function(g,v){1&g&&(u.TgZ(0,"div",0)(1,"div",1)(2,"button",2),u.NdJ("click",function(){return v.runAll()}),u._uU(3," Run All "),u.qZA(),u.TgZ(4,"div",3)(5,"input",4),u.NdJ("change",function(){return v.onRunParallelChange()}),u.qZA(),u.TgZ(6,"label",5),u._uU(7,"Parallel"),u.qZA()()(),u.YNc(8,ge,2,1,"div",6),u.TgZ(9,"div",7),u.YNc(10,yt,9,5,"div",8),u.qZA()()),2&g&&(u.xp6(5),u.Q6J("checked",null==v.runParams?null:v.runParams.runParallel),u.xp6(3),u.Q6J("ngIf",null==v.runParams?null:v.runParams.status),u.xp6(2),u.Q6J("ngForOf",v.testFunctions))},dependencies:[I.sg,I.O5],styles:['[_ngcontent-%COMP%]:root{--bg: #fff;--body-bg: #e4e5e6;--header-bg: #ebedef;--color: #4f5d73;--border-color: #c4c9d0;--ws-alt: #f7f7f7;--form-input-bg: #fff;--form-input-color: #768192;--nav-link-color: #8a93a2;--secondary-color: #c4c9d0;--opacity: .05;--hover: "#f0f3f5";--ag-edited-cell-bg: "rgba(255, 218, 218, 0.6)";--ag-added-cell-bg: "rgba(226, 255, 226, 0.5)"}.btn-run[_ngcontent-%COMP%]{height:22px;padding-top:0}.link-text[_ngcontent-%COMP%]:hover{text-decoration:underline}']}),L})();const ot=["editorEl"];function St(w,L){if(1&w){const T=u.EpF();u.TgZ(0,"app-jspy-test-functions",15),u.NdJ("runAllClick",function(){u.CHM(T);const v=u.oxw();return u.KtG(v.onRunAllTests())})("gotoLineClick",function(v){u.CHM(T);const R=u.oxw();return u.KtG(R.onGotoLine(v))})("runSelectedClick",function(v){u.CHM(T);const R=u.oxw();return u.KtG(R.onRunSelectedTest(v))}),u.qZA()}if(2&w){const T=u.oxw();u.Q6J("runParams",T.testRunsParams)("testFunctions",T.testFunctions)}}let N=(()=>{var w;class L{get jspyFunctions(){return this.jspyFunctionsListSubj$.value}constructor(g,v){this.resizeSvc=g,this.evaluationService=v,this.textChanged=new u.vpe,this.jspyFunctionsListSubj$=new e.X([]),this.evaluationResultSubj$=new X.x,this._evaluating=!1,this.cancelling=!1,this.testRunsParams={runParallel:!1,status:""},this.currentFileLinks=[],this.testFunctions=[],this.isHelpCollapsed=!1,this.jspyFunctionsList$=this.jspyFunctionsListSubj$.asObservable(),this.evaluationResult$=this.evaluationResultSubj$.asObservable(),this.direction=F.Ar.vertical,this.ShowInTypes=k.r,this.scriptSize=100,this.scriptHelpSize=30,this.minSize=20,this.selectedFunction=null,this.text=""}get evaluating(){return this._evaluating}set evaluating(g){this._evaluating=g,this.runtimeContext.evaluating=g}ngOnInit(){var g=this;return(0,l.Z)(function*(){g.resizeSvc.onResize$.subscribe(v=>{g.size=v,g.size<=U.yJ.MD&&(g.scriptHelpSize=0,g.isHelpCollapsed=!0)}),g.evaluationService.loading$.subscribe(v=>g.evaluating=v),g.runtimeContext=g.evaluationService.runtimeContext,g.interpreter=g.evaluationService.interpreter,g.evaluationContext=g.evaluationService.context,g.loadSettings(),g.initializeEditor(g.editorEl.nativeElement)})()}reload(g){this.editor?.setValue(g),this.mergeTestFunctions(J(this.text)),this.jspyFunctionsListSubj$.next(y(this.text))}setSettings(g){this.settings=g,this.settings.settingsKey&&this.loadSettings(),this.settings.moduleLoader&&this.interpreter?.registerModuleLoader(this.settings.moduleLoader)}initializeEditor(g){this.editor=se.editor.create(g,{tabSize:2,scrollBeyondLastLine:!1,value:this.text,language:"python"}),this.editor.onDidChangeModelContent(()=>{this.text=this.editor?.getValue()||"",this.textChanged.emit(this.text),this.jspyFunctionsListSubj$.next(y(this.text)),this.mergeTestFunctions(J(this.text))}),this.resize()}handleKeyboardEvent(g){("F5"===g.key||g.ctrlKey&&"Enter"===g.key)&&(g.preventDefault(),g.stopImmediatePropagation(),this.run(this.selectedFunction||""))}appendLogMessage(g,v,R){if(R){const $=this.runtimeContext.logs.find(_e=>_e.logKey===R);if($)return void("error"!==$.level&&($.level=g,$.message=v,"function"==typeof this.runtimeContext.onChanged&&this.runtimeContext.onChanged(this.runtimeContext.logs)))}this.runtimeContext.logs.push({level:g,logKey:R,message:v,time:new Date}),"function"==typeof this.runtimeContext.onChanged&&this.runtimeContext.onChanged(this.runtimeContext.logs)}cancelRun(){this.evaluationService.cancel()&&(this.cancelling=!0)}run(g){var v=this;return(0,l.Z)(function*(){yield v.evaluationService.run({script:v.text,method:g,entryModule:v.settings?.entryModule}),v.scriptSize=60,v.cancelling=!1,setTimeout(()=>{v.resultsPanel?.activateLastTab()},350)})()}startRuntimeOutputPanel(){this.scriptSize=60,this.runtimeContext.logs.splice(0,this.runtimeContext.logs.length),"function"==typeof this.runtimeContext.onChanged&&this.runtimeContext.onChanged(this.runtimeContext.logs),this.evaluationContext&&(this.evaluationContext.reset(),this.evaluationContext.showInItems=[{type:k.r.RunningLog,title:"Runtime Output",data:this.runtimeContext}],this.evaluationResultSubj$.next(null)),this.appendLogMessage("info","start")}onRunAllTests(){var g=this;return(0,l.Z)(function*(){yield g.runTest()})()}runTest(g){var v=this;return(0,l.Z)(function*(){var R;const $=function(Ce){return(R=R||(0,l.Z)(function*(re){try{re.state="running",yield v.evaluationService.jspyEvaluate({script:v.text,entryModule:v.settings?.entryModule,method:V+re.funcName}),re.state="completed"}catch(Tt){re.state="failed";let Oe=(0,U.e$)(Tt);Oe.startsWith("JspyEvalError:")&&(Oe=Oe.substring(Oe.indexOf("("))),re.errorMessage=Oe}})).apply(this,arguments)},_e=v.testFunctions;v.startRuntimeOutputPanel(),g||_e.forEach(ue=>ue.state="none");const Te=_e.find(ue=>"init"===ue.funcName.toLowerCase());if(!Te||(v.testRunsParams.status="Running INIT test ...",yield $(Te),"failed"!==Te.state))if(g)yield $(g);else{const ue=_e.filter(Ce=>Ce!=Te);if(v.testRunsParams.runParallel)v.testRunsParams.status=`Running ${ue.length} tests parallel ...`,yield Promise.all(ue.map(Ce=>$(Ce))),v.testRunsParams.status="";else{let Ce=1;for(const re of ue)v.testRunsParams.status=`Running test [${Ce++}:${ue.length}] ...'${re.funcName}' ...`,yield $(re);v.testRunsParams.status=""}}})()}onRunSelectedTest(g){var v=this;return(0,l.Z)(function*(){v.runTest(g)})()}onGotoLine(g){this.editor?.setPosition({lineNumber:g.line,column:1}),this.editor?.revealLineNearTop(g.line)}resize(){E.z.schedule(()=>{this.editor?.layout(),this.resultsPanel?.resize()})}toggleHelp(){this.isHelpCollapsed=!this.isHelpCollapsed,this.scriptHelpSize=this.isHelpCollapsed?0:30,this.saveSettings(),E.z.schedule(()=>this.resize())}toggleDirection(){this.direction=this.direction===F.Ar.horizontal?F.Ar.vertical:F.Ar.horizontal,this.saveSettings(),E.z.schedule(()=>this.resize())}onSnippetClick(g){if(!this.editor)throw new Error("editor is not initialized");const v=this.editor.getPosition();this.editor.executeEdits("",[{range:new se.Range(v?.lineNumber,v?.column,v?.lineNumber,v?.column),text:`\n${g.trim()}\n`}])}saveSettings(){this.settings?.settingsKey&&localStorage.setItem(this.settings.settingsKey,JSON.stringify({scriptHelpSize:this.scriptHelpSize,direction:this.direction,isHelpCollapsed:this.isHelpCollapsed}))}loadSettings(){if(!this.settings?.settingsKey)return;const g=JSON.parse(localStorage.getItem(this.settings.settingsKey)||"{}");this.scriptHelpSize=void 0!==g.scriptHelpSize?g.scriptHelpSize:30,this.direction=g.direction||F.Ar.vertical,this.isHelpCollapsed=!!g.isHelpCollapsed}mergeTestFunctions(g){this.testFunctions.splice(0,this.testFunctions.length),g.forEach(v=>this.testFunctions.push(v))}}return(w=L).\u0275fac=function(g){return new(g||w)(u.Y36(W._),u.Y36(x.N))},w.\u0275cmp=u.Xpm({type:w,selectors:[["app-jspy-content-editor"]],viewQuery:function(g,v){if(1&g&&(u.Gf(H.W,5),u.Gf(ot,7)),2&g){let R;u.iGM(R=u.CRH())&&(v.resultsPanel=R.first),u.iGM(R=u.CRH())&&(v.editorEl=R.first)}},hostBindings:function(g,v){1&g&&u.NdJ("keydown",function($){return v.handleKeyboardEvent($)},!1,u.evT)},outputs:{textChanged:"textChanged"},features:[u._Bn([x.N])],decls:18,vars:13,consts:[[1,"h-100",3,"direction","useTransition","transitionEnd","dragEnd"],["split","asSplit"],[1,"d-flex",3,"size","minSize"],["area1","asSplitArea"],["unit","percent","direction","horizontal",3,"useTransition","gutterSize","dragEnd","transitionEnd"],[1,"d-flex","position-relative","h-100",3,"size","minSize"],["type","button","title","Show/hide help panel",1,"btn","btn-secondary","btn-sm","px-1","py-0","position-absolute","help-toggle",3,"click"],[1,"fa","fa-question","fa-lg"],[1,"flex-fill","overflow-hidden"],["editorEl",""],["class","h-100 overflow-hidden","style","width:300px;min-width:300px",3,"runParams","testFunctions","runAllClick","gotoLineClick","runSelectedClick",4,"ngIf"],[1,"d-flex",3,"size"],[3,"snippetClick","closeClick"],[1,"position-relative",3,"size","minSize"],[3,"evaluationContext"],[1,"h-100","overflow-hidden",2,"width","300px","min-width","300px",3,"runParams","testFunctions","runAllClick","gotoLineClick","runSelectedClick"]],template:function(g,v){1&g&&(u.TgZ(0,"as-split",0,1),u.NdJ("transitionEnd",function(){return v.resize()})("dragEnd",function(){return v.resize()}),u.TgZ(2,"as-split-area",2,3)(4,"as-split",4,1),u.NdJ("dragEnd",function(){return v.resize()})("transitionEnd",function(){return v.resize()}),u.TgZ(6,"as-split-area",5,3)(8,"button",6),u.NdJ("click",function(){return v.toggleHelp()}),u._UZ(9,"i",7),u.qZA(),u._UZ(10,"div",8,9),u.YNc(12,St,1,2,"app-jspy-test-functions",10),u.qZA(),u.TgZ(13,"as-split-area",11,3)(15,"app-jspy-help-panel",12),u.NdJ("snippetClick",function($){return v.onSnippetClick($)})("closeClick",function(){return v.toggleHelp()}),u.qZA()()()(),u.TgZ(16,"as-split-area",13),u._UZ(17,"app-jspy-results-panel",14),u.qZA()()),2&g&&(u.Q6J("direction",v.direction)("useTransition",!0),u.xp6(2),u.Q6J("size",v.scriptSize)("minSize",v.minSize),u.xp6(2),u.Q6J("useTransition",!0)("gutterSize",v.isHelpCollapsed?0:11),u.xp6(2),u.Q6J("size",100-v.scriptHelpSize)("minSize",v.minSize),u.xp6(6),u.Q6J("ngIf",null==v.testFunctions?null:v.testFunctions.length),u.xp6(1),u.Q6J("size",v.scriptHelpSize),u.xp6(3),u.Q6J("size",100-v.scriptSize)("minSize",v.minSize),u.xp6(1),u.Q6J("evaluationContext",v.evaluationContext))},dependencies:[I.O5,z.Mq,z.zE,q,Ct,H.W],styles:[".help-toggle[_ngcontent-%COMP%]{top:5px;right:13px;z-index:1}"]}),L})()},18937:(Je,ae,p)=>{p.d(ae,{Y:()=>H});var l=p(65879),u=p(90690),se=p(37282),e=p(96814),X=p(56223);function E(x,W){1&x&&l.GkF(0)}function U(x,W){if(1&x&&(l.TgZ(0,"div",10),l.YNc(1,E,1,0,"ng-container",11),l.Hsn(2,2),l.qZA()),2&x){l.oxw();const I=l.MAs(12);l.xp6(1),l.Q6J("ngTemplateOutlet",I)}}function F(x,W){1&x&&l.GkF(0)}function V(x,W){if(1&x&&(l.ynx(0),l.YNc(1,F,1,0,"ng-container",11),l.BQk()),2&x){l.oxw();const I=l.MAs(12);l.xp6(1),l.Q6J("ngTemplateOutlet",I)}}const y=function(x){return{"ml-3":x}},J=function(x){return{"btn-sm":x}};function D(x,W){if(1&x){const I=l.EpF();l.TgZ(0,"div",12)(1,"label",13),l.NdJ("ngModelChange",function(Y){l.CHM(I);const S=l.oxw();return l.KtG(S.modeState.left=Y)})("click",function(){l.CHM(I);const Y=l.oxw();return l.KtG(Y.onModeState("left"))}),l.Hsn(2,3),l.qZA(),l.TgZ(3,"label",14),l.NdJ("ngModelChange",function(Y){l.CHM(I);const S=l.oxw();return l.KtG(S.modeState.right=Y)})("click",function(){l.CHM(I);const Y=l.oxw();return l.KtG(Y.onModeState("right"))}),l.Hsn(4,4),l.qZA()()}if(2&x){const I=l.oxw();l.Q6J("ngClass",l.VKq(9,y,I.toggleTop)),l.xp6(1),l.ekj("active",I.modeState.left),l.Q6J("ngClass",l.VKq(11,J,!I.toggleTop))("ngModel",I.modeState.left),l.xp6(2),l.ekj("active",I.modeState.right),l.Q6J("ngClass",l.VKq(13,J,!I.toggleTop))("ngModel",I.modeState.right)}}const b=[[["","left",""]],[["","right",""]],[["","actions",""]],[["","left-label",""]],[["","right-label",""]]],k=["[left]","[right]","[actions]","[left-label]","[right-label]"];let H=(()=>{var x;class W{constructor(){this.toggleTop=!1,this.direction="horizontal",this.resized=new l.vpe,this.leftContentSize=50,this.modeState={left:!0,right:!0}}ngOnInit(){"number"==typeof this.initLeftSize&&(this.leftContentSize=this.initLeftSize,100===this.initLeftSize?this.modeState.right=!1:0===this.initLeftSize&&(this.modeState.left=!1))}onModeState(z){this.modeState[z]=!this.modeState[z],this.leftContentSize=this.modeState.left&&!this.modeState.right?100:this.modeState.left&&this.modeState.right?50:0}resize(){this.resized.emit(this.modeState)}}return(x=W).\u0275fac=function(z){return new(z||x)},x.\u0275cmp=l.Xpm({type:x,selectors:[["app-split-content"]],inputs:{initLeftSize:"initLeftSize",direction:"direction"},outputs:{resized:"resized"},ngContentSelectors:k,decls:13,vars:7,consts:[[1,"card","overflow-hidden","mb-0","w-100","h-100"],["class","card-header d-flex pl-0 py-2 pr-2",4,"ngIf"],[1,"card-body","d-flex","p-0","flex-column","h-100"],[3,"useTransition","gutterSize","direction","dragEnd","transitionEnd"],[1,"d-flex","mb-0","position-relative",3,"size"],["area0","asSplitArea"],[1,"d-flex","overflow-auto","flex-column","explorer-section","position-relative",3,"size"],["area1","asSplitArea"],[4,"ngIf"],["toggles",""],[1,"card-header","d-flex","pl-0","py-2","pr-2"],[4,"ngTemplateOutlet"],[1,"btn-group","d-block",3,"ngClass"],["ngDefaultControl","","btnCheckbox","","tabindex","0","role","button","name","mode-left",1,"btn","btn-secondary","cursor-pointer","mb-0",3,"ngClass","ngModel","ngModelChange","click"],["ngDefaultControl","","btnCheckbox","","tabindex","0","role","button","name","mode-right",1,"btn","btn-secondary","cursor-pointer","mb-0",3,"ngClass","ngModel","ngModelChange","click"]],template:function(z,Y){1&z&&(l.F$t(b),l.TgZ(0,"div",0),l.YNc(1,U,3,1,"div",1),l.TgZ(2,"div",2)(3,"as-split",3),l.NdJ("dragEnd",function(){return Y.resize()})("transitionEnd",function(){return Y.resize()}),l.TgZ(4,"as-split-area",4,5),l.Hsn(6),l.qZA(),l.TgZ(7,"as-split-area",6,7),l.Hsn(9,1),l.qZA()()()(),l.YNc(10,V,2,1,"ng-container",8),l.YNc(11,D,5,15,"ng-template",null,9,l.W1O)),2&z&&(l.xp6(1),l.Q6J("ngIf",Y.toggleTop),l.xp6(2),l.Q6J("useTransition",!0)("gutterSize",50===Y.leftContentSize?11:0)("direction",Y.direction),l.xp6(1),l.Q6J("size",Y.leftContentSize),l.xp6(3),l.Q6J("size",100-Y.leftContentSize),l.xp6(3),l.Q6J("ngIf",!Y.toggleTop))},dependencies:[u.Mq,u.zE,se.DF,e.mk,e.O5,e.tP,X.Fj,X.JJ,X.On],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}"]}),W})()},61240:(Je,ae,p)=>{p.d(ae,{k:()=>F});var l=p(65879),u=p(76690),se=p(89250),e=p(32181),X=p(3202),E=p(13509),U=p(33374);let F=(()=>{var V;class y{constructor(D,b){this.fileManagerService=D,this.dialogService=b,this.changedContent=new l.vpe}openFile(){this.fileManagerService.importTextFile().then(D=>{"{"!==D[0]&&"["!==D[0]?D=(0,X.parseCsv)(D):D.indexOf('":')<0&&(D=JSON.stringify(u.R.parse(D))),this.setContent(D)})}openFileSettings(){this.dialogService.open(se.U,{initialState:{options:{take:1e3}}}).onClose$.pipe((0,e.h)(D=>!!D)).subscribe(D=>this.setContent(D.errorMessage?D:D.data))}setContent(D){this.currentTab?.content?.setJsonText(D),this.changedContent.emit(D)}}return(V=y).\u0275fac=function(D){return new(D||V)(l.Y36(E.j5),l.Y36(U.x))},V.\u0275cmp=l.Xpm({type:V,selectors:[["app-tab-json-content-actions"]],inputs:{currentTab:"currentTab"},outputs:{changedContent:"changedContent"},decls:5,vars:0,consts:[["data-toggle","buttons",1,"btn-group"],["type","button",1,"btn","btn-sm","btn-outline-secondary","button",3,"click"],["type","button","title","Open file partially. Works with large files",1,"btn","btn-sm","btn-outline-secondary","button",3,"click"],["aria-hidden","true",1,"fa","fa","fa-bars"]],template:function(D,b){1&D&&(l.TgZ(0,"div",0)(1,"button",1),l.NdJ("click",function(){return b.openFile()}),l._uU(2,"Open File"),l.qZA(),l.TgZ(3,"button",2),l.NdJ("click",function(){return b.openFileSettings()}),l._UZ(4,"i",3),l.qZA()())},styles:["ng-select[_ngcontent-%COMP%]{flex:0 1 150px}.button[_ngcontent-%COMP%]{color:var(--color)}"]}),y})()},92604:(Je,ae,p)=>{p.d(ae,{A:()=>Y});var l=p(65879),u=p(96814),se=p(56223),e=p(30641);const X=function(S,Q){return{"badge-success":S,"badge-danger":Q}};function E(S,Q){if(1&S&&(l.TgZ(0,"li",4)(1,"div",5)(2,"span",6),l._uU(3),l.qZA()(),l.TgZ(4,"div",7)(5,"div",8)(6,"b"),l._uU(7),l.qZA()(),l.TgZ(8,"div",9),l._uU(9),l.qZA()()()),2&S){const A=Q.$implicit;l.xp6(2),l.Q6J("ngClass",l.WLB(4,X,A.success,!A.success)),l.xp6(1),l.hij(" ",A.success?"Success":"Failed",""),l.xp6(4),l.Oqu(A.name),l.xp6(2),l.Oqu(A.description)}}function U(S,Q){if(1&S&&(l.TgZ(0,"ul",2),l.YNc(1,E,10,7,"li",3),l.qZA()),2&S){const A=l.oxw();l.xp6(1),l.Q6J("ngForOf",A.assertions)}}function F(S,Q){if(1&S&&(l.TgZ(0,"span",10),l._uU(1),l.qZA()),2&S){const A=l.oxw(),j=l.MAs(1);l.Q6J("ngClass",l.WLB(5,X,A.success,!A.success))("adaptivePosition",!1)("popover",j)("outsideClick",!0),l.xp6(1),l.hij(" ",A.stepsCount,"\n")}}let V=(()=>{var S;class Q{constructor(){}ngOnInit(){this.setState()}ngOnChanges(){this.setState()}setState(){this.assertions?(this.success=this.assertions.every(j=>j.success),this.stepsCount=this.assertions.length):this.stepsCount=0}}return(S=Q).\u0275fac=function(j){return new(j||S)},S.\u0275cmp=l.Xpm({type:S,selectors:[["app-assertion-logs"]],inputs:{assertions:"assertions"},features:[l.TTD],decls:3,vars:1,consts:[["logsTemplate",""],["class","badge align-self-stretch cursor-pointer px-2","placement","left","container","body","containerClass","assertion-logs-container","popoverTitle","Assertion logs",3,"ngClass","adaptivePosition","popover","outsideClick",4,"ngIf"],[1,"list-group","mb-2"],["class","list-group-item d-flex py-1 px-0",4,"ngFor","ngForOf"],[1,"list-group-item","d-flex","py-1","px-0"],[1,"px-1","status"],[1,"badge","p-1","w-100",3,"ngClass"],[1,"d-flex","flex-column"],[1,"px-1","my-auto"],[1,"px-1"],["placement","left","container","body","containerClass","assertion-logs-container","popoverTitle","Assertion logs",1,"badge","align-self-stretch","cursor-pointer","px-2",3,"ngClass","adaptivePosition","popover","outsideClick"]],template:function(j,q){1&j&&(l.YNc(0,U,2,1,"ng-template",null,0,l.W1O),l.YNc(2,F,2,8,"span",1)),2&j&&(l.xp6(2),l.Q6J("ngIf",q.stepsCount))},dependencies:[u.mk,u.sg,u.O5,e.k5],styles:[".status[_ngcontent-%COMP%]{flex:0 0 50px}  .assertion-logs-container.popover{max-width:400px;width:400px}.badge[_ngcontent-%COMP%]{line-height:1.5rem}"]}),Q})();var y=p(54807);function J(S,Q){1&S&&l._UZ(0,"app-assertion-logs",9),2&S&&l.Q6J("assertions",Q.ngIf)}function D(S,Q){if(1&S&&(l.TgZ(0,"span",10),l._uU(1),l.qZA()),2&S){const A=Q.ngIf;l.xp6(1),l.hij("",A/1e3," s")}}function b(S,Q){if(1&S){const A=l.EpF();l.TgZ(0,"ng-select",11),l.NdJ("ngModelChange",function(q){l.CHM(A);const ge=l.oxw();return l.KtG(ge.selectedFunction=q)}),l.qZA()}if(2&S){const A=l.oxw();l.Q6J("items",A.jspyFunctions)("ngModel",A.selectedFunction)("placeholder","Select function")}}function k(S,Q){1&S&&l._UZ(0,"span",12)}function H(S,Q){1&S&&(l.ynx(0),l._uU(1,"Run"),l.BQk())}function x(S,Q){if(1&S){const A=l.EpF();l.TgZ(0,"button",13),l.NdJ("click",function(){l.CHM(A);const q=l.oxw();return l.KtG(q.onScheduleRun())}),l._UZ(1,"i",14),l.qZA()}if(2&S){const A=l.oxw();l.Q6J("disabled",null==A.tabContent?null:A.tabContent.evaluating)}}function W(S,Q){1&S&&(l.ynx(0),l._uU(1,"Cancelling"),l.BQk())}function I(S,Q){1&S&&(l.ynx(0),l._uU(1,"Cancel"),l.BQk())}function z(S,Q){if(1&S){const A=l.EpF();l.TgZ(0,"button",15),l.NdJ("click",function(){l.CHM(A);const q=l.oxw();return l.KtG(null==q.tabContent?null:q.tabContent.cancelRun())}),l.YNc(1,W,2,0,"ng-container",6),l.YNc(2,I,2,0,"ng-container",6),l.qZA()}if(2&S){const A=l.oxw();l.Q6J("disabled",null==A.tabContent?null:A.tabContent.cancelling),l.xp6(1),l.Q6J("ngIf",null==A.tabContent?null:A.tabContent.cancelling),l.xp6(1),l.Q6J("ngIf",!(null!=A.tabContent&&A.tabContent.cancelling))}}let Y=(()=>{var S;class Q{constructor(){this.jspyFunctions=[],this.evaluationResult=null,this.subs=[]}get schedule(){return!!this.currentTab}ngOnInit(){this.subscribeOnTab()}ngOnChanges({currentTab:j}){j?.firstChange||this.subscribeOnTab()}ngOnDestroy(){this.clearSubscriptions()}get selectedFunction(){return this.tabContent?.selectedFunction||null}get tabContent(){return this.currentTab?.content?.contentEditor??this.jspyContentEditor}set selectedFunction(j){this.currentTab?.content&&this.tabContent&&(this.tabContent.selectedFunction=j)}onScheduleRun(){this.currentTab?.content?.scheduleRun(this.selectedFunction)}subscribeOnTab(){this.clearSubscriptions();const j=this.tabContent?.jspyFunctionsList$?.subscribe(ge=>this.jspyFunctions=ge);j&&this.subs.push(j);const q=this.tabContent?.evaluationResult$.subscribe(ge=>{this.evaluationResult=ge});q&&this.subs.push(q)}clearSubscriptions(){this.subs.forEach(j=>j?.unsubscribe()),this.subs=[]}}return(S=Q).\u0275fac=function(j){return new(j||S)},S.\u0275cmp=l.Xpm({type:S,selectors:[["app-jspy-actions"]],inputs:{currentTab:"currentTab",jspyContentEditor:"jspyContentEditor"},features:[l.TTD],decls:9,vars:8,consts:[["class","d-flex",3,"assertions",4,"ngIf"],["class","align-self-stretch badge badge-info",4,"ngIf"],["class","auto-grow px-0 ng-select-sm",3,"items","ngModel","placeholder","ngModelChange",4,"ngIf"],["data-toggle","buttons",1,"btn-group"],["type","button",1,"btn","btn-sm","run","btn-success",3,"disabled","click"],["class","spinner-border",4,"ngIf"],[4,"ngIf"],["type","button","class","btn btn-sm btn-success",3,"disabled","click",4,"ngIf"],["type","button","class","btn btn-sm btn-light","title","Cancel operation requested. Waiting for the current operation to be completed ...",3,"disabled","click",4,"ngIf"],[1,"d-flex",3,"assertions"],[1,"align-self-stretch","badge","badge-info"],[1,"auto-grow","px-0","ng-select-sm",3,"items","ngModel","placeholder","ngModelChange"],[1,"spinner-border"],["type","button",1,"btn","btn-sm","btn-success",3,"disabled","click"],["aria-hidden","true",1,"fa","fa","fa-clock-o"],["type","button","title","Cancel operation requested. Waiting for the current operation to be completed ...",1,"btn","btn-sm","btn-light",3,"disabled","click"]],template:function(j,q){1&j&&(l.YNc(0,J,1,1,"app-assertion-logs",0),l.YNc(1,D,2,1,"span",1),l.YNc(2,b,1,3,"ng-select",2),l.TgZ(3,"div",3)(4,"button",4),l.NdJ("click",function(){return null==q.tabContent?null:q.tabContent.run(q.selectedFunction||void 0)}),l.YNc(5,k,1,0,"span",5),l.YNc(6,H,2,0,"ng-container",6),l.qZA(),l.YNc(7,x,2,1,"button",7),l.qZA(),l.YNc(8,z,3,3,"button",8)),2&j&&(l.Q6J("ngIf",null==q.evaluationResult?null:q.evaluationResult.asserts),l.xp6(1),l.Q6J("ngIf",null==q.evaluationResult?null:q.evaluationResult.evaluationTime),l.xp6(1),l.Q6J("ngIf",null==q.jspyFunctions?null:q.jspyFunctions.length),l.xp6(2),l.Q6J("disabled",null==q.tabContent?null:q.tabContent.evaluating),l.xp6(1),l.Q6J("ngIf",null==q.tabContent?null:q.tabContent.evaluating),l.xp6(1),l.Q6J("ngIf",!(null!=q.tabContent&&q.tabContent.evaluating)),l.xp6(1),l.Q6J("ngIf",q.schedule),l.xp6(1),l.Q6J("ngIf",null==q.tabContent?null:q.tabContent.evaluating))},dependencies:[u.O5,se.JJ,se.On,V,y.w9],styles:["ng-select[_ngcontent-%COMP%]{min-width:150px}.badge[_ngcontent-%COMP%]{line-height:1.5rem}.btn.run[_ngcontent-%COMP%]{width:4rem;margin-right:1px}.btn.run[_ngcontent-%COMP%] + .btn[_ngcontent-%COMP%]{margin-left:0}[_nghost-%COMP%] > *[_ngcontent-%COMP%]:not(:last-child){margin-right:.5rem}"]}),Q})()},4080:(Je,ae,p)=>{p.r(ae),p.d(ae,{DataStudioModule:()=>ca});var l=p(96814),u=p(56223),se=p(69862),e=p(65879),X=p(16672),E=p(42495),U=p(62831),F=p(32181),V=p(48180),y=p(59773),J=p(49388);class I{attach(i){return this._attachedHost=i,i.attach(this)}detach(){let i=this._attachedHost;null!=i&&(this._attachedHost=null,i.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(i){this._attachedHost=i}}class z extends I{constructor(i,s,t,n,a){super(),this.component=i,this.viewContainerRef=s,this.injector=t,this.componentFactoryResolver=n,this.projectableNodes=a}}class Y extends I{constructor(i,s,t,n){super(),this.templateRef=i,this.viewContainerRef=s,this.context=t,this.injector=n}get origin(){return this.templateRef.elementRef}attach(i,s=this.context){return this.context=s,super.attach(i)}detach(){return this.context=void 0,super.detach()}}class S extends I{constructor(i){super(),this.element=i instanceof e.SBq?i.nativeElement:i}}class Q{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(i){return i instanceof z?(this._attachedPortal=i,this.attachComponentPortal(i)):i instanceof Y?(this._attachedPortal=i,this.attachTemplatePortal(i)):this.attachDomPortal&&i instanceof S?(this._attachedPortal=i,this.attachDomPortal(i)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(i){this._disposeFn=i}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class j extends Q{constructor(i,s,t,n,a){super(),this.outletElement=i,this._componentFactoryResolver=s,this._appRef=t,this._defaultInjector=n,this.attachDomPortal=r=>{const c=r.element,d=this._document.createComment("dom-portal");c.parentNode.insertBefore(d,c),this.outletElement.appendChild(c),this._attachedPortal=r,super.setDisposeFn(()=>{d.parentNode&&d.parentNode.replaceChild(c,d)})},this._document=a}attachComponentPortal(i){const t=(i.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(i.component);let n;return i.viewContainerRef?(n=i.viewContainerRef.createComponent(t,i.viewContainerRef.length,i.injector||i.viewContainerRef.injector,i.projectableNodes||void 0),this.setDisposeFn(()=>n.destroy())):(n=t.create(i.injector||this._defaultInjector||e.zs3.NULL),this._appRef.attachView(n.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(n.hostView),n.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(n)),this._attachedPortal=i,n}attachTemplatePortal(i){let s=i.viewContainerRef,t=s.createEmbeddedView(i.templateRef,i.context,{injector:i.injector});return t.rootNodes.forEach(n=>this.outletElement.appendChild(n)),t.detectChanges(),this.setDisposeFn(()=>{let n=s.indexOf(t);-1!==n&&s.remove(n)}),this._attachedPortal=i,t}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(i){return i.hostView.rootNodes[0]}}let ot=(()=>{var o;class i{}return(o=i).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({}),i})();var N=p(32013),w=p(55113),L=p(63019);const T=(0,U.Mq)();class g{constructor(i,s){this._viewportRuler=i,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=s}attach(){}enable(){if(this._canBeEnabled()){const i=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=i.style.left||"",this._previousHTMLStyles.top=i.style.top||"",i.style.left=(0,E.HM)(-this._previousScrollPosition.left),i.style.top=(0,E.HM)(-this._previousScrollPosition.top),i.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const i=this._document.documentElement,t=i.style,n=this._document.body.style,a=t.scrollBehavior||"",r=n.scrollBehavior||"";this._isEnabled=!1,t.left=this._previousHTMLStyles.left,t.top=this._previousHTMLStyles.top,i.classList.remove("cdk-global-scrollblock"),T&&(t.scrollBehavior=n.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),T&&(t.scrollBehavior=a,n.scrollBehavior=r)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const s=this._document.body,t=this._viewportRuler.getViewportSize();return s.scrollHeight>t.height||s.scrollWidth>t.width}}class R{constructor(i,s,t,n){this._scrollDispatcher=i,this._ngZone=s,this._viewportRuler=t,this._config=n,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(i){this._overlayRef=i}enable(){if(this._scrollSubscription)return;const i=this._scrollDispatcher.scrolled(0).pipe((0,F.h)(s=>!s||!this._overlayRef.overlayElement.contains(s.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=i.subscribe(()=>{const s=this._viewportRuler.getViewportScrollPosition().top;Math.abs(s-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=i.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class ${enable(){}disable(){}attach(){}}function _e(o,i){return i.some(s=>o.bottom<s.top||o.top>s.bottom||o.right<s.left||o.left>s.right)}function Te(o,i){return i.some(s=>o.top<s.top||o.bottom>s.bottom||o.left<s.left||o.right>s.right)}class ue{constructor(i,s,t,n){this._scrollDispatcher=i,this._viewportRuler=s,this._ngZone=t,this._config=n,this._scrollSubscription=null}attach(i){this._overlayRef=i}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const s=this._overlayRef.overlayElement.getBoundingClientRect(),{width:t,height:n}=this._viewportRuler.getViewportSize();_e(s,[{width:t,height:n,bottom:n,right:t,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let Ce=(()=>{var o;class i{constructor(t,n,a,r){this._scrollDispatcher=t,this._viewportRuler=n,this._ngZone=a,this.noop=()=>new $,this.close=c=>new R(this._scrollDispatcher,this._ngZone,this._viewportRuler,c),this.block=()=>new g(this._viewportRuler,this._document),this.reposition=c=>new ue(this._scrollDispatcher,this._viewportRuler,this._ngZone,c),this._document=r}}return(o=i).\u0275fac=function(t){return new(t||o)(e.LFG(X.mF),e.LFG(X.rL),e.LFG(e.R0b),e.LFG(l.K0))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),i})();class re{constructor(i){if(this.scrollStrategy=new $,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,i){const s=Object.keys(i);for(const t of s)void 0!==i[t]&&(this[t]=i[t])}}}class mn{constructor(i,s){this.connectionPair=i,this.scrollableViewProperties=s}}let xt=(()=>{var o;class i{constructor(t){this._attachedOverlays=[],this._document=t}ngOnDestroy(){this.detach()}add(t){this.remove(t),this._attachedOverlays.push(t)}remove(t){const n=this._attachedOverlays.indexOf(t);n>-1&&this._attachedOverlays.splice(n,1),0===this._attachedOverlays.length&&this.detach()}}return(o=i).\u0275fac=function(t){return new(t||o)(e.LFG(l.K0))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),i})(),gn=(()=>{var o;class i extends xt{constructor(t,n){super(t),this._ngZone=n,this._keydownListener=a=>{const r=this._attachedOverlays;for(let c=r.length-1;c>-1;c--)if(r[c]._keydownEvents.observers.length>0){const d=r[c]._keydownEvents;this._ngZone?this._ngZone.run(()=>d.next(a)):d.next(a);break}}}add(t){super.add(t),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return(o=i).\u0275fac=function(t){return new(t||o)(e.LFG(l.K0),e.LFG(e.R0b,8))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),i})(),_n=(()=>{var o;class i extends xt{constructor(t,n,a){super(t),this._platform=n,this._ngZone=a,this._cursorStyleIsSet=!1,this._pointerDownListener=r=>{this._pointerDownEventTarget=(0,U.sA)(r)},this._clickListener=r=>{const c=(0,U.sA)(r),d="click"===r.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:c;this._pointerDownEventTarget=null;const h=this._attachedOverlays.slice();for(let m=h.length-1;m>-1;m--){const f=h[m];if(f._outsidePointerEvents.observers.length<1||!f.hasAttached())continue;if(f.overlayElement.contains(c)||f.overlayElement.contains(d))break;const C=f._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>C.next(r)):C.next(r)}}}add(t){if(super.add(t),!this._isAttached){const n=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(n)):this._addEventListeners(n),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=n.style.cursor,n.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const t=this._document.body;t.removeEventListener("pointerdown",this._pointerDownListener,!0),t.removeEventListener("click",this._clickListener,!0),t.removeEventListener("auxclick",this._clickListener,!0),t.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(t.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(t){t.addEventListener("pointerdown",this._pointerDownListener,!0),t.addEventListener("click",this._clickListener,!0),t.addEventListener("auxclick",this._clickListener,!0),t.addEventListener("contextmenu",this._clickListener,!0)}}return(o=i).\u0275fac=function(t){return new(t||o)(e.LFG(l.K0),e.LFG(U.t4),e.LFG(e.R0b,8))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),i})(),wt=(()=>{var o;class i{constructor(t,n){this._platform=n,this._document=t}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t="cdk-overlay-container";if(this._platform.isBrowser||(0,U.Oy)()){const a=this._document.querySelectorAll(`.${t}[platform="server"], .${t}[platform="test"]`);for(let r=0;r<a.length;r++)a[r].remove()}const n=this._document.createElement("div");n.classList.add(t),(0,U.Oy)()?n.setAttribute("platform","test"):this._platform.isBrowser||n.setAttribute("platform","server"),this._document.body.appendChild(n),this._containerElement=n}}return(o=i).\u0275fac=function(t){return new(t||o)(e.LFG(l.K0),e.LFG(U.t4))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),i})();class bn{constructor(i,s,t,n,a,r,c,d,h,m=!1){this._portalOutlet=i,this._host=s,this._pane=t,this._config=n,this._ngZone=a,this._keyboardDispatcher=r,this._document=c,this._location=d,this._outsideClickDispatcher=h,this._animationsDisabled=m,this._backdropElement=null,this._backdropClick=new N.x,this._attachments=new N.x,this._detachments=new N.x,this._locationChanges=w.w0.EMPTY,this._backdropClickHandler=f=>this._backdropClick.next(f),this._backdropTransitionendHandler=f=>{this._disposeBackdrop(f.target)},this._keydownEvents=new N.x,this._outsidePointerEvents=new N.x,n.scrollStrategy&&(this._scrollStrategy=n.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=n.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(i){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const s=this._portalOutlet.attach(i);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe((0,V.q)(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof s?.onDestroy&&s.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),s}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const i=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),i}dispose(){const i=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,i&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(i){i!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=i,this.hasAttached()&&(i.attach(this),this.updatePosition()))}updateSize(i){this._config={...this._config,...i},this._updateElementSize()}setDirection(i){this._config={...this._config,direction:i},this._updateElementDirection()}addPanelClass(i){this._pane&&this._toggleClasses(this._pane,i,!0)}removePanelClass(i){this._pane&&this._toggleClasses(this._pane,i,!1)}getDirection(){const i=this._config.direction;return i?"string"==typeof i?i:i.value:"ltr"}updateScrollStrategy(i){i!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=i,this.hasAttached()&&(i.attach(this),i.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const i=this._pane.style;i.width=(0,E.HM)(this._config.width),i.height=(0,E.HM)(this._config.height),i.minWidth=(0,E.HM)(this._config.minWidth),i.minHeight=(0,E.HM)(this._config.minHeight),i.maxWidth=(0,E.HM)(this._config.maxWidth),i.maxHeight=(0,E.HM)(this._config.maxHeight)}_togglePointerEvents(i){this._pane.style.pointerEvents=i?"":"none"}_attachBackdrop(){const i="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(i)})}):this._backdropElement.classList.add(i)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const i=this._backdropElement;if(i){if(this._animationsDisabled)return void this._disposeBackdrop(i);i.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{i.addEventListener("transitionend",this._backdropTransitionendHandler)}),i.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(i)},500))}}_toggleClasses(i,s,t){const n=(0,E.Eq)(s||[]).filter(a=>!!a);n.length&&(t?i.classList.add(...n):i.classList.remove(...n))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const i=this._ngZone.onStable.pipe((0,y.R)((0,L.T)(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),i.unsubscribe())})})}_disposeScrollStrategy(){const i=this._scrollStrategy;i&&(i.disable(),i.detach&&i.detach())}_disposeBackdrop(i){i&&(i.removeEventListener("click",this._backdropClickHandler),i.removeEventListener("transitionend",this._backdropTransitionendHandler),i.remove(),this._backdropElement===i&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const kt="cdk-overlay-connected-position-bounding-box",vn=/([A-Za-z%]+)$/;class yn{get positions(){return this._preferredPositions}constructor(i,s,t,n,a){this._viewportRuler=s,this._document=t,this._platform=n,this._overlayContainer=a,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new N.x,this._resizeSubscription=w.w0.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(i)}attach(i){this._validatePositions(),i.hostElement.classList.add(kt),this._overlayRef=i,this._boundingBox=i.hostElement,this._pane=i.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const i=this._originRect,s=this._overlayRect,t=this._viewportRect,n=this._containerRect,a=[];let r;for(let c of this._preferredPositions){let d=this._getOriginPoint(i,n,c),h=this._getOverlayPoint(d,s,c),m=this._getOverlayFit(h,s,t,c);if(m.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(c,d);this._canFitWithFlexibleDimensions(m,h,t)?a.push({position:c,origin:d,overlayRect:s,boundingBoxRect:this._calculateBoundingBoxRect(d,c)}):(!r||r.overlayFit.visibleArea<m.visibleArea)&&(r={overlayFit:m,overlayPoint:h,originPoint:d,position:c,overlayRect:s})}if(a.length){let c=null,d=-1;for(const h of a){const m=h.boundingBoxRect.width*h.boundingBoxRect.height*(h.position.weight||1);m>d&&(d=m,c=h)}return this._isPushed=!1,void this._applyPosition(c.position,c.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(r.position,r.originPoint);this._applyPosition(r.position,r.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&xe(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(kt),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const i=this._lastPosition;if(i){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const s=this._getOriginPoint(this._originRect,this._containerRect,i);this._applyPosition(i,s)}else this.apply()}withScrollableContainers(i){return this._scrollables=i,this}withPositions(i){return this._preferredPositions=i,-1===i.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(i){return this._viewportMargin=i,this}withFlexibleDimensions(i=!0){return this._hasFlexibleDimensions=i,this}withGrowAfterOpen(i=!0){return this._growAfterOpen=i,this}withPush(i=!0){return this._canPush=i,this}withLockedPosition(i=!0){return this._positionLocked=i,this}setOrigin(i){return this._origin=i,this}withDefaultOffsetX(i){return this._offsetX=i,this}withDefaultOffsetY(i){return this._offsetY=i,this}withTransformOriginOn(i){return this._transformOriginSelector=i,this}_getOriginPoint(i,s,t){let n,a;if("center"==t.originX)n=i.left+i.width/2;else{const r=this._isRtl()?i.right:i.left,c=this._isRtl()?i.left:i.right;n="start"==t.originX?r:c}return s.left<0&&(n-=s.left),a="center"==t.originY?i.top+i.height/2:"top"==t.originY?i.top:i.bottom,s.top<0&&(a-=s.top),{x:n,y:a}}_getOverlayPoint(i,s,t){let n,a;return n="center"==t.overlayX?-s.width/2:"start"===t.overlayX?this._isRtl()?-s.width:0:this._isRtl()?0:-s.width,a="center"==t.overlayY?-s.height/2:"top"==t.overlayY?0:-s.height,{x:i.x+n,y:i.y+a}}_getOverlayFit(i,s,t,n){const a=Ot(s);let{x:r,y:c}=i,d=this._getOffset(n,"x"),h=this._getOffset(n,"y");d&&(r+=d),h&&(c+=h);let C=0-c,M=c+a.height-t.height,Z=this._subtractOverflows(a.width,0-r,r+a.width-t.width),ce=this._subtractOverflows(a.height,C,M),it=Z*ce;return{visibleArea:it,isCompletelyWithinViewport:a.width*a.height===it,fitsInViewportVertically:ce===a.height,fitsInViewportHorizontally:Z==a.width}}_canFitWithFlexibleDimensions(i,s,t){if(this._hasFlexibleDimensions){const n=t.bottom-s.y,a=t.right-s.x,r=At(this._overlayRef.getConfig().minHeight),c=At(this._overlayRef.getConfig().minWidth);return(i.fitsInViewportVertically||null!=r&&r<=n)&&(i.fitsInViewportHorizontally||null!=c&&c<=a)}return!1}_pushOverlayOnScreen(i,s,t){if(this._previousPushAmount&&this._positionLocked)return{x:i.x+this._previousPushAmount.x,y:i.y+this._previousPushAmount.y};const n=Ot(s),a=this._viewportRect,r=Math.max(i.x+n.width-a.width,0),c=Math.max(i.y+n.height-a.height,0),d=Math.max(a.top-t.top-i.y,0),h=Math.max(a.left-t.left-i.x,0);let m=0,f=0;return m=n.width<=a.width?h||-r:i.x<this._viewportMargin?a.left-t.left-i.x:0,f=n.height<=a.height?d||-c:i.y<this._viewportMargin?a.top-t.top-i.y:0,this._previousPushAmount={x:m,y:f},{x:i.x+m,y:i.y+f}}_applyPosition(i,s){if(this._setTransformOrigin(i),this._setOverlayElementStyles(s,i),this._setBoundingBoxStyles(s,i),i.panelClass&&this._addPanelClasses(i.panelClass),this._lastPosition=i,this._positionChanges.observers.length){const t=this._getScrollVisibility(),n=new mn(i,t);this._positionChanges.next(n)}this._isInitialRender=!1}_setTransformOrigin(i){if(!this._transformOriginSelector)return;const s=this._boundingBox.querySelectorAll(this._transformOriginSelector);let t,n=i.overlayY;t="center"===i.overlayX?"center":this._isRtl()?"start"===i.overlayX?"right":"left":"start"===i.overlayX?"left":"right";for(let a=0;a<s.length;a++)s[a].style.transformOrigin=`${t} ${n}`}_calculateBoundingBoxRect(i,s){const t=this._viewportRect,n=this._isRtl();let a,r,c,m,f,C;if("top"===s.overlayY)r=i.y,a=t.height-r+this._viewportMargin;else if("bottom"===s.overlayY)c=t.height-i.y+2*this._viewportMargin,a=t.height-c+this._viewportMargin;else{const M=Math.min(t.bottom-i.y+t.top,i.y),Z=this._lastBoundingBoxSize.height;a=2*M,r=i.y-M,a>Z&&!this._isInitialRender&&!this._growAfterOpen&&(r=i.y-Z/2)}if("end"===s.overlayX&&!n||"start"===s.overlayX&&n)C=t.width-i.x+this._viewportMargin,m=i.x-this._viewportMargin;else if("start"===s.overlayX&&!n||"end"===s.overlayX&&n)f=i.x,m=t.right-i.x;else{const M=Math.min(t.right-i.x+t.left,i.x),Z=this._lastBoundingBoxSize.width;m=2*M,f=i.x-M,m>Z&&!this._isInitialRender&&!this._growAfterOpen&&(f=i.x-Z/2)}return{top:r,left:f,bottom:c,right:C,width:m,height:a}}_setBoundingBoxStyles(i,s){const t=this._calculateBoundingBoxRect(i,s);!this._isInitialRender&&!this._growAfterOpen&&(t.height=Math.min(t.height,this._lastBoundingBoxSize.height),t.width=Math.min(t.width,this._lastBoundingBoxSize.width));const n={};if(this._hasExactPosition())n.top=n.left="0",n.bottom=n.right=n.maxHeight=n.maxWidth="",n.width=n.height="100%";else{const a=this._overlayRef.getConfig().maxHeight,r=this._overlayRef.getConfig().maxWidth;n.height=(0,E.HM)(t.height),n.top=(0,E.HM)(t.top),n.bottom=(0,E.HM)(t.bottom),n.width=(0,E.HM)(t.width),n.left=(0,E.HM)(t.left),n.right=(0,E.HM)(t.right),n.alignItems="center"===s.overlayX?"center":"end"===s.overlayX?"flex-end":"flex-start",n.justifyContent="center"===s.overlayY?"center":"bottom"===s.overlayY?"flex-end":"flex-start",a&&(n.maxHeight=(0,E.HM)(a)),r&&(n.maxWidth=(0,E.HM)(r))}this._lastBoundingBoxSize=t,xe(this._boundingBox.style,n)}_resetBoundingBoxStyles(){xe(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){xe(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(i,s){const t={},n=this._hasExactPosition(),a=this._hasFlexibleDimensions,r=this._overlayRef.getConfig();if(n){const m=this._viewportRuler.getViewportScrollPosition();xe(t,this._getExactOverlayY(s,i,m)),xe(t,this._getExactOverlayX(s,i,m))}else t.position="static";let c="",d=this._getOffset(s,"x"),h=this._getOffset(s,"y");d&&(c+=`translateX(${d}px) `),h&&(c+=`translateY(${h}px)`),t.transform=c.trim(),r.maxHeight&&(n?t.maxHeight=(0,E.HM)(r.maxHeight):a&&(t.maxHeight="")),r.maxWidth&&(n?t.maxWidth=(0,E.HM)(r.maxWidth):a&&(t.maxWidth="")),xe(this._pane.style,t)}_getExactOverlayY(i,s,t){let n={top:"",bottom:""},a=this._getOverlayPoint(s,this._overlayRect,i);return this._isPushed&&(a=this._pushOverlayOnScreen(a,this._overlayRect,t)),"bottom"===i.overlayY?n.bottom=this._document.documentElement.clientHeight-(a.y+this._overlayRect.height)+"px":n.top=(0,E.HM)(a.y),n}_getExactOverlayX(i,s,t){let r,n={left:"",right:""},a=this._getOverlayPoint(s,this._overlayRect,i);return this._isPushed&&(a=this._pushOverlayOnScreen(a,this._overlayRect,t)),r=this._isRtl()?"end"===i.overlayX?"left":"right":"end"===i.overlayX?"right":"left","right"===r?n.right=this._document.documentElement.clientWidth-(a.x+this._overlayRect.width)+"px":n.left=(0,E.HM)(a.x),n}_getScrollVisibility(){const i=this._getOriginRect(),s=this._pane.getBoundingClientRect(),t=this._scrollables.map(n=>n.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:Te(i,t),isOriginOutsideView:_e(i,t),isOverlayClipped:Te(s,t),isOverlayOutsideView:_e(s,t)}}_subtractOverflows(i,...s){return s.reduce((t,n)=>t-Math.max(n,0),i)}_getNarrowedViewportRect(){const i=this._document.documentElement.clientWidth,s=this._document.documentElement.clientHeight,t=this._viewportRuler.getViewportScrollPosition();return{top:t.top+this._viewportMargin,left:t.left+this._viewportMargin,right:t.left+i-this._viewportMargin,bottom:t.top+s-this._viewportMargin,width:i-2*this._viewportMargin,height:s-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(i,s){return"x"===s?null==i.offsetX?this._offsetX:i.offsetX:null==i.offsetY?this._offsetY:i.offsetY}_validatePositions(){}_addPanelClasses(i){this._pane&&(0,E.Eq)(i).forEach(s=>{""!==s&&-1===this._appliedPanelClasses.indexOf(s)&&(this._appliedPanelClasses.push(s),this._pane.classList.add(s))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(i=>{this._pane.classList.remove(i)}),this._appliedPanelClasses=[])}_getOriginRect(){const i=this._origin;if(i instanceof e.SBq)return i.nativeElement.getBoundingClientRect();if(i instanceof Element)return i.getBoundingClientRect();const s=i.width||0,t=i.height||0;return{top:i.y,bottom:i.y+t,left:i.x,right:i.x+s,height:t,width:s}}}function xe(o,i){for(let s in i)i.hasOwnProperty(s)&&(o[s]=i[s]);return o}function At(o){if("number"!=typeof o&&null!=o){const[i,s]=o.split(vn);return s&&"px"!==s?null:parseFloat(i)}return o||null}function Ot(o){return{top:Math.floor(o.top),right:Math.floor(o.right),bottom:Math.floor(o.bottom),left:Math.floor(o.left),width:Math.floor(o.width),height:Math.floor(o.height)}}const Mt=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom"}],Cn=[{originX:"end",originY:"top",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"start",overlayY:"bottom"},{originX:"start",originY:"top",overlayX:"end",overlayY:"top"},{originX:"start",originY:"bottom",overlayX:"end",overlayY:"bottom"}],Dt="cdk-global-overlay-wrapper";class Sn{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(i){const s=i.getConfig();this._overlayRef=i,this._width&&!s.width&&i.updateSize({width:this._width}),this._height&&!s.height&&i.updateSize({height:this._height}),i.hostElement.classList.add(Dt),this._isDisposed=!1}top(i=""){return this._bottomOffset="",this._topOffset=i,this._alignItems="flex-start",this}left(i=""){return this._xOffset=i,this._xPosition="left",this}bottom(i=""){return this._topOffset="",this._bottomOffset=i,this._alignItems="flex-end",this}right(i=""){return this._xOffset=i,this._xPosition="right",this}start(i=""){return this._xOffset=i,this._xPosition="start",this}end(i=""){return this._xOffset=i,this._xPosition="end",this}width(i=""){return this._overlayRef?this._overlayRef.updateSize({width:i}):this._width=i,this}height(i=""){return this._overlayRef?this._overlayRef.updateSize({height:i}):this._height=i,this}centerHorizontally(i=""){return this.left(i),this._xPosition="center",this}centerVertically(i=""){return this.top(i),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const i=this._overlayRef.overlayElement.style,s=this._overlayRef.hostElement.style,t=this._overlayRef.getConfig(),{width:n,height:a,maxWidth:r,maxHeight:c}=t,d=!("100%"!==n&&"100vw"!==n||r&&"100%"!==r&&"100vw"!==r),h=!("100%"!==a&&"100vh"!==a||c&&"100%"!==c&&"100vh"!==c),m=this._xPosition,f=this._xOffset,C="rtl"===this._overlayRef.getConfig().direction;let M="",Z="",ce="";d?ce="flex-start":"center"===m?(ce="center",C?Z=f:M=f):C?"left"===m||"end"===m?(ce="flex-end",M=f):("right"===m||"start"===m)&&(ce="flex-start",Z=f):"left"===m||"start"===m?(ce="flex-start",M=f):("right"===m||"end"===m)&&(ce="flex-end",Z=f),i.position=this._cssPosition,i.marginLeft=d?"0":M,i.marginTop=h?"0":this._topOffset,i.marginBottom=this._bottomOffset,i.marginRight=d?"0":Z,s.justifyContent=ce,s.alignItems=h?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const i=this._overlayRef.overlayElement.style,s=this._overlayRef.hostElement,t=s.style;s.classList.remove(Dt),t.justifyContent=t.alignItems=i.marginTop=i.marginBottom=i.marginLeft=i.marginRight=i.position="",this._overlayRef=null,this._isDisposed=!0}}let Tn=(()=>{var o;class i{constructor(t,n,a,r){this._viewportRuler=t,this._document=n,this._platform=a,this._overlayContainer=r}global(){return new Sn}flexibleConnectedTo(t){return new yn(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return(o=i).\u0275fac=function(t){return new(t||o)(e.LFG(X.rL),e.LFG(l.K0),e.LFG(U.t4),e.LFG(wt))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),i})(),xn=0,Be=(()=>{var o;class i{constructor(t,n,a,r,c,d,h,m,f,C,M,Z){this.scrollStrategies=t,this._overlayContainer=n,this._componentFactoryResolver=a,this._positionBuilder=r,this._keyboardDispatcher=c,this._injector=d,this._ngZone=h,this._document=m,this._directionality=f,this._location=C,this._outsideClickDispatcher=M,this._animationsModuleType=Z}create(t){const n=this._createHostElement(),a=this._createPaneElement(n),r=this._createPortalOutlet(a),c=new re(t);return c.direction=c.direction||this._directionality.value,new bn(r,n,a,c,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType)}position(){return this._positionBuilder}_createPaneElement(t){const n=this._document.createElement("div");return n.id="cdk-overlay-"+xn++,n.classList.add("cdk-overlay-pane"),t.appendChild(n),n}_createHostElement(){const t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(e.z2F)),new j(t,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return(o=i).\u0275fac=function(t){return new(t||o)(e.LFG(Ce),e.LFG(wt),e.LFG(e._Vd),e.LFG(Tn),e.LFG(gn),e.LFG(e.zs3),e.LFG(e.R0b),e.LFG(l.K0),e.LFG(J.Is),e.LFG(l.Ye),e.LFG(_n),e.LFG(e.QbO,8))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),i})();const An={provide:new e.OlP("cdk-connected-overlay-scroll-strategy"),deps:[Be],useFactory:function kn(o){return()=>o.scrollStrategies.reposition()}};let On=(()=>{var o;class i{}return(o=i).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[Be,An],imports:[J.vT,ot,X.Cl,X.Cl]}),i})();var P=p(36028),Ye=p(27921),Me=p(83620),Pt=p(93997),st=p(9769),at=p(21441),rt=p(57537),Et=p(94664),Mn=p(836);let lt=(()=>{var o;class i{constructor(){this._listeners=[]}notify(t,n){for(let a of this._listeners)a(t,n)}listen(t){return this._listeners.push(t),()=>{this._listeners=this._listeners.filter(n=>t!==n)}}ngOnDestroy(){this._listeners=[]}}return(o=i).\u0275fac=function(t){return new(t||o)},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),i})();var Le=p(92438),It=p(74911),Dn=p(23889),ct=p(4300);let ze=(()=>{var o;class i{}return(o=i).\u0275fac=function(t){return new(t||o)},o.\u0275dir=e.lG2({type:o,selectors:[["","cdkMenuGroup",""]],hostAttrs:["role","group",1,"cdk-menu-group"],exportAs:["cdkMenuGroup"],standalone:!0,features:[e._Bn([{provide:lt,useClass:lt}])]}),i})();const $e=new e.OlP("cdk-menu"),he=new e.OlP("cdk-menu-stack"),Pn={provide:he,deps:[[new e.FiY,new e.tp0,new e.tBr(he)]],useFactory:o=>o||new Ue},En=o=>({provide:he,deps:[[new e.FiY,new e.tp0,new e.tBr(he)]],useFactory:i=>i||Ue.inline(o)});let In=0,Ue=(()=>{var o;class i{constructor(){this.id=""+In++,this._elements=[],this._close=new N.x,this._empty=new N.x,this._hasFocus=new N.x,this.closed=this._close,this.hasFocus=this._hasFocus.pipe((0,Ye.O)(!1),(0,Me.b)(0),(0,Pt.x)()),this.emptied=this._empty,this._inlineMenuOrientation=null}static inline(t){const n=new i;return n._inlineMenuOrientation=t,n}push(t){this._elements.push(t)}close(t,n){const{focusNextOnEmpty:a,focusParentTrigger:r}={...n};if(this._elements.indexOf(t)>=0){let c;do{c=this._elements.pop(),this._close.next({item:c,focusParentTrigger:r})}while(c!==t);this.isEmpty()&&this._empty.next(a)}}closeSubMenuOf(t){let n=!1;if(this._elements.indexOf(t)>=0)for(n=this.peek()!==t;this.peek()!==t;)this._close.next({item:this._elements.pop()});return n}closeAll(t){const{focusNextOnEmpty:n,focusParentTrigger:a}={...t};if(!this.isEmpty()){for(;!this.isEmpty();){const r=this._elements.pop();r&&this._close.next({item:r,focusParentTrigger:a})}this._empty.next(n)}}isEmpty(){return!this._elements.length}length(){return this._elements.length}peek(){return this._elements[this._elements.length-1]}hasInlineMenu(){return null!=this._inlineMenuOrientation}inlineMenuOrientation(){return this._inlineMenuOrientation}setHasFocus(t){this._hasFocus.next(t)}}return(o=i).\u0275fac=function(t){return new(t||o)},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac}),i})();const Ge=new e.OlP("cdk-menu-trigger");let Ft=(()=>{var o;class i{constructor(){this.injector=(0,e.f3M)(e.zs3),this.viewContainerRef=(0,e.f3M)(e.s_b),this.menuStack=(0,e.f3M)(he),this.opened=new e.vpe,this.closed=new e.vpe,this.overlayRef=null,this.destroyed=new N.x,this.stopOutsideClicksListener=(0,L.T)(this.closed,this.destroyed)}ngOnDestroy(){this._destroyOverlay(),this.destroyed.next(),this.destroyed.complete()}isOpen(){return!!this.overlayRef?.hasAttached()}registerChildMenu(t){this.childMenu=t}getMenuContentPortal(){return this.menuTemplateRef&&(!this._menuPortal||this.menuTemplateRef!==this._menuPortal?.templateRef)&&(this._menuPortal=new Y(this.menuTemplateRef,this.viewContainerRef,this.menuData,this._getChildMenuInjector())),this._menuPortal}isElementInsideMenuStack(t){for(let n=t;n;n=n?.parentElement??null)if(n.getAttribute("data-cdk-menu-stack-id")===this.menuStack.id)return!0;return!1}_destroyOverlay(){this.overlayRef&&(this.overlayRef.dispose(),this.overlayRef=null)}_getChildMenuInjector(){return this._childMenuInjector=this._childMenuInjector||e.zs3.create({providers:[{provide:Ge,useValue:this},{provide:he,useValue:this.menuStack}],parent:this.injector}),this._childMenuInjector}}return(o=i).\u0275fac=function(t){return new(t||o)},o.\u0275dir=e.lG2({type:o,hostVars:2,hostBindings:function(t,n){2&t&&e.uIk("aria-controls",null==n.childMenu?null:n.childMenu.id)("data-cdk-menu-stack-id",n.menuStack.id)}}),i})();const Ve=new e.OlP("cdk-menu-aim");function Zt(o,i){if(!i.isTrusted)return!1;const s=o.nativeElement,t=i.keyCode;return"BUTTON"!==s.nodeName||s.disabled?"A"===s.nodeName&&t===P.K5:t===P.K5||t===P.L_}let Rt=(()=>{var o;class i extends Ft{constructor(){super(),this._elementRef=(0,e.f3M)(e.SBq),this._overlay=(0,e.f3M)(Be),this._ngZone=(0,e.f3M)(e.R0b),this._changeDetectorRef=(0,e.f3M)(e.sBO),this._inputModalityDetector=(0,e.f3M)(ct.QL),this._directionality=(0,e.f3M)(J.Is,{optional:!0}),this._parentMenu=(0,e.f3M)($e,{optional:!0}),this._menuAim=(0,e.f3M)(Ve,{optional:!0}),this._setRole(),this._registerCloseHandler(),this._subscribeToMenuStackClosed(),this._subscribeToMouseEnter(),this._subscribeToMenuStackHasFocus(),this._setType()}toggle(){this.isOpen()?this.close():this.open()}open(){!this.isOpen()&&null!=this.menuTemplateRef&&(this.opened.next(),this.overlayRef=this.overlayRef||this._overlay.create(this._getOverlayConfig()),this.overlayRef.attach(this.getMenuContentPortal()),this._changeDetectorRef.markForCheck(),this._subscribeToOutsideClicks())}close(){this.isOpen()&&(this.closed.next(),this.overlayRef.detach(),this._changeDetectorRef.markForCheck()),this._closeSiblingTriggers()}getMenu(){return this.childMenu}_toggleOnKeydown(t){const n="vertical"===this._parentMenu?.orientation;switch(t.keyCode){case P.L_:case P.K5:!(0,P.Vb)(t)&&!Zt(this._elementRef,t)&&(this.toggle(),this.childMenu?.focusFirstItem("keyboard"));break;case P.SV:(0,P.Vb)(t)||this._parentMenu&&n&&"rtl"!==this._directionality?.value&&(t.preventDefault(),this.open(),this.childMenu?.focusFirstItem("keyboard"));break;case P.oh:(0,P.Vb)(t)||this._parentMenu&&n&&"rtl"===this._directionality?.value&&(t.preventDefault(),this.open(),this.childMenu?.focusFirstItem("keyboard"));break;case P.JH:case P.LH:(0,P.Vb)(t)||n||(t.preventDefault(),this.open(),t.keyCode===P.JH?this.childMenu?.focusFirstItem("keyboard"):this.childMenu?.focusLastItem("keyboard"))}}_handleClick(){this.toggle(),this.childMenu?.focusFirstItem("mouse")}_setHasFocus(t){this._parentMenu||this.menuStack.setHasFocus(t)}_subscribeToMouseEnter(){this._ngZone.runOutsideAngular(()=>{(0,Le.R)(this._elementRef.nativeElement,"mouseenter").pipe((0,F.h)(()=>"touch"!==this._inputModalityDetector.mostRecentModality&&!this.menuStack.isEmpty()&&!this.isOpen()),(0,y.R)(this.destroyed)).subscribe(()=>{const t=()=>this._ngZone.run(()=>{this._closeSiblingTriggers(),this.open()});this._menuAim?this._menuAim.toggle(t):t()})})}_closeSiblingTriggers(){this._parentMenu?!this.menuStack.closeSubMenuOf(this._parentMenu)&&this.menuStack.peek()!==this._parentMenu&&this.menuStack.closeAll():this.menuStack.closeAll()}_getOverlayConfig(){return new re({positionStrategy:this._getOverlayPositionStrategy(),scrollStrategy:this._overlay.scrollStrategies.reposition(),direction:this._directionality||void 0})}_getOverlayPositionStrategy(){return this._overlay.position().flexibleConnectedTo(this._elementRef).withLockedPosition().withGrowAfterOpen().withPositions(this._getOverlayPositions())}_getOverlayPositions(){return this.menuPosition??(this._parentMenu&&"horizontal"!==this._parentMenu.orientation?Cn:Mt)}_registerCloseHandler(){this._parentMenu||this.menuStack.closed.pipe((0,y.R)(this.destroyed)).subscribe(({item:t})=>{t===this.childMenu&&this.close()})}_subscribeToOutsideClicks(){this.overlayRef&&this.overlayRef.outsidePointerEvents().pipe((0,y.R)(this.stopOutsideClicksListener)).subscribe(t=>{const n=(0,U.sA)(t),a=this._elementRef.nativeElement;n!==a&&!a.contains(n)&&(this.isElementInsideMenuStack(n)?this._closeSiblingTriggers():this.menuStack.closeAll())})}_subscribeToMenuStackHasFocus(){this._parentMenu||this.menuStack.hasFocus.pipe((0,y.R)(this.destroyed)).subscribe(t=>{t||this.menuStack.closeAll()})}_subscribeToMenuStackClosed(){this._parentMenu||this.menuStack.closed.subscribe(({focusParentTrigger:t})=>{t&&!this.menuStack.length()&&this._elementRef.nativeElement.focus()})}_setRole(){this._parentMenu||this._elementRef.nativeElement.setAttribute("role","button")}_setType(){const t=this._elementRef.nativeElement;"BUTTON"===t.nodeName&&!t.getAttribute("type")&&t.setAttribute("type","button")}}return(o=i).\u0275fac=function(t){return new(t||o)},o.\u0275dir=e.lG2({type:o,selectors:[["","cdkMenuTriggerFor",""]],hostAttrs:[1,"cdk-menu-trigger"],hostVars:2,hostBindings:function(t,n){1&t&&e.NdJ("focusin",function(){return n._setHasFocus(!0)})("focusout",function(){return n._setHasFocus(!1)})("keydown",function(r){return n._toggleOnKeydown(r)})("click",function(){return n._handleClick()}),2&t&&e.uIk("aria-haspopup",n.menuTemplateRef?"menu":null)("aria-expanded",null==n.menuTemplateRef?null:n.isOpen())},inputs:{menuTemplateRef:["cdkMenuTriggerFor","menuTemplateRef"],menuPosition:["cdkMenuPosition","menuPosition"],menuData:["cdkMenuTriggerData","menuData"]},outputs:{opened:"cdkMenuOpened",closed:"cdkMenuClosed"},exportAs:["cdkMenuTriggerFor"],standalone:!0,features:[e._Bn([{provide:Ge,useExisting:o},Pn]),e.qOj]}),i})(),De=(()=>{var o;class i{get disabled(){return this._disabled}set disabled(t){this._disabled=(0,E.Ig)(t)}get hasMenu(){return null!=this._menuTrigger?.menuTemplateRef}constructor(){this._dir=(0,e.f3M)(J.Is,{optional:!0}),this._elementRef=(0,e.f3M)(e.SBq),this._ngZone=(0,e.f3M)(e.R0b),this._inputModalityDetector=(0,e.f3M)(ct.QL),this._menuAim=(0,e.f3M)(Ve,{optional:!0}),this._menuStack=(0,e.f3M)(he),this._parentMenu=(0,e.f3M)($e,{optional:!0}),this._menuTrigger=(0,e.f3M)(Rt,{optional:!0,self:!0}),this._disabled=!1,this.triggered=new e.vpe,this._tabindex=-1,this.closeOnSpacebarTrigger=!0,this.destroyed=new N.x,this._setupMouseEnter(),this._setType(),this._isStandaloneItem()&&(this._tabindex=0)}ngOnDestroy(){this.destroyed.next(),this.destroyed.complete()}focus(){this._elementRef.nativeElement.focus()}trigger(t){const{keepOpen:n}={...t};!this.disabled&&!this.hasMenu&&(this.triggered.next(),n||this._menuStack.closeAll({focusParentTrigger:!0}))}isMenuOpen(){return!!this._menuTrigger?.isOpen()}getMenu(){return this._menuTrigger?.getMenu()}getMenuTrigger(){return this._menuTrigger}getLabel(){return this.typeaheadLabel||this._elementRef.nativeElement.textContent?.trim()||""}_resetTabIndex(){this._isStandaloneItem()||(this._tabindex=-1)}_setTabIndex(t){this.disabled||(!t||!this._menuStack.isEmpty())&&(this._tabindex=0)}_onKeydown(t){switch(t.keyCode){case P.L_:case P.K5:!(0,P.Vb)(t)&&!Zt(this._elementRef,t)&&this.trigger({keepOpen:t.keyCode===P.L_&&!this.closeOnSpacebarTrigger});break;case P.SV:(0,P.Vb)(t)||this._parentMenu&&this._isParentVertical()&&("rtl"!==this._dir?.value?this._forwardArrowPressed(t):this._backArrowPressed(t));break;case P.oh:(0,P.Vb)(t)||this._parentMenu&&this._isParentVertical()&&("rtl"!==this._dir?.value?this._backArrowPressed(t):this._forwardArrowPressed(t))}}_isStandaloneItem(){return!this._parentMenu}_backArrowPressed(t){const n=this._parentMenu;(this._menuStack.hasInlineMenu()||this._menuStack.length()>1)&&(t.preventDefault(),this._menuStack.close(n,{focusNextOnEmpty:"horizontal"===this._menuStack.inlineMenuOrientation()?1:2,focusParentTrigger:!0}))}_forwardArrowPressed(t){!this.hasMenu&&"horizontal"===this._menuStack.inlineMenuOrientation()&&(t.preventDefault(),this._menuStack.closeAll({focusNextOnEmpty:0,focusParentTrigger:!0}))}_setupMouseEnter(){if(!this._isStandaloneItem()){const t=()=>this._ngZone.run(()=>this._menuStack.closeSubMenuOf(this._parentMenu));this._ngZone.runOutsideAngular(()=>(0,Le.R)(this._elementRef.nativeElement,"mouseenter").pipe((0,F.h)(()=>"touch"!==this._inputModalityDetector.mostRecentModality&&!this._menuStack.isEmpty()&&!this.hasMenu),(0,y.R)(this.destroyed)).subscribe(()=>{this._menuAim?this._menuAim.toggle(t):t()}))}}_isParentVertical(){return"vertical"===this._parentMenu?.orientation}_setType(){const t=this._elementRef.nativeElement;"BUTTON"===t.nodeName&&!t.getAttribute("type")&&t.setAttribute("type","button")}}return(o=i).\u0275fac=function(t){return new(t||o)},o.\u0275dir=e.lG2({type:o,selectors:[["","cdkMenuItem",""]],hostAttrs:["role","menuitem",1,"cdk-menu-item"],hostVars:2,hostBindings:function(t,n){1&t&&e.NdJ("blur",function(){return n._resetTabIndex()})("focus",function(){return n._setTabIndex()})("click",function(){return n.trigger()})("keydown",function(r){return n._onKeydown(r)}),2&t&&(e.Ikx("tabindex",n._tabindex),e.uIk("aria-disabled",n.disabled||null))},inputs:{disabled:["cdkMenuItemDisabled","disabled"],typeaheadLabel:["cdkMenuitemTypeaheadLabel","typeaheadLabel"]},outputs:{triggered:"cdkMenuItemTriggered"},exportAs:["cdkMenuItem"],standalone:!0}),i})();class jn{constructor(i){this._items=i,this.entered=this._getItemPointerEntries(),this.exited=this._getItemPointerExits(),this._destroyed=new N.x,this.entered.subscribe(s=>this.activeElement=s),this.exited.subscribe(()=>{this.previousElement=this.activeElement,this.activeElement=void 0})}destroy(){this._destroyed.next(),this._destroyed.complete()}_getItemPointerEntries(){return(0,It.P)(()=>this._items.changes.pipe((0,Ye.O)(this._items),(0,st.z)(i=>i.map(s=>(0,Le.R)(s._elementRef.nativeElement,"mouseenter").pipe((0,at.h)(s),(0,y.R)(this._items.changes)))),(0,rt.J)()))}_getItemPointerExits(){return(0,It.P)(()=>this._items.changes.pipe((0,Ye.O)(this._items),(0,st.z)(i=>i.map(s=>(0,Le.R)(s._elementRef.nativeElement,"mouseout").pipe((0,at.h)(s),(0,y.R)(this._items.changes)))),(0,rt.J)()))}}let Hn=0,qt=(()=>{var o;class i extends ze{constructor(){super(...arguments),this.nativeElement=(0,e.f3M)(e.SBq).nativeElement,this.ngZone=(0,e.f3M)(e.R0b),this.menuStack=(0,e.f3M)(he),this.menuAim=(0,e.f3M)(Ve,{optional:!0,self:!0}),this.dir=(0,e.f3M)(J.Is,{optional:!0}),this.id="cdk-menu-"+Hn++,this.orientation="vertical",this.isInline=!1,this.destroyed=new N.x,this._menuStackHasFocus=!1}ngAfterContentInit(){this.isInline||this.menuStack.push(this),this._setKeyManager(),this._subscribeToMenuStackHasFocus(),this._subscribeToMenuOpen(),this._subscribeToMenuStackClosed(),this._setUpPointerTracker()}ngOnDestroy(){this.keyManager?.destroy(),this.destroyed.next(),this.destroyed.complete(),this.pointerTracker?.destroy()}focusFirstItem(t="program"){this.keyManager.setFocusOrigin(t),this.keyManager.setFirstItemActive()}focusLastItem(t="program"){this.keyManager.setFocusOrigin(t),this.keyManager.setLastItemActive()}_getTabIndex(){return this.isInline?this._menuStackHasFocus?-1:0:null}closeOpenMenu(t,n){const{focusParentTrigger:a}={...n},r=this.keyManager,c=this.triggerItem;t===c?.getMenuTrigger()?.getMenu()&&(c?.getMenuTrigger()?.close(),a&&(c?r.setActiveItem(c):r.setFirstItemActive()))}_setKeyManager(){this.keyManager=new ct.Em(this.items).withWrap().withTypeAhead().withHomeAndEnd(),"horizontal"===this.orientation?this.keyManager.withHorizontalOrientation(this.dir?.value||"ltr"):this.keyManager.withVerticalOrientation()}_subscribeToMenuOpen(){const t=(0,L.T)(this.items.changes,this.destroyed);this.items.changes.pipe((0,Ye.O)(this.items),(0,st.z)(n=>n.filter(a=>a.hasMenu).map(a=>a.getMenuTrigger().opened.pipe((0,at.h)(a),(0,y.R)(t)))),(0,rt.J)(),(0,Et.w)(n=>(this.triggerItem=n,n.getMenuTrigger().closed)),(0,y.R)(this.destroyed)).subscribe(()=>this.triggerItem=void 0)}_subscribeToMenuStackClosed(){this.menuStack.closed.pipe((0,y.R)(this.destroyed)).subscribe(({item:t,focusParentTrigger:n})=>this.closeOpenMenu(t,{focusParentTrigger:n}))}_subscribeToMenuStackHasFocus(){this.isInline&&this.menuStack.hasFocus.pipe((0,y.R)(this.destroyed)).subscribe(t=>{this._menuStackHasFocus=t})}_setUpPointerTracker(){this.menuAim&&(this.ngZone.runOutsideAngular(()=>{this.pointerTracker=new jn(this.items)}),this.menuAim.initialize(this,this.pointerTracker))}}return(o=i).\u0275fac=function(){let s;return function(n){return(s||(s=e.n5z(o)))(n||o)}}(),o.\u0275dir=e.lG2({type:o,contentQueries:function(t,n,a){if(1&t&&e.Suo(a,De,5),2&t){let r;e.iGM(r=e.CRH())&&(n.items=r)}},hostAttrs:["role","menu"],hostVars:4,hostBindings:function(t,n){1&t&&e.NdJ("focus",function(){return n.focusFirstItem()})("focusin",function(){return n.menuStack.setHasFocus(!0)})("focusout",function(){return n.menuStack.setHasFocus(!1)}),2&t&&(e.Ikx("tabindex",n._getTabIndex())("id",n.id),e.uIk("aria-orientation",n.orientation)("data-cdk-menu-stack-id",n.menuStack.id))},inputs:{id:"id"},features:[e.qOj]}),i})(),Jt=(()=>{var o;class i extends qt{constructor(){super(),this._parentTrigger=(0,e.f3M)(Ge,{optional:!0}),this.closed=new e.vpe,this.orientation="vertical",this.isInline=!this._parentTrigger,this.destroyed.subscribe(this.closed),this._parentTrigger?.registerChildMenu(this)}ngAfterContentInit(){super.ngAfterContentInit(),this._subscribeToMenuStackEmptied()}ngOnDestroy(){super.ngOnDestroy(),this.closed.complete()}_handleKeyEvent(t){const n=this.keyManager;switch(t.keyCode){case P.oh:case P.SV:(0,P.Vb)(t)||(t.preventDefault(),n.setFocusOrigin("keyboard"),n.onKeydown(t));break;case P.hY:(0,P.Vb)(t)||(t.preventDefault(),this.menuStack.close(this,{focusNextOnEmpty:2,focusParentTrigger:!0}));break;case P.Mf:(0,P.Vb)(t,"altKey","metaKey","ctrlKey")||this.menuStack.closeAll({focusParentTrigger:!0});break;default:n.onKeydown(t)}}_toggleMenuFocus(t){const n=this.keyManager;switch(t){case 0:n.setFocusOrigin("keyboard"),n.setNextItemActive();break;case 1:n.setFocusOrigin("keyboard"),n.setPreviousItemActive();break;case 2:n.activeItem&&(n.setFocusOrigin("keyboard"),n.setActiveItem(n.activeItem))}}_subscribeToMenuStackEmptied(){this.menuStack.emptied.pipe((0,y.R)(this.destroyed)).subscribe(t=>this._toggleMenuFocus(t))}}return(o=i).\u0275fac=function(t){return new(t||o)},o.\u0275dir=e.lG2({type:o,selectors:[["","cdkMenu",""]],hostAttrs:["role","menu",1,"cdk-menu"],hostVars:2,hostBindings:function(t,n){1&t&&e.NdJ("keydown",function(r){return n._handleKeyEvent(r)}),2&t&&e.ekj("cdk-menu-inline",n.isInline)},outputs:{closed:"closed"},exportAs:["cdkMenu"],standalone:!0,features:[e._Bn([{provide:ze,useExisting:o},{provide:$e,useExisting:o},En("vertical")]),e.qOj]}),i})();const $n=Mt.map(o=>{const i="start"===o.overlayX?2:-2,s="top"===o.overlayY?2:-2;return{...o,offsetX:i,offsetY:s}});let Un=(()=>{var o;class i{update(t){i._openContextMenuTrigger!==t&&(i._openContextMenuTrigger?.close(),i._openContextMenuTrigger=t)}}return(o=i).\u0275fac=function(t){return new(t||o)},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),i})(),Lt=(()=>{var o;class i extends Ft{get disabled(){return this._disabled}set disabled(t){this._disabled=(0,E.Ig)(t)}constructor(){super(),this._overlay=(0,e.f3M)(Be),this._directionality=(0,e.f3M)(J.Is,{optional:!0}),this._contextMenuTracker=(0,e.f3M)(Un),this._disabled=!1,this._setMenuStackCloseListener()}open(t){this._open(t,!1)}close(){this.menuStack.closeAll()}_openOnContextMenu(t){this.disabled||(t.preventDefault(),t.stopPropagation(),this._contextMenuTracker.update(this),this._open({x:t.clientX,y:t.clientY},!0),this.childMenu?.focusFirstItem(2===t.button?"mouse":0===t.button?"keyboard":"program"))}_getOverlayConfig(t){return new re({positionStrategy:this._getOverlayPositionStrategy(t),scrollStrategy:this._overlay.scrollStrategies.reposition(),direction:this._directionality||void 0})}_getOverlayPositionStrategy(t){return this._overlay.position().flexibleConnectedTo(t).withLockedPosition().withGrowAfterOpen().withPositions(this.menuPosition??$n)}_setMenuStackCloseListener(){this.menuStack.closed.pipe((0,y.R)(this.destroyed)).subscribe(({item:t})=>{t===this.childMenu&&this.isOpen()&&(this.closed.next(),this.overlayRef.detach())})}_subscribeToOutsideClicks(t){if(this.overlayRef){let n=this.overlayRef.outsidePointerEvents();if(t){const[a,r]=(0,Dn.u)(n,({type:c})=>"auxclick"===c);n=(0,L.T)(r,a.pipe((0,Mn.T)(1)))}n.pipe((0,y.R)(this.stopOutsideClicksListener)).subscribe(a=>{this.isElementInsideMenuStack((0,U.sA)(a))||this.menuStack.closeAll()})}}_open(t,n){this.disabled||(this.isOpen()?(this.menuStack.closeSubMenuOf(this.childMenu),this.overlayRef.getConfig().positionStrategy.setOrigin(t),this.overlayRef.updatePosition()):(this.opened.next(),this.overlayRef?(this.overlayRef.getConfig().positionStrategy.setOrigin(t),this.overlayRef.updatePosition()):this.overlayRef=this._overlay.create(this._getOverlayConfig(t)),this.overlayRef.attach(this.getMenuContentPortal()),this._subscribeToOutsideClicks(n)))}}return(o=i).\u0275fac=function(t){return new(t||o)},o.\u0275dir=e.lG2({type:o,selectors:[["","cdkContextMenuTriggerFor",""]],hostVars:1,hostBindings:function(t,n){1&t&&e.NdJ("contextmenu",function(r){return n._openOnContextMenu(r)}),2&t&&e.uIk("data-cdk-menu-stack-id",null)},inputs:{menuTemplateRef:["cdkContextMenuTriggerFor","menuTemplateRef"],menuPosition:["cdkContextMenuPosition","menuPosition"],menuData:["cdkContextMenuTriggerData","menuData"],disabled:["cdkContextMenuDisabled","disabled"]},outputs:{opened:"cdkContextMenuOpened",closed:"cdkContextMenuClosed"},exportAs:["cdkContextMenuTriggerFor"],standalone:!0,features:[e._Bn([{provide:Ge,useExisting:o},{provide:he,useClass:Ue}]),e.qOj]}),i})(),Gn=(()=>{var o;class i{}return(o=i).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[On]}),i})();var ut=p(72237),jt=p(6966),G=p(72500),we=p(90690),Ke=p(54807),Ee=p(53546),Vn=p(48081),ee=p(71997),Ht=p(28946),K=p(75187),dt=p(85027),_=p(15861),fe=p(82668),te=p(4786),be=p(30046),ke=p(61862),Kn=p(61794),Qt=p(58051);class ti{constructor(i,s=(()=>[])){this.executionContext=i,this.modulesList=s,this.interpreter=(0,Kn.R)()}provideCompletionItems(i,s,t,n){const a=this.executionContext(),r=i.getLineContent(s.lineNumber),c=i.getWordUntilPosition(s).word,d=this;function h(){const f={};return d.modulesList().concat((0,Qt.P0)()).forEach(C=>f[C]=C),f}function m(f,C){if(!f)return{suggestions:[]};let M={};if(r.startsWith("import"))M=h();else if(r.startsWith("from")){const Z=r.split(" ");M=Z.length>2?(0,Qt.oz)((0,ke.trim)(Z[1],"\"'")):h()}else M=Array.isArray(f)?Array.prototype:"string"==typeof f?String.prototype:f;return{suggestions:Object.getOwnPropertyNames(M||{}).filter(Z=>!C||Z.indexOf(C)>=0).map(Z=>({label:Z,kind:"function"==typeof f[Z]?fe.languages.CompletionItemKind.Function:fe.languages.CompletionItemKind.Field,insertText:Z}))}}if(r.endsWith(".")){const f=r.split(".");let C=a;for(let M=0;M<f.length-1&&(C=C[f[M]],C);M++);return m(C,f[f.length-1])}return m(a,c)}resolveCompletionItem(i,s){return null}}var Bt=p(46681);function Xe(o,i,s){return o?.length>i?o[i]:s}const Yt=["select","from","where","on","left","inner","full","cross","insert","update","delete","top","go"];class si{constructor(i,s,t){this.getConnectionName=i,this.getDbObjects=s,this.getFields=t}getFromTables(i){let s=-1;const t={};let n="",a="";for(;++s<i.length;){const c=i[s];("from"===c.toLowerCase()||"join"===c.toLowerCase())&&(n=i[++s],"as"===i[s+1]?.toLowerCase()?(s+=2,a=i[s]):Yt.indexOf(i[s+1]?.toLowerCase())<0&&(a=Xe(i,++s,"")),t[a]=n)}return t}workoutFields(i,s){const t=this.getFromTables(s)[i];return this.getFields(this.getConnectionName(),t).then(n=>({suggestions:n.map(r=>({label:r,insertText:r,kind:fe.languages.CompletionItemKind.Field}))}))}provideCompletionItems(i,s,t,n){const a=i.getValue(),r=function oi(o,i,s){let t=-1;for(;++t<o.length;)if("\n"===o[t]&&i--,1===i)return t+s;return-1}(a,s.lineNumber,s.column),c=function ni(o,i){let s=i-1;const t=[];let n="";for(;++s<o.length;){const a=o[s];!a||"\r"===a||("\n"===a||" "===a||"\t"==a?(n&&t.push(n),n=""):n+=a)}return n&&t.push(n),t}(a,r),d=function ii(o,i){let s=i;const t=[];let n="";for(;--s>=0;){const a=o[s];!a||"\r"===a||("\n"===a||" "===a||"\t"==a?(n&&t.push(n),n=""):n=a+n)}return n&&t.push(n),t}(a,r);if(!this.getConnectionName())return{suggestions:[{label:"ERROR! Please select Connection",documentation:"CONNECTION IS NOT DEFINED. Please select Connection",kind:fe.languages.CompletionItemKind.Class,insertText:""}]};if(["from","join","into","update"].indexOf(Xe(d,0,"").toLowerCase())>=0)return this.getDbObjects(this.getConnectionName()).then(C=>({suggestions:C.map(Z=>({label:Z,insertText:Z,kind:fe.languages.CompletionItemKind.Struct}))}));if(c.findIndex(C=>"from"===C.toLowerCase())>=0){const C=Xe(d,0,""),M=C.endsWith(".")?(0,ke.trim)(C,"."):"";return this.workoutFields(M,c)}const f=(0,Bt.first)(d,C=>Yt.includes(C.toLowerCase()))?.toLowerCase();if("on"===f||"where"===f){const C=Xe(d,0,""),M=C.endsWith(".")?(0,ke.trim)(C,"."):"";return this.workoutFields(M,d.map(Z=>Z).reverse())}return{suggestions:[]}}resolveCompletionItem(i,s){return null}}var me=p(52929),zt=p(15575),B=p(75263),ne=p(33374),ie=p(69569);function ai(o,i){if(1&o&&(e.TgZ(0,"option",25),e._uU(1),e.qZA()),2&o){const s=i.$implicit;e.Q6J("value",s),e.xp6(1),e.Oqu(s)}}function ri(o,i){if(1&o){const s=e.EpF();e.TgZ(0,"div",20)(1,"label",21),e._uU(2,"Function:"),e.qZA(),e.TgZ(3,"select",22),e.NdJ("change",function(n){e.CHM(s);const a=e.oxw();return e.KtG(a.onQueryParamSelect(n))}),e.TgZ(4,"option",23),e._uU(5,"Select method"),e.qZA(),e.YNc(6,ai,2,2,"option",24),e.qZA()()}if(2&o){const s=e.oxw();e.xp6(6),e.Q6J("ngForOf",s.queryParamOptions)}}function li(o,i){if(1&o){const s=e.EpF();e.TgZ(0,"app-project-access",26),e.NdJ("permissionChanged",function(){e.CHM(s);const n=e.oxw();return e.KtG(n.changed=!0)}),e.qZA()}if(2&o){const s=e.oxw();e.Q6J("config",s.config.app)}}function ci(o,i){1&o&&(e.TgZ(0,"div",27)(1,"div",28)(2,"span",29),e._uU(3,"Loading..."),e.qZA()()())}let ui=(()=>{var o;class i{constructor(t,n,a){this.dataService=t,this.dialogRef=n,this.notoficationService=a,this.loading=!1,this.invalid=!1,this.publicCodeAccessLevels=Object.keys(me.qB).map(r=>r),this.publicAppAccessLevels=Object.keys(me.PF).map(r=>r),this.appInfo={appId:0,appName:"",appOwner:"",description:"",logo:"",title:""},this.changed=!1,this.queryParamsStr=""}ngOnInit(){if(!this.config?.app)throw new Error("config is not initialized");this.contenType=this.config?.tab.tabType,this.appTitle=this.config?.app.title??this.config.app.appName,this.filePath=this.config.tab.queryParams.file,this.url=this.getContentLink(),this.queryParamOptions=this.getQueryParamOptions()}onClose(){this.dialogRef.close()}onCopy(){this.url&&navigator.clipboard.writeText(this.url)}onOpen(){this.url&&window.open(this.url,"_blank")}saveAppProject(){var t=this;return(0,_.Z)(function*(){if(!t.config)throw new Error("config is not initialized");t.loading=!0;try{const n=t.config.app;if(n.appName){const a={appName:n.appName,title:n.title,description:n.description,appOwner:n.appOwner,logo:n.logo,publicAccess:n.publicAccess,publicCodeAccess:n.publicCodeAccess};yield t.dataService.saveApp(n.appOwner,n.appName,a),t.changed=!1,yield t.dataService.loadMyAppsLinks(!0),t.notoficationService.success(`App '${n.appName}' updated.`)}else t.notoficationService.error("App Name cannot be empty")}catch(n){t.notoficationService.error(n)}finally{t.loading=!1}})()}onQueryParamSelect(t){if("jspy"===this.contenType){const n=t.target.value;this.queryParamsStr=n?`?method=${n}`:"",this.url=this.getContentLink()}}getContentLink(){if(!this.config?.tab)return"No tab";const{tabParams:t,queryParams:n}=this.config?.tab;return`${location.origin}/content/${t.owner}/${t.name}/${n.file}${this.queryParamsStr}`}getQueryParamOptions(){if("jspy"===this.contenType)return(this.config?.tab.content).contentEditor?.jspyFunctions}}return(o=i).\u0275fac=function(t){return new(t||o)(e.Y36(B.UW),e.Y36(ne.z),e.Y36(ie.g))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-project-share"]],viewQuery:function(t,n){if(1&t&&e.Gf(zt.m,5),2&t){let a;e.iGM(a=e.CRH())&&(n.accessComponent=a.first)}},inputs:{config:"config"},decls:28,vars:7,consts:[["autocomplete","off",1,"d-flex","flex-column","h-200"],[1,"modal-header","d-flex","flex-row"],[1,"modal-title","flex-fill"],[1,"file-path"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body","px-4","d-flex","flex-column","h-100","overflow-hidden"],[1,"row","mr-0","mb-2","mt-2"],["for","link",1,"col-1","col-form-label","py-1"],["disabled","disabled",1,"form-control","col","form-control-sm",3,"value"],["type","button",1,"btn","btn-outline-primary","btn-sm","align-self-baseline","ml-2",3,"click"],[1,"fa","fa-copy","my-0"],[1,"fa","fa-share","my-0"],["class","row mr-0 mb-2",4,"ngIf"],["class","pt-3 mt-3",3,"config","permissionChanged",4,"ngIf"],[1,"modal-footer","flex-column"],[1,"row","w-100","mx-0","px-0"],["type","button",1,"btn","btn-light",3,"click"],["type","submit",1,"btn","btn-primary","ml-auto",3,"disabled","click"],["class","d-flex justify-content-center position-absolute align-items-center w-100 h-100 spinner flex-column",4,"ngIf"],[1,"row","mr-0","mb-2"],[1,"col-2","col-form-label","py-1"],[1,"form-control","form-control-sm","col",3,"change"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"pt-3","mt-3",3,"config","permissionChanged"],[1,"d-flex","justify-content-center","position-absolute","align-items-center","w-100","h-100","spinner","flex-column"],["role","status",1,"spinner-border"],[1,"sr-only"]],template:function(t,n){1&t&&(e.TgZ(0,"div")(1,"div",0)(2,"div",1)(3,"h4",2),e._uU(4),e.TgZ(5,"span",3),e._uU(6),e.qZA()(),e.TgZ(7,"button",4),e.NdJ("click",function(){return n.onClose()}),e.TgZ(8,"span",5),e._uU(9,"\xd7"),e.qZA()()(),e.TgZ(10,"div",6)(11,"div",7)(12,"label",8),e._uU(13,"Link:"),e.qZA(),e._UZ(14,"input",9),e.TgZ(15,"button",10),e.NdJ("click",function(){return n.onCopy()}),e._UZ(16,"i",11),e.qZA(),e.TgZ(17,"button",10),e.NdJ("click",function(){return n.onOpen()}),e._UZ(18,"i",12),e.qZA()(),e.YNc(19,ri,7,1,"div",13),e.YNc(20,li,1,1,"app-project-access",14),e.qZA(),e.TgZ(21,"div",15)(22,"div",16)(23,"button",17),e.NdJ("click",function(){return n.onClose()}),e._uU(24,"Cancel"),e.qZA(),e.TgZ(25,"button",18),e.NdJ("click",function(){return n.saveAppProject()}),e._uU(26,"Save"),e.qZA()()()()(),e.YNc(27,ci,4,0,"div",19)),2&t&&(e.xp6(4),e.hij("App / Project: ",n.appTitle," "),e.xp6(2),e.hij("File: ",n.filePath,""),e.xp6(8),e.Q6J("value",n.url),e.xp6(5),e.Q6J("ngIf","jspy"===n.contenType&&(null==n.queryParamOptions?null:n.queryParamOptions.length)),e.xp6(1),e.Q6J("ngIf",n.config),e.xp6(5),e.Q6J("disabled",!n.changed),e.xp6(2),e.Q6J("ngIf",n.loading))},dependencies:[l.sg,l.O5,u.YN,u.Kr,zt.m],styles:[".file-path[_ngcontent-%COMP%]{font-size:medium}app-project-access[_ngcontent-%COMP%]{border-top:1px solid}"]}),i})();var O=p(21473),oe=p(8050),di=p(12044),pi=p(55629),pt=p(99397),$t=p(10708),Se=p(612),ht=p(65619),Ut=p(52572),ve=p(16321),le=p(22263);const hi=["jspy","js","json","table","procedure","query","dcml"];function Gt(o){return{jspy:"fa-file-text-o",dcml:"fa-file-code-o",query:"fa-code",js:"fa-code",json:"fa-code",sql:"fa-table"}[o]||"fa-question"}class fi{init(i){const s=document.createElement("div"),t=i.value,n=i.data?Gt(i.data?.contentPath.contentType):"fa-folder-o";s.innerHTML=`<span><i class="fa ${n} mr-1"></i>\n            <span class="filename"></span>${t}</span>`,this.eGui=s.firstChild}getGui(){return this.eGui}refresh(){return!1}}function mi(o){const i=o.folder?o.folder.replaceAll("/","\\").replaceAll("!","\\").split("\\"):[];return i.push(`${o.name}.${o.contentType}`),i}function Vt(o){if(o.data)return o.data.filePath;const i=[o.key];let s=o?.parent;for(;s?.key;)i.unshift(s.key),s=s.parent;return i}function We(o){const i=o.allLeafChildren.filter(s=>s!==o);return i?.length?(0,Bt.flatten)(i.map(s=>We(s))):o.data?[o.data]:[]}function Kt(o){return{fileKey:(0,O.nV)(o),filePath:mi(o),fileName:`${o.name}.${o.contentType}`,contentPath:o}}p(66166);const bi=["folder"];let ft=(()=>{var o;class i{constructor(t,n,a,r){this.dialogRef=t,this.dataService=n,this.dialogService=a,this.notificationService=r,this.config={},this.contentTypes=hi,this.saveAppLink={},this.title="",this.apps=[],this.appNames=[],this.appName="",this.loading=!1}ngOnInit(){var t=this;return(0,_.Z)(function*(){if(t.apps=yield t.dataService.loadMyAppsLinks(),t.appNames=t.apps.map(n=>n.appOwner+"."+n.appName),t.appNames.push("-- Create New App --"),t.saveAppLink={...t.config.link},t.config.link?.appName&&(t.appName=t.config.link.appOwner+"."+t.config.link.appName),t.config.link){const{folder:n,name:a,contentType:r}=t.config.link;t.title=`Rename file: ${n||""}/${a}.${r}`}t.initFoldersAutocomplete()})()}onSave(){var t=this;return(0,_.Z)(function*(){t.autoCorrectNames();const n={...t.saveAppLink};!n.folder||n.folder.split("/").every(a=>(0,be.r1)(a))?(0,be.r1)(n.name)?"-- Create New App --"!==t.saveAppLink?.appName?t.isValid()?t.dialogRef.close(n):t.notificationService.error("App is not selected or name is incorrect"):t.notificationService.error("Your can't create an App from here yet. Please go to Home page to create an App"):t.notificationService.error("Incorrect name"):t.notificationService.error("Incorrect folder")})()}autoCorrectNames(){this.saveAppLink.folder=this.saveAppLink.folder?.includes("\\")||this.saveAppLink.folder?.includes("!")?this.saveAppLink.folder.replaceAll("\\","/").replaceAll("!","/"):this.saveAppLink.folder,this.saveAppLink.folder=this.saveAppLink.folder?(0,ke.trim)(this.saveAppLink.folder,"/"):this.saveAppLink.folder,this.saveAppLink.name=this.saveAppLink.name?.trim()||"",this.saveAppLink.name.toLowerCase().endsWith(`.${this.saveAppLink.contentType}`)&&(this.saveAppLink.name=this.saveAppLink.name.substring(0,this.saveAppLink.name.length-(this.saveAppLink.contentType?.length||0)-1))}onClose(){this.dialogRef.close()}onAppSeclect(t){if(!this.saveAppLink)throw new Error("this.saveAppLink not initialized yet");const n=t.split(".");"-- Create New App --"!==t?t?(this.saveAppLink.appOwner=n[0],this.saveAppLink.appName=n[1]):(this.saveAppLink.appOwner="",this.saveAppLink.appName=""):this.saveAppLink.appName="-- Create New App --"}initFoldersAutocomplete(){if(!this.folderInput?.nativeElement)throw new Error("folderInput?.nativeElement is not initialized ");const t=this.folderInput.nativeElement;t.setAttribute("autocomplete","on");const n=document.createElement("DATALIST");n.id="list-of-folders",t.setAttribute("list",n.id),t.parentNode?.insertBefore(n,t),n.innerHTML=this.config.folders?.map(a=>`<option value="${a}">`)?.join("")}isValid(){return!!(this.saveAppLink.name&&this.saveAppLink.appName&&this.saveAppLink.appOwner)}}return(o=i).\u0275fac=function(t){return new(t||o)(e.Y36(ne.z),e.Y36(B.UW),e.Y36(ne.x),e.Y36(ie.g))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-file-dialog"]],viewQuery:function(t,n){if(1&t&&e.Gf(bi,7),2&t){let a;e.iGM(a=e.CRH())&&(n.folderInput=a.first)}},inputs:{config:"config"},decls:29,vars:8,consts:[[3,"ngSubmit"],["form","ngForm"],[1,"modal-header"],[1,"modal-title","pull-left"],[1,"modal-body","px-4","d-flex","flex-column","h-100","overflow-hidden"],[1,"row","mr-0","mb-2"],["for","type",1,"col-3","col-form-label"],["appendTo","body","name","app","required","","placeholder","Select content type",1,"col","px-0","auto-grow",3,"ngModel","items","change"],["for","folder",1,"col-3","col-form-label"],["name","folder",1,"form-control","col",3,"ngModel","ngModelChange"],["folder",""],["for","name",1,"col-3","col-form-label"],["name","name","required","",1,"form-control","col",3,"ngModel","ngModelChange"],[1,"row","mr-0","mb-4"],["appendTo","body","name","type","required","","placeholder","Select content type",1,"col","px-0","auto-grow",3,"items","ngModel","ngModelChange"],[1,"modal-footer"],[1,"row","w-100","mx-0","px-0"],["type","submit",1,"btn","btn-primary","ml-auto","mr-2","fx-80",3,"disabled"],["type","button",1,"btn","btn-light","fx-80",3,"click"]],template:function(t,n){if(1&t&&(e.TgZ(0,"form",0,1),e.NdJ("ngSubmit",function(){return n.onSave()}),e.TgZ(2,"div",2)(3,"h4",3),e._uU(4),e.qZA()(),e.TgZ(5,"div",4)(6,"div",5)(7,"label",6),e._uU(8,"Application"),e.qZA(),e.TgZ(9,"ng-select",7),e.NdJ("change",function(r){return n.onAppSeclect(r)}),e.qZA()(),e.TgZ(10,"div",5)(11,"label",8),e._uU(12,"Folder"),e.qZA(),e.TgZ(13,"input",9,10),e.NdJ("ngModelChange",function(r){return n.saveAppLink.folder=r}),e.qZA()(),e.TgZ(15,"div",5)(16,"label",11),e._uU(17,"Name"),e.qZA(),e.TgZ(18,"input",12),e.NdJ("ngModelChange",function(r){return n.saveAppLink.name=r}),e.qZA()(),e.TgZ(19,"div",13)(20,"label",6),e._uU(21,"File Type"),e.qZA(),e.TgZ(22,"ng-select",14),e.NdJ("ngModelChange",function(r){return n.saveAppLink.contentType=r}),e.qZA()()(),e.TgZ(23,"div",15)(24,"div",16)(25,"button",17),e._uU(26,"Save"),e.qZA(),e.TgZ(27,"button",18),e.NdJ("click",function(){return n.onClose()}),e._uU(28,"Cancel"),e.qZA()()()()),2&t){const a=e.MAs(1);e.xp6(4),e.Oqu(n.title),e.xp6(5),e.Q6J("ngModel",n.appName)("items",n.appNames),e.xp6(4),e.Q6J("ngModel",n.saveAppLink.folder),e.xp6(5),e.Q6J("ngModel",n.saveAppLink.name),e.xp6(4),e.Q6J("items",n.contentTypes)("ngModel",n.saveAppLink.contentType),e.xp6(3),e.Q6J("disabled",!a.valid||!n.saveAppLink.appName)}},dependencies:[u._Y,u.Fj,u.JJ,u.JL,u.Q7,u.On,u.F,Ke.w9]}),i})(),Xt=(()=>{var o;class i{constructor(t,n,a){this.dialogRef=t,this.dataService=n,this.notificationService=a,this.config={},this.loading=!1}onSave(){var t=this;return(0,_.Z)(function*(){t.autoCorrectNames();const n=t.config.folder;!n||n.split("/").every(a=>(0,be.r1)(a))?t.dialogRef.close(n):t.notificationService.error("Incorrect folder")})()}autoCorrectNames(){this.config.folder=this.config.folder?.includes("\\")||this.config.folder?.includes("!")?this.config.folder.replaceAll("\\","/").replaceAll("!","/"):this.config.folder,this.config.folder=this.config.folder?(0,ke.trim)(this.config.folder,"/"):this.config.folder}onClose(){this.dialogRef.close()}}return(o=i).\u0275fac=function(t){return new(t||o)(e.Y36(ne.z),e.Y36(B.UW),e.Y36(ie.g))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-folder-dialog"]],inputs:{config:"config"},decls:16,vars:2,consts:[[3,"ngSubmit"],["form","ngForm"],[1,"modal-header"],[1,"modal-title","pull-left"],[1,"modal-body","px-4","d-flex","flex-column","h-100","overflow-hidden"],[1,"row","mr-0","mb-2"],["for","folder",1,"col-3","col-form-label"],["name","folder",1,"form-control","col",3,"ngModel","ngModelChange"],[1,"modal-footer"],[1,"row","w-100","mx-0","px-0"],["type","submit",1,"btn","btn-primary","ml-auto","mr-2","fx-80"],["type","button",1,"btn","btn-light","fx-80",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"form",0,1),e.NdJ("ngSubmit",function(){return n.onSave()}),e.TgZ(2,"div",2)(3,"h4",3),e._uU(4),e.qZA()(),e.TgZ(5,"div",4)(6,"div",5)(7,"label",6),e._uU(8,"Folder"),e.qZA(),e.TgZ(9,"input",7),e.NdJ("ngModelChange",function(r){return n.config.folder=r}),e.qZA()()(),e.TgZ(10,"div",8)(11,"div",9)(12,"button",10),e._uU(13,"Save"),e.qZA(),e.TgZ(14,"button",11),e.NdJ("click",function(){return n.onClose()}),e._uU(15,"Cancel"),e.qZA()()()()),2&t&&(e.xp6(4),e.Oqu(n.config.title||"Folder"),e.xp6(5),e.Q6J("ngModel",n.config.folder))},dependencies:[u._Y,u.Fj,u.JJ,u.JL,u.On,u.F],encapsulation:2}),i})(),Wt=(()=>{var o;class i{constructor(t,n,a,r,c){this.notificationService=t,this.dataStudioService=n,this.dataService=a,this.tabsService=r,this.dialogService=c,this.saving$=new N.x}init(t){this.gridApi=t}deleteNode(t){var n=this;return(0,_.Z)(function*(){if(!t)return;const a=function gi(o){const i=o.data;return`Delete ${o.group?"folder":"file"} ${i?.fileKey??o.key}`}(t),r=We(t);if(yield n.notificationService.confirmation(a))try{n.saving$.next(!0),yield Promise.all(r.map(h=>n.dataService.deleteAppContent(n.dataStudioService.currentApp.appOwner,n.dataStudioService.currentApp.appName,(0,O.nV)(h.contentPath)))),n.notificationService.success(`Deleted: ${r.map(h=>(0,O.nV)(h.contentPath)).join(", ")}`);const d=t.group?t.allLeafChildren:[t];n.gridApi?.applyTransaction({remove:d.map(h=>h.data).filter(h=>!!h)}),n.tabsService.removeAppTabs(n.dataStudioService.currentApp,r.map(h=>h.contentPath))}catch(d){n.notificationService.error(d)}finally{n.saving$.next(!1)}})()}renameNode(t){var n=this;return(0,_.Z)(function*(){const a=t.data;if(!a)return n.renameFolderNode(t);const c={link:{...a.contentPath,appOwner:n.dataStudioService.currentApp.appOwner,appName:n.dataStudioService.currentApp.appName},folders:n.getFoldersList(t)},d=yield n.dialogService.open(ft,{initialState:{config:c}}).onCloseAsync();if(d){n.saving$.next(!0);try{return yield n.dataService.renameFile(d.appOwner,d.appName,(0,O.nV)(a.contentPath),(0,O.nV)(d)),t.data=Kt(d),n.gridApi?.applyTransaction({update:[t.data]}),t}catch(h){return void n.notificationService.error(h)}finally{n.saving$.next(!1)}}})()}copyFileTo(t){var n=this;return(0,_.Z)(function*(){const a=t.data;if(!a)throw new Error("No file data");const c={link:a.contentPath,folders:n.getFoldersList(t)},d=yield n.dialogService.open(ft,{initialState:{config:c}}).onCloseAsync();if(d){n.saving$.next(!0);try{const h=d.appOwner,m=d.appName,f=yield n.dataService.getFileContent(h,m,(0,O.nV)(a.contentPath));yield n.dataService.saveAppContent({ownerName:h,appName:m,content:f,fileName:(0,O.nV)(d)})}catch(h){return void n.notificationService.error(h)}finally{n.saving$.next(!1)}}})()}copyFolderTo(t){var n=this;return(0,_.Z)(function*(){const a=Vt(t).join("/"),r={title:"Copy Folder To",folder:a};let c=yield n.dialogService.open(Xt,{initialState:{config:r}}).onCloseAsync();if(null==c)return;c=c.replaceAll("/","!");const d=We(t),h=n.dataStudioService.currentApp;n.saving$.next(!0);try{for(let m of d){const f=(0,O.nV)(m.contentPath),C=(0,ke.trim)(`${c}!${f.substring(a.length+1)}`,"!"),M=yield n.dataService.getFileContent(h.appOwner,h.appName,f);yield n.dataService.saveAppContent({ownerName:h.appOwner,appName:h.appName,content:M,fileName:C})}}catch(m){return void n.notificationService.error(m)}finally{n.saving$.next(!1)}})()}renameFolderNode(t){var n=this;return(0,_.Z)(function*(){const a=Vt(t).join("/"),r={title:"Rename Folder",folder:a};let c=yield n.dialogService.open(Xt,{initialState:{config:r}}).onCloseAsync();if(null==c)return;c=c.replaceAll("/","!");const d=We(t),h=n.dataStudioService.currentApp;n.saving$.next(!0);try{for(let m of d){const f=(0,O.nV)(m.contentPath),C=(0,ke.trim)(`${c}!${f.substring(a.length+1)}`,"!");yield n.dataService.renameFile(h.appOwner,h.appName,f,C)}return t}catch(m){return void n.notificationService.error(m)}finally{n.saving$.next(!1)}})()}getFoldersList(t){const n=t.allLeafChildren;return Array.from(new Set(n?.map(a=>a.data?.filePath).filter(a=>!!a)))}}return(o=i).\u0275fac=function(t){return new(t||o)(e.LFG(ie.g),e.LFG(ee.F),e.LFG(B.UW),e.LFG(oe.x),e.LFG(ne.x))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac}),i})();var en=p(40092),mt=p(26671);function vi(o,i){1&o&&(e.TgZ(0,"div",2)(1,"div",3)(2,"span",4),e._uU(3,"Loading..."),e.qZA()()())}let tn=(()=>{var o;class i{constructor(t,n,a,r,c,d){this.route=t,this.router=n,this.dataStudioService=a,this.dataService=r,this.tabsService=c,this.appTreeService=d,this.isReadOnly=!1,this.loading$=new N.x,this.saving$=this.appTreeService.saving$,this.destroy$=new N.x,this.rowData$=new ht.X([]),this.gridConfig={suppressContextMenu:!1,rowSelection:"single",getContextMenuItems:this.getContextMenuItems.bind(this)},this.groupDefaultExpanded=-1,this.getDataPath=h=>h.filePath,this.defaultColDef={flex:1},this.autoGroupColumnDef={minWidth:330,cellRendererParams:{suppressCount:!0,innerRenderer:fi}}}onGridReady(t){this.gridApi=t.api,this.gridApi.setHeaderHeight(0),this.gridApi.setGroupHeaderHeight(0),this.appTreeService.init(this.gridApi)}ngOnInit(){this.dataStudioService.currentApp$.pipe((0,y.R)(this.destroy$)).subscribe(t=>this.onAppChanged(t)),this.dataStudioService.appContentAdded$.pipe((0,y.R)(this.destroy$)).subscribe(t=>{this.onAppChanged(this.dataStudioService.currentApp)}),(0,Ut.a)([this.tabsService.activeTab$,this.loading$.pipe((0,Me.b)(100))]).pipe((0,y.R)(this.destroy$),(0,F.h)(([t,n])=>!1===n)).subscribe(([t])=>{if(this.gridApi&&"app"===t?.tabParams.appOrSql){const n=(0,O.x2)(t.queryParams.file);(0,en.JE)(this.gridApi,a=>a.fileKey===(0,O.nV)(n))}else this.gridApi?.deselectAll()})}ngOnDestroy(){this.destroy$.next(null),this.destroy$.complete()}refreshAppFiles(t){var n=this;return(0,_.Z)(function*(){yield n.onAppChanged(t)})()}onAppChanged(t){var n=this;return(0,_.Z)(function*(){if(!t)return;n.loading$.next(!0);const a=(yield n.dataService.loadAppFileLinks(t.appOwner,t.appName,!0)).map(Kt);n.rowData$.next(a),n.loading$.next(!1)})()}onCellClicked(t){var n=this;return(0,_.Z)(function*(){const a=t.data;a&&n.selectTreeItem(a)})()}selectTreeItem(t){if(!t)return;const{appOwner:n,appName:a}=this.dataStudioService.currentApp,r=(0,O.nV)(t.contentPath);this.router.navigate(["data-studio/app",n||le.m5,a||le.b5],{queryParams:{file:r,tab:this.route.snapshot.queryParams.tab}})}getContextMenuItems(t){var a,r,n=this;if(!t.node)return[];const c=t.node;return[{name:"Rename",action:function(){return(a=a||(0,_.Z)(function*(){return yield n.renameFile(c)})).apply(this,arguments)}},{name:"Delete",action:()=>this.appTreeService.deleteNode(c)},"separator",{name:"Copy to",action:function(){return(r=r||(0,_.Z)(function*(){return yield n.copyTo(c)})).apply(this,arguments)}}]}copyTo(t){var n=this;return(0,_.Z)(function*(){if(!t.data)return yield n.appTreeService.copyFolderTo(t),void(yield n.refreshAppFiles(n.dataStudioService.currentApp));yield n.appTreeService.copyFileTo(t),yield n.refreshAppFiles(n.dataStudioService.currentApp)})()}renameFile(t){var n=this;return(0,_.Z)(function*(){if(!t.data)return yield n.appTreeService.renameFolderNode(t),void(yield n.refreshAppFiles(n.dataStudioService.currentApp));const a=t.isSelected(),r=n.rowData$.getValue(),c=t.data,d=r.indexOf(c),h=t.rowIndex,f=(yield n.appTreeService.renameNode(t))?.data;f&&(r[d]=f,n.rowData$.next([...r]),ve.z.schedule(()=>{n.gridApi?.ensureIndexVisible(h,"middle"),a&&(n.selectTreeItem(f),n.tabsService.removeAppTabs(n.dataStudioService.currentApp,[c.contentPath]))}))})()}}return(o=i).\u0275fac=function(t){return new(t||o)(e.Y36(K.gz),e.Y36(K.F0),e.Y36(ee.F),e.Y36(mt.U),e.Y36(oe.x),e.Y36(Wt))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-tree"]],inputs:{isReadOnly:"isReadOnly"},features:[e._Bn([Wt])],decls:5,vars:15,consts:[[1,"w-100","h-100","p-0","m-0","ag-theme-balham","ws-ag-tree",3,"gridOptions","defaultColDef","autoGroupColumnDef","rowData","treeData","animateRows","groupDefaultExpanded","getDataPath","cellClicked","gridReady"],["class","d-flex justify-content-center position-absolute align-items-center w-100 h-100 spinner",4,"ngIf"],[1,"d-flex","justify-content-center","position-absolute","align-items-center","w-100","h-100","spinner"],["role","status",1,"spinner-border"],[1,"sr-only"]],template:function(t,n){1&t&&(e.TgZ(0,"ag-grid-angular",0),e.NdJ("cellClicked",function(r){return n.onCellClicked(r)})("gridReady",function(r){return n.onGridReady(r)}),e.ALo(1,"async"),e.qZA(),e.YNc(2,vi,4,0,"div",1),e.ALo(3,"async"),e.ALo(4,"async")),2&t&&(e.Q6J("gridOptions",n.gridConfig)("defaultColDef",n.defaultColDef)("autoGroupColumnDef",n.autoGroupColumnDef)("rowData",e.lcZ(1,9,n.rowData$))("treeData",!0)("animateRows",!0)("groupDefaultExpanded",n.groupDefaultExpanded)("getDataPath",n.getDataPath),e.xp6(2),e.Q6J("ngIf",e.lcZ(3,11,n.loading$)||e.lcZ(4,13,n.saving$)))},dependencies:[Ee.N8,l.O5,l.Ov],styles:['[_ngcontent-%COMP%]:root{--bg: #fff;--body-bg: #e4e5e6;--header-bg: #ebedef;--color: #4f5d73;--border-color: #c4c9d0;--ws-alt: #f7f7f7;--form-input-bg: #fff;--form-input-color: #768192;--nav-link-color: #8a93a2;--secondary-color: #c4c9d0;--opacity: .05;--hover: "#f0f3f5";--ag-edited-cell-bg: "rgba(255, 218, 218, 0.6)";--ag-added-cell-bg: "rgba(226, 255, 226, 0.5)"}[_nghost-%COMP%]{display:block;position:relative}']}),i})();var yi=p(85965),Ci=p(10217),Ie=p(1238),Fe=p(38582),Ne=p(13509),Si=p(41490);let gt=(()=>{var o;class i{constructor(t,n,a,r){this.notificationService=t,this.fileManagerService=n,this.dataService=a,this.accountService=r}toLinksTree(t){t=t.sort();const n=[];function a(r){if(!r)return n;const c=r.split("!");let d=n;for(const h of c){let m=d.find(f=>f.label===h&&!f.fullFileName);m||(m={label:h,children:[]},d.push(m)),d=m.children}return d}for(let r of t){const{folder:c,fileName:d}=(0,O.Dl)(r);a(c).push({label:d,fullFileName:r})}return n}downloadLinks(t,n,a,r,c){var d=this;return(0,_.Z)(function*(){const h=yield d.dataService.getAppFiles(t.appOwner,t.appName),m=d.toLinksTree(h),f=(new yi).folder(t.appName);try{if(n){var C=le.Ie;C=(C=(C=C.replace("@appName",t.appName)).replace("@appDescription",t.description)).replace("@appOwner",t.appOwner),f.file("package.json",C)}if(a){var M=le.xM;M=(M=M.replace("@appName",t.appName)).replace("@appDescription",t.description),f.file("readme.md",M)}if(r){let Qe=le.n8;Qe=Qe.replace("@baseUrl",Ie.Z.worksheetsApi),Qe=Qe.replace("@apiAccessToken",(yield d.accountService.showAccessToken()).accessToken),f.file("app.js",Qe)}const Z=c?f.folder("src"):f;Z.file(Fe.fP,JSON.stringify(t,null,"\t")),Z.file(Fe.KH,JSON.stringify({files:h},null,"\t")),yield d.generateZipFile(t,Z,m);const ce=yield f.generateAsync({type:"blob"});(0,Ci.saveAs)(ce,`${t.appOwner}-${t.appName}.zip`)}catch(Z){d.notificationService.error(Z)}})()}uploadApp(t){var n=this;return(0,_.Z)(function*(){var a=(yield n.fileManagerService.importAppContents()).map(f=>({...f,fileName:f.fileName?.replaceAll("\\","!")?.replaceAll("/","!")}));const r=yield n.dataService.getAppFiles(t.appOwner,t.appName),c=a.find(f=>f.fileName?.toLowerCase()?.endsWith(Fe.fP))?.fileName;if(!c)throw new Error(`'${Fe.fP}' file not found in a zip`);const d=(0,O.Dl)(c).folder;d&&(a=a.filter(f=>f.fileName?.startsWith(d)).map(f=>({...f,fileName:f.fileName?.substring(d.length+1)})));const h=(a=a.filter(f=>f.fileName!==Fe.fP&&f.fileName!==Fe.KH)).map(f=>f.fileName),m=r.filter(f=>!h.includes(f));try{for(const f of a)yield n.dataService.saveAppContent({ownerName:t.appOwner,appName:t.appName,fileName:f.fileName,content:f.content});for(const f of m)yield n.dataService.deleteAppContent(t.appOwner,t.appName,f);n.notificationService.success(`${a.length} saved and '${m.length}' deleted.`)}catch(f){n.notificationService.error(f)}})()}generateZipFile(t,n,a){var r=this;return(0,_.Z)(function*(){for(const c of a)if(c.children){const d=n.folder(c.label);yield r.generateZipFile(t,d,c.children)}else{const d=yield r.dataService.getFileContent(t.appOwner,t.appName,c.fullFileName);n.file(c.label,d)}})()}}return(o=i).\u0275fac=function(t){return new(t||o)(e.LFG(ie.g),e.LFG(Ne.j5),e.LFG(B.UW),e.LFG(Si.B))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),i})();function Ti(o,i){if(1&o){const s=e.EpF();e.TgZ(0,"div")(1,"div",2)(2,"h4",3),e._uU(3,"Download App/Project"),e.qZA()(),e.TgZ(4,"div",4)(5,"div",5)(6,"label",6),e._uU(7,"Place code in 'src' folder"),e.qZA(),e.TgZ(8,"input",7),e.NdJ("ngModelChange",function(n){e.CHM(s);const a=e.oxw();return e.KtG(a.checkSrc=n)}),e.qZA()(),e.TgZ(9,"div",5)(10,"label",6),e._uU(11,"Include 'package.json'"),e.qZA(),e.TgZ(12,"input",7),e.NdJ("ngModelChange",function(n){e.CHM(s);const a=e.oxw();return e.KtG(a.checkPackageJson=n)}),e.qZA()(),e.TgZ(13,"div",5)(14,"label",6),e._uU(15,"Include 'readme.md'"),e.qZA(),e.TgZ(16,"input",7),e.NdJ("ngModelChange",function(n){e.CHM(s);const a=e.oxw();return e.KtG(a.checkReadmeMd=n)}),e.qZA()(),e.TgZ(17,"div",5)(18,"label",6),e._uU(19),e.qZA(),e.TgZ(20,"input",8),e.NdJ("ngModelChange",function(n){e.CHM(s);const a=e.oxw();return e.KtG(a.checkAppJs=n)}),e.qZA()()(),e.TgZ(21,"div",9)(22,"button",10),e.NdJ("click",function(){e.CHM(s);const n=e.oxw();return e.KtG(n.downloadApp())}),e._uU(23,"Download App"),e.qZA(),e.TgZ(24,"button",11),e.NdJ("click",function(){e.CHM(s);const n=e.oxw();return e.KtG(n.onClose())}),e._uU(25,"Cancel"),e.qZA()()()}if(2&o){const s=e.oxw();e.xp6(8),e.Q6J("ngModel",s.checkSrc),e.xp6(4),e.Q6J("ngModel",s.checkPackageJson),e.xp6(4),e.Q6J("ngModel",s.checkReadmeMd),e.xp6(3),e.hij(" ",s.hasAppJs?"Override with ":"Include"," default 'app.js'"),e.xp6(1),e.Q6J("ngModel",s.checkAppJs)}}function xi(o,i){1&o&&(e.TgZ(0,"div",12)(1,"div",13)(2,"span",14),e._uU(3,"..."),e.qZA()()())}let wi=(()=>{var o;class i{constructor(t,n,a){this.dialogRef=t,this.appUploaderService=n,this.notoficationService=a,this.app={},this.checkSrc=!0,this.checkPackageJson=!0,this.checkReadmeMd=!0,this.checkAppJs=!1,this.hasAppJs=!1,this.loading=!1}ngOnInit(){this.checkAppJs=!this.hasAppJs}downloadApp(){var t=this;return(0,_.Z)(function*(){t.loading=!0;try{yield t.appUploaderService.downloadLinks(t.app,t.checkPackageJson,t.checkReadmeMd,t.checkAppJs,t.checkSrc),t.dialogRef.close()}catch(n){t.notoficationService.error(n)}finally{t.loading=!1}})()}onClose(){this.dialogRef.close()}}return(o=i).\u0275fac=function(t){return new(t||o)(e.Y36(ne.z),e.Y36(gt),e.Y36(ie.g))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-download-app-dialog"]],inputs:{app:"app"},decls:2,vars:2,consts:[[4,"ngIf"],["class","d-flex justify-content-center position-absolute align-items-center w-100 h-100 spinner flex-column",4,"ngIf"],[1,"modal-header"],[1,"modal-title","pull-left"],[1,"modal-body","px-4","d-flex","flex-column"],[1,"row","mr-0","mb-2","form-check","justify-content-center"],["for","flexCheckChecked",1,"col","form-check-label"],["type","checkbox","checked","",1,"form-check-input",3,"ngModel","ngModelChange"],["type","checkbox",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"modal-footer"],[1,"btn","btn-primary","ml-auto","mr-2","fx-80",3,"click"],["type","button",1,"btn","btn-light","fx-80",3,"click"],[1,"d-flex","justify-content-center","position-absolute","align-items-center","w-100","h-100","spinner","flex-column"],["role","status",1,"spinner-border"],[1,"sr-only"]],template:function(t,n){1&t&&(e.YNc(0,Ti,26,5,"div",0),e.YNc(1,xi,4,0,"div",1)),2&t&&(e.Q6J("ngIf",!n.loading),e.xp6(1),e.Q6J("ngIf",n.loading))},dependencies:[l.O5,u.Wl,u.JJ,u.On]}),i})();var ki=p(28169),Ai=p(84239),Ae=p(55314),ye=p(94782);function Oi(o,i){if(1&o){const s=e.EpF();e.TgZ(0,"li")(1,"a",7),e.NdJ("click",function(){const a=e.CHM(s).$implicit,r=e.oxw(2);return e.KtG(r.onAppSelectedClick(a))}),e._uU(2),e.qZA()()}if(2&o){const s=i.$implicit;e.xp6(2),e.AsE("",s.appName," (",s.appOwner,")")}}function Mi(o,i){if(1&o&&(e.TgZ(0,"ul",5),e.YNc(1,Oi,3,2,"li",6),e.qZA()),2&o){const s=e.oxw();e.xp6(1),e.Q6J("ngForOf",s.apps)}}let Di=(()=>{var o;class i{constructor(t,n){this.appsState=t,this.dataService=n,this.destroy$=new N.x,n.appsList$.pipe((0,y.R)(this.destroy$)).subscribe(a=>this.apps=a)}ngOnInit(){var t=this;return(0,_.Z)(function*(){yield t.dataService.loadMyAppsLinks()})()}appName(t){return t&&(t.indexOf("!")>0?t.substring(t.lastIndexOf("!")+1):t)}onAppSelectedClick(t){this.appsState.setCurrentApp(t)}ngOnDestroy(){this.destroy$.next(null),this.destroy$.complete()}}return(o=i).\u0275fac=function(t){return new(t||o)(e.Y36(ee.F),e.Y36(B.UW))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-selection"]],decls:7,vars:3,consts:[["dropdown","","container","body"],["id","basic-link","dropdownToggle","","aria-controls","basic-link-dropdown",1,"btn","btn-link","dropdown-toggle","btn-sm","pl-0","cursor-pointer","border-0",3,"click"],[1,"d-inline-block","m-0"],[1,"ml-1","caret"],["id","basic-link-dropdown","class","dropdown-menu","role","menu","aria-labelledby","basic-link",4,"dropdownMenu"],["id","basic-link-dropdown","role","menu","aria-labelledby","basic-link",1,"dropdown-menu"],[4,"ngFor","ngForOf"],[1,"dropdown-item",3,"click"]],template:function(t,n){if(1&t&&(e.TgZ(0,"span",0)(1,"a",1),e.NdJ("click",function(r){return r.stopImmediatePropagation()}),e.TgZ(2,"h5",2),e._uU(3),e.ALo(4,"async"),e._UZ(5,"span",3),e.qZA()(),e.YNc(6,Mi,2,1,"ul",4),e.qZA()),2&t){let a;e.xp6(3),e.hij(" ",n.appName(null==(a=e.lcZ(4,1,n.appsState.currentApp$))?null:a.appName)||"Select application","")}},dependencies:[G.Hz,G.Mq,G.TO,l.sg,l.Ov]}),i})();function Pi(o,i){if(1&o){const s=e.EpF();e.TgZ(0,"li")(1,"a",7),e.NdJ("click",function(){const a=e.CHM(s).$implicit,r=e.oxw(2);return e.KtG(r.dsService.setCurrentConnection(a.connectionName))}),e._uU(2),e.qZA()()}if(2&o){const s=i.$implicit;e.xp6(1),e.Q6J("title",s.connectionName),e.xp6(1),e.Oqu(s.connectionName)}}function Ei(o,i){if(1&o&&(e.TgZ(0,"ul",5),e.YNc(1,Pi,3,2,"li",6),e.ALo(2,"async"),e.qZA()),2&o){const s=e.oxw();e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,1,s.connectionsService.dbConnectionsList$))}}let Ii=(()=>{var o;class i{constructor(t,n){this.dsService=t,this.connectionsService=n}getTitle(){const{connectionName:t,description:n}=this.connectionsService.getDbConnectionLink(this.dsService.getCurrentConnection())||{};return`${t}\n${n||""}`.trim()}ngOnInit(){var t=this;return(0,_.Z)(function*(){yield t.connectionsService.loadMyDbConnections()})()}}return(o=i).\u0275fac=function(t){return new(t||o)(e.Y36(ee.F),e.Y36(Ae.F))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-db-selection"]],decls:7,vars:4,consts:[["dropdown","","container","body"],["id","basic-link","dropdownToggle","","aria-controls","basic-link-dropdown",1,"btn","btn-link","dropdown-toggle","btn-sm","pl-0","cursor-pointer","border-0",3,"title","click"],[1,"d-inline-block","m-0"],[1,"ml-1","caret"],["id","basic-link-dropdown","class","dropdown-menu","role","menu","aria-labelledby","basic-link",4,"dropdownMenu"],["id","basic-link-dropdown","role","menu","aria-labelledby","basic-link",1,"dropdown-menu"],[4,"ngFor","ngForOf"],[1,"dropdown-item",3,"title","click"]],template:function(t,n){1&t&&(e.TgZ(0,"span",0)(1,"a",1),e.NdJ("click",function(r){return r.stopImmediatePropagation()}),e.TgZ(2,"h5",2),e._uU(3),e.ALo(4,"async"),e._UZ(5,"span",3),e.qZA()(),e.YNc(6,Ei,3,3,"ul",4),e.qZA()),2&t&&(e.xp6(1),e.Q6J("title",n.getTitle()),e.xp6(2),e.hij(" ",e.lcZ(4,2,n.dsService.currentConnection$)||"Select Connection",""))},dependencies:[G.Hz,G.Mq,G.TO,l.sg,l.Ov]}),i})();class Fi{init(i){const s=document.createElement("div"),t=`${i.data?.schemaName}.${i.data?.objectName}`,n=function Zi(o){return o?.objectType?Ni[o.objectType]??"fa-question":"fa-question"}(i.data);s.innerHTML=`<span><i class="fa ${n} mx-1"></i>\n            <span class="filename"></span>${t}</span>`,this.eGui=s.firstChild}getGui(){return this.eGui}refresh(){return!1}}const Ni={[te.HA.Table]:"fa-table",[te.HA.View]:"fa-file-text-o",[te.HA.Procedure]:"fa-code",[te.HA.Function]:"fa-code"};function Ri(o,i){if(1&o&&(e.TgZ(0,"alert",4)(1,"strong"),e._uU(2,"Error:"),e.qZA(),e._uU(3),e.qZA()),2&o){const s=e.oxw();e.xp6(3),e.hij("",s.error," ")}}function qi(o,i){if(1&o){const s=e.EpF();e.TgZ(0,"ag-grid-angular",5,6),e.NdJ("cellClicked",function(n){e.CHM(s);const a=e.oxw();return e.KtG(a.onCellClicked(n))})("rowDataUpdated",function(n){e.CHM(s);const a=e.oxw();return e.KtG(a.onRowDataUpdated(n))})("gridReady",function(n){e.CHM(s);const a=e.oxw();return e.KtG(a.onGridReady(n))}),e.ALo(2,"async"),e.qZA()}if(2&o){const s=e.oxw();e.Q6J("groupDefaultExpanded",1)("rowHeight",30)("gridOptions",s.gridConfig)("rowData",e.lcZ(2,6,s.rowData$))("rowSelection","single")("animateRows",!0)}}function Ji(o,i){if(1&o){const s=e.EpF();e.TgZ(0,"div",7)(1,"div",8)(2,"span",9),e._uU(3,"Loading..."),e.qZA()(),e.TgZ(4,"i",10),e.NdJ("click",function(){e.CHM(s);const n=e.oxw();return e.KtG(n.onCancel())}),e.qZA()()}}let Li=(()=>{var o;class i{constructor(t,n,a,r,c,d,h){this.sqlMetaService=t,this.connectionsService=n,this.tabsService=a,this.studioService=r,this.commands=c,this.router=d,this.dialogService=h,this.destroy$=new N.x,this.cancelLoading=!1,this.loading$=new N.x,this.rowData$=new ht.X([]),this.gridConfig={columnDefs:[{field:"objectType",rowGroup:!0,hide:!0},{field:"objectName",flex:1,cellRenderer:Fi,cellClass:"group-padding"}],getContextMenuItems:this.getContextMenuItems.bind(this),overlayNoRowsTemplate:'<div class="ag-overlay-loading-center">Select connection with DB objects</div>'}}onGridReady(t){this.gridApi=t.api,this.gridApi.setHeaderHeight(0),this.gridApi.setGroupHeaderHeight(0)}onChangeConnection(t){var n=this;return(0,_.Z)(function*(){if(t){n.loadingConnectionName=t,n.loading$.next(!0),n.rowData$.next([]),n.error=void 0;try{const a=yield n.sqlMetaService.getObjects(t,!0);n.cancelLoading||n.rowData$.next(a)}catch(a){n.cancelLoading||(n.error=(0,O.e$)(a))}finally{n.cancelLoading=!1,n.loading$.next(!1)}}else n.rowData$.next([])})()}onCellClicked(t){var n=this;return(0,_.Z)(function*(){return!!t.data&&n.openDbItem(t.data)})()}ngOnInit(){var n,a,r,t=this;this.connectionsService.loadMyDbConnections(),this.connectionsService.dbConnectionsList$.pipe((0,y.R)(this.destroy$)).subscribe(c=>this.dbConnectionsList=c),this.studioService.dbItemsChanged$.subscribe(function(c){return(n=n||(0,_.Z)(function*(d){yield t.connectionsService.loadMyDbConnections(!0),yield t.onChangeConnection(d.connectionName),t.selectDbLink(d.schemaName,d.objectName)})).apply(this,arguments)}),this.studioService.currentConnection$.pipe((0,y.R)(this.destroy$)).subscribe(function(c){return(a=a||(0,_.Z)(function*(d){return yield t.onChangeConnection(d)})).apply(this,arguments)}),this.tabsService.activeTab$.pipe((0,y.R)(this.destroy$)).subscribe(function(c){return(r=r||(0,_.Z)(function*(d){if("sql"===d?.tabParams.appOrSql){const h=(0,be.jE)(d.tabParams);t.currentDbObject=`${h.schemaName}.${h.objectName}`,t.currentConnection===h?.connectionName&&t.selectDbLink(h.schemaName,h.objectName)}else t.gridApi&&t.gridApi.deselectAll()})).apply(this,arguments)})}onRowDataUpdated(t){if(!this.currentDbObject)return void(this.currentConnection=this.loadingConnectionName);const[n,a]=this.currentDbObject.split(".");n&&a&&setTimeout(()=>{this.selectDbLink(n,a),this.currentConnection=this.loadingConnectionName},200)}ngOnDestroy(){this.destroy$.next(null),this.destroy$.complete()}onCancel(){this.currentConnection=void 0,this.loading$.next(!1),this.cancelLoading=!0}selectDbLink(t,n){this.gridApi&&(0,en.JE)(this.gridApi,a=>a.schemaName===t&&a.objectName===n)}get connection(){if(this.currentConnection)return this.dbConnectionsList?.find(t=>t.connectionName===this.currentConnection)}openDbItem(t){var n=this;return(0,_.Z)(function*(){return n.router.navigate(["data-studio","sql",n.currentConnection,(0,be._1)(t)])})()}getContextMenuItems(t){if(!t.node)return[];const n=t.node;if(!this.currentConnection)return[];const r={...n.data,connectionName:this.currentConnection};switch(n.data?.objectType){case te.HA.Procedure:return this.getProcedureMenu(n,r);case te.HA.Table:return this.getTableMenu(n,r);case te.HA.View:return this.getViewMenu(n,r);case te.HA.Function:return this.getFunctionMenu(n,r);default:return this.getGroupMenu(n.key)}}getProcedureMenu(t,n){var r,a=this;return[{name:"JSPython: Execute",action:()=>this.commands.spExecuteInNewJspyTab(n),icon:(0,O.YO)("code-square")},"separator",{name:"Edit Procedure",action:()=>this.commands.editViewInNewSqlTab(n),icon:(0,O.YO)("code")},{name:"Delete Procedure",action:function(){return(r=r||(0,_.Z)(function*(){(yield a.commands.deleteSqlProcedure(n))&&a.onDbLinkRemoved(t)})).apply(this,arguments)},icon:(0,O.YO)("trash")}]}getTableMenu(t,n){var r,a=this;return[{name:"SQL: Select top 1000",action:()=>this.commands.addSelect1000SqlTab(n),icon:(0,O.YO)("filetype-sql")},{name:"JSPython: Select top 1000",action:()=>this.commands.addSelect1000JspyTab(n),icon:(0,O.YO)("code")},{name:"Create New Data Query",action:()=>this.commands.addDataQueryTabFromTableLink(n),icon:(0,O.YO)("journal-plus")},"separator",{name:"Design Table",action:()=>this.commands.editSqlTableMetadata(n).then(c=>{c&&this.tabsService.reloadSqlTab(n)}),icon:(0,O.YO)("table")},{name:"Delete Table",action:function(){return(r=r||(0,_.Z)(function*(){(yield a.commands.deleteSqlTable(n))&&a.onDbLinkRemoved(t)})).apply(this,arguments)},icon:(0,O.YO)("trash")}]}onDbLinkRemoved(t){const n=t.group?t.allLeafChildren:[t];this.gridApi?.applyTransaction({remove:n.map(a=>a.data).filter(a=>!!a)}),this.tabsService.removeConnectionTab({...t.data,connectionName:this.currentConnection})}getViewMenu(t,n){var r,a=this;return[{name:"SQL: Select top 1000",action:()=>this.commands.addSelect1000SqlTab(n),icon:(0,O.YO)("filetype-sql")},{name:"JSPython: Select top 1000",action:()=>this.commands.addSelect1000JspyTab(n),icon:(0,O.YO)("code")},{name:"Create New Data Query",action:()=>this.commands.addDataQueryTabFromTableLink(n),icon:(0,O.YO)("journal-plus")},"separator",{name:"Edit View",action:()=>this.commands.editViewInNewSqlTab(n),icon:(0,O.YO)("table")},{name:"Delete View",action:function(){return(r=r||(0,_.Z)(function*(){(yield a.commands.deleteSqlView(n))&&a.onDbLinkRemoved(t)})).apply(this,arguments)},icon:(0,O.YO)("trash")}]}getFunctionMenu(t,n){var r,a=this;return[{name:"JSPython: Execute",action:()=>this.commands.spExecuteInNewJspyTab(n),icon:(0,O.YO)("code-square")},"separator",{name:"Edit Function",action:()=>this.commands.editViewInNewSqlTab(n),icon:(0,O.YO)("code")},{name:"Delete Function",action:function(){return(r=r||(0,_.Z)(function*(){(yield a.commands.deleteSqlFunction(n))&&a.onDbLinkRemoved(t)})).apply(this,arguments)},icon:(0,O.YO)("trash")}]}getGroupMenu(t){if(void 0===this.currentConnection)return[];const n=this.currentConnection;switch(t){case"Table":return[{name:"Create Table",action:()=>this.commands.createNewTable(n),icon:(0,O.YO)("table")}];case"Function":return[{name:"Create Function",action:()=>this.commands.addNewFunctionTab(this.connection),icon:(0,O.YO)("code")}];case"Procedure":return[{name:"Create Procedure",action:()=>this.commands.addNewProcedureTab(n),icon:(0,O.YO)("code")}];case"View":return[{name:"Create View",action:()=>this.commands.addNewViewTab(n),icon:(0,O.YO)("table")}]}return[]}}return(o=i).\u0275fac=function(t){return new(t||o)(e.Y36(Ht.h),e.Y36(Ae.F),e.Y36(oe.x),e.Y36(ee.F),e.Y36(ye.q),e.Y36(K.F0),e.Y36(ne.x))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-db-tree"]],decls:6,vars:7,consts:[[1,"h-100","d-flex","flex-column"],["type","danger","class","mx-2",4,"ngIf"],["class","flex-fill w-auto m-0 ag-theme-balham ws-ag-tree","groupDisplayType","groupRows",3,"groupDefaultExpanded","rowHeight","gridOptions","rowData","rowSelection","animateRows","cellClicked","rowDataUpdated","gridReady",4,"ngIf"],["class","d-flex justify-content-center align-items-center w-100 h-100 spinner",4,"ngIf"],["type","danger",1,"mx-2"],["groupDisplayType","groupRows",1,"flex-fill","w-auto","m-0","ag-theme-balham","ws-ag-tree",3,"groupDefaultExpanded","rowHeight","gridOptions","rowData","rowSelection","animateRows","cellClicked","rowDataUpdated","gridReady"],["grid",""],[1,"d-flex","justify-content-center","align-items-center","w-100","h-100","spinner"],["role","status",1,"spinner-border"],[1,"sr-only"],["aria-hidden","true",1,"fa","fa-times","cancel-loading","cursor-pointer",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.YNc(1,Ri,4,1,"alert",1),e.YNc(2,qi,3,8,"ag-grid-angular",2),e.ALo(3,"async"),e.YNc(4,Ji,5,0,"div",3),e.ALo(5,"async"),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",n.error),e.xp6(1),e.Q6J("ngIf",!0!==e.lcZ(3,3,n.loading$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(5,5,n.loading$)))},dependencies:[Ee.N8,ut.wx,l.O5,l.Ov],styles:[".ws-ag-tree[_ngcontent-%COMP%]     .group-padding{padding-left:2rem}"]}),i})();var ji=p(91334),je=function(o){return o.Project="Project",o.Connection="Connection",o}(je||{});class nn{static appToFilterItem(i){return{type:je.Project,name:i.title,value:[je.Project,i.appOwner,i.appName].join("/"),selected:!1}}static connectionToFilterItem(i){return{type:je.Connection,name:i.connectionName,value:`${je.Connection}/${i.connectionType}-${i.connectionName}`,selected:!1}}}var on=p(30641);const Hi=["pop"],Qi=function(o){return{selected:o}};function Bi(o,i){if(1&o){const s=e.EpF();e.TgZ(0,"button",2,3),e.NdJ("onHidden",function(){e.CHM(s);const n=e.oxw();return e.KtG(n.onHidden())}),e._UZ(2,"i",4),e.qZA()}if(2&o){const s=e.oxw(),t=e.MAs(2);e.Q6J("ngClass",e.VKq(3,Qi,null==s.selected?null:s.selected.length))("outsideClick",!1)("popover",t)}}function Yi(o,i){if(1&o){const s=e.EpF();e.TgZ(0,"div",5)(1,"div",6)(2,"div",7),e._UZ(3,"i",8),e.qZA()(),e.TgZ(4,"input",9),e.NdJ("input",function(n){e.CHM(s);const a=e.oxw();return e.KtG(a.onSearch(n))}),e.qZA()(),e.TgZ(5,"div",10)(6,"ag-grid-angular",11),e.NdJ("gridReady",function(n){e.CHM(s);const a=e.oxw();return e.KtG(a.onGridReady(n))}),e.qZA()(),e.TgZ(7,"div",12)(8,"button",13),e.NdJ("click",function(){e.CHM(s);const n=e.oxw();return e.KtG(n.onClear())}),e._uU(9,"Clear"),e.qZA(),e.TgZ(10,"button",14),e.NdJ("click",function(){e.CHM(s);const n=e.oxw();return e.KtG(n.onApply())}),e._uU(11,"Apply"),e.qZA(),e.TgZ(12,"button",13),e.NdJ("click",function(){e.CHM(s);const n=e.oxw();return e.KtG(n.onClose())}),e._uU(13,"Close"),e.qZA()()}if(2&o){const s=e.oxw();e.xp6(4),e.Q6J("value",s.search),e.xp6(2),e.Q6J("columnDefs",s.columnDefs)("defaultColDef",s.defaultColDef)("groupDefaultExpanded",-1)("rowData",s.rows)("gridOptions",s.gridOptions)}}let zi=(()=>{var o;class i{constructor(t,n,a){this.appService=t,this.connectionsService=n,this.authService=a,this.apply=new e.vpe,this.rows=[],this.selected=[],this.search="",this.hasMultipleItems=!1,this.defaultColDef={editable:!0,sortable:!1,suppressFiltersToolPanel:!0,suppressMovable:!0,suppressColumnsToolPanel:!0,suppressMenu:!0},this.gridOptions={},this.columnDefs=[{field:"type",hide:!0,width:0,rowGroup:!0,rowGroupIndex:0},{field:"selected",headerName:"?",width:40},{field:"name",flex:1}]}onGridReady(t){this.gridApi=t.api,this.gridApi.setHeaderHeight(0)}ngOnInit(){this.setUsersLocalSearchIn(),(0,Ut.a)([this.appService.appsList$,this.connectionsService.dbConnectionsList$]).subscribe(([t,n])=>{this.rows=[...t.map(nn.appToFilterItem),...n.map(nn.connectionToFilterItem)],this.updateSelectedState(),this.hasMultipleItems=this.rows.length>1})}onApply(){this.selected=this.getValue(),this.apply.emit(this.selected),this.pop?.hide(),this.storageKey&&localStorage.setItem(this.storageKey,JSON.stringify(this.selected))}onClose(){this.pop?.hide()}onClear(){this.rows.forEach(t=>t.selected=!1),this.onApply()}onHidden(){this.updateSelectedState()}onSearch(t){this.search=t?.target?.value}getValue(){return this.rows.filter(t=>t.selected).map(t=>t.value)}updateSelectedState(){this.rows.forEach(t=>{t.selected=!!this.selected?.includes(t.value)})}setUsersLocalSearchIn(){this.authService.isAuthenticated$.pipe((0,F.h)(t=>t)).subscribe(()=>{this.storageKey=`${this.authService.user?.userId}-selected-search-in`;const t=localStorage.getItem(this.storageKey);if(t)try{const n=JSON.parse(t??"");Array.isArray(n)&&n.length&&(this.selected=n,this.apply.emit(this.selected))}catch(n){console.error(`Can't parse stored search in: ${n.message}`)}})}}return(o=i).\u0275fac=function(t){return new(t||o)(e.Y36(B.UW),e.Y36(Ae.F),e.Y36(B.$h))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-data-studio-search-filter"]],viewQuery:function(t,n){if(1&t&&e.Gf(Hi,5),2&t){let a;e.iGM(a=e.CRH())&&(n.pop=a.first)}},hostBindings:function(t,n){1&t&&e.NdJ("keydown.enter",function(r){return n.onApply(r)},!1,e.pYS)},inputs:{value:"value"},outputs:{apply:"apply"},decls:3,vars:1,consts:[["type","button","class","btn btn-sm","containerClass","search-filter-popover","container","body","boundariesElement","viewport","placement","bottom","title","Filter search context",3,"ngClass","outsideClick","popover","onHidden",4,"ngIf"],["filterTemplate",""],["type","button","containerClass","search-filter-popover","container","body","boundariesElement","viewport","placement","bottom","title","Filter search context",1,"btn","btn-sm",3,"ngClass","outsideClick","popover","onHidden"],["pop","bs-popover"],[1,"fa","fa-filter"],[1,"input-group","mb-1"],[1,"input-group-prepend"],[1,"input-group-text"],[1,"fa","fa-search"],["type","text","placeholder","Search",1,"form-control","form-control-sm",3,"value","input"],[2,"height","350px","max-height","350px"],["rowSelection","single","groupDisplayType","groupRows",1,"ag-theme-balham","h-100","flex-fill","w-100",3,"columnDefs","defaultColDef","groupDefaultExpanded","rowData","gridOptions","gridReady"],[1,"d-flex","mt-2","pt-2","border-top"],["type","button",1,"btn","btn-light","btn-sm",3,"click"],["type","button",1,"btn","btn-primary","btn-sm","ml-auto","mr-2",3,"click"]],template:function(t,n){1&t&&(e.YNc(0,Bi,3,5,"button",0),e.YNc(1,Yi,14,6,"ng-template",null,1,e.W1O)),2&t&&e.Q6J("ngIf",n.hasMultipleItems)},dependencies:[Ee.N8,l.mk,l.O5,on.k5],styles:[".search-filter-popover{min-width:350px}button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--color);opacity:.5}button.selected[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{opacity:1}"]}),i})();function $i(o,i){1&o&&e._UZ(0,"i",8)}function Ui(o,i){1&o&&e._UZ(0,"i",9)}const Gi=function(o){return{"font-weight-bold highlighted":o}};function Vi(o,i){if(1&o&&(e.TgZ(0,"span",10),e._uU(1),e.qZA()),2&o){const s=i.$implicit;e.Q6J("ngClass",e.VKq(2,Gi,s.isBold)),e.xp6(1),e.Oqu(s.token)}}function Ki(o,i){if(1&o&&(e.YNc(0,$i,1,0,"i",4),e.YNc(1,Ui,1,0,"i",5),e.YNc(2,Vi,2,4,"span",6),e.TgZ(3,"span",7),e._uU(4),e.qZA()),2&o){const s=i.item;e.Q6J("ngIf","Connection"===s.projectOrConnection),e.xp6(1),e.Q6J("ngIf","Project"===s.projectOrConnection),e.xp6(1),e.Q6J("ngForOf",s.tokens),e.xp6(2),e.hij(" (",s.projectOrConnectionName,")")}}let Xi=(()=>{var o;class i{constructor(t,n){this.router=t,this.appService=n,this.searchItems=[],this.searchText$=new N.x,this.loading=!1;let a="";this.searchText$.pipe((0,Me.b)(500),(0,Pt.x)(),(0,pt.b)(r=>this.loading=!0),(0,Et.w)(r=>(a=r,this.appService.searchForLinks$(r||"",this.searchIn)))).subscribe(r=>{this.searchItems=r.map(c=>({...c,projectGroup:`${c.projectOrConnection}: ${c.projectOrConnectionName}`,tokens:(0,ji.a$)(c.name,a)})),this.loading=!1})}onSearchSelected(t){if(t)if("Connection"===t.projectOrConnection)this.router.navigate(["data-studio/sql",t.projectOrConnectionName,`${t.name}.${t.contentType}`]);else if("Project"===t.projectOrConnection){const n=t.projectOrConnectionName.split("/");this.router.navigate(["data-studio/app",n[0],n[1]],{queryParams:{file:(0,O.nV)(t)}})}}onFilterApply(t){this.searchIn=t}}return(o=i).\u0275fac=function(t){return new(t||o)(e.Y36(K.F0),e.Y36(B.UW))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-data-studio-search-box"]],decls:4,vars:4,consts:[[1,"d-flex","flex-row","overflow-hidden","h-100","pb-2","w-100"],["appendTo","body",1,"auto-grow","ng-select-sm","w-100",3,"placeholder","loading","items","typeahead","change"],["ng-option-tmp",""],[3,"apply"],["class","fa fa-database mr-2",4,"ngIf"],["class","fa fa-code mr-2",4,"ngIf"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"font-italic"],[1,"fa","fa-database","mr-2"],[1,"fa","fa-code","mr-2"],[3,"ngClass"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"ng-select",1),e.NdJ("change",function(r){return n.onSearchSelected(r)}),e.YNc(2,Ki,5,4,"ng-template",2),e.qZA(),e.TgZ(3,"app-data-studio-search-filter",3),e.NdJ("apply",function(r){return n.onFilterApply(r)}),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("placeholder","Search for files or sql objects")("loading",n.loading)("items",n.searchItems)("typeahead",n.searchText$))},dependencies:[l.mk,l.sg,l.O5,Ke.w9,Ke.ir,zi],styles:['[_ngcontent-%COMP%]:root{--bg: #fff;--body-bg: #e4e5e6;--header-bg: #ebedef;--color: #4f5d73;--border-color: #c4c9d0;--ws-alt: #f7f7f7;--form-input-bg: #fff;--form-input-color: #768192;--nav-link-color: #8a93a2;--secondary-color: #c4c9d0;--opacity: .05;--hover: "#f0f3f5";--ag-edited-cell-bg: "rgba(255, 218, 218, 0.6)";--ag-added-cell-bg: "rgba(226, 255, 226, 0.5)"}ng-select[_ngcontent-%COMP%]{max-width:650px}']}),i})();function Wi(o,i){if(1&o){const s=e.EpF();e.TgZ(0,"div",16)(1,"a",17),e.NdJ("click",function(){e.CHM(s);const n=e.oxw(2);return e.KtG(n.downloadApp())}),e._uU(2,"Download App"),e.qZA(),e.TgZ(3,"a",17),e.NdJ("click",function(){e.CHM(s);const n=e.oxw(2);return e.KtG(n.uploadApp())}),e._uU(4,"Upload App"),e.qZA()()}if(2&o){const s=e.oxw(2);e.xp6(3),e.uIk("disabled",!s.app)}}function eo(o,i){1&o&&(e.TgZ(0,"span",15)(1,"button",12),e._UZ(2,"i",13),e.qZA(),e.YNc(3,Wi,5,1,"div",14),e.qZA())}function to(o,i){if(1&o){const s=e.EpF();e.TgZ(0,"div",16)(1,"a",17),e.NdJ("click",function(){e.CHM(s);const n=e.oxw();return e.KtG(n.newTable())}),e._UZ(2,"i",18),e._uU(3,"New Table"),e.qZA(),e.TgZ(4,"a",17),e.NdJ("click",function(){e.CHM(s);const n=e.oxw();return e.KtG(n.newSqlQuery())}),e._UZ(5,"i",19),e._uU(6,"New Sql Query"),e.qZA(),e._UZ(7,"div",20),e.TgZ(8,"a",17),e.NdJ("click",function(){e.CHM(s);const n=e.oxw();return e.KtG(n.openConnectionSettings())}),e._UZ(9,"i",21),e._uU(10,"Connection Details"),e.qZA(),e.TgZ(11,"a",17),e.NdJ("click",function(){e.CHM(s);const n=e.oxw();return e.KtG(n.refreshConnections())}),e._UZ(12,"i",22),e._uU(13,"Reload Db Objects"),e.qZA()()}}let no=(()=>{var o;class i{constructor(t,n,a,r,c,d,h){this.connectionsService=t,this.container=n,this.dataStudioService=a,this.appUploaderService=r,this.dialogService=c,this.tabsService=d,this.commandsService=h,this.appContentSize=200,this.collapsed=!1}ngOnInit(){this.dataStudioService.currentApp?this.setExplorerSize():(this.appContentSize=40,this.collapsed=!0),this.dataStudioService.currentApp$.pipe((0,pt.b)(t=>this.app=t),(0,F.h)(t=>!!t&&this.collapsed&&40===this.appContentSize)).subscribe(()=>this.setExplorerSize()),this.tabsService.activeTab$.subscribe(t=>{t?.tabParams?.name!==le.b5&&this.activateTab(t?.tabParams.appOrSql)}),this.dataStudioService.appOrSql$.subscribe(t=>this.activateTab(t))}newTable(){this.commandsService.createNewTable(this.dataStudioService.getCurrentConnection())}newSqlQuery(){this.commandsService.addNewSqlQueryTab(this.dataStudioService.getCurrentConnection())}openConnectionSettings(){var t=this;return(0,_.Z)(function*(){const n=t.dataStudioService.getCurrentConnection(),a=n&&"undefined"!==n?yield(0,$t.n)(t.connectionsService.getDbConnection$(n)):void 0;t.dialogService.open(Ai.Z,{class:"modal-lg full-height",initialState:{config:a||{...te.Ti}}})})()}refreshConnections(){this.connectionsService.loadMyDbConnections(!0),this.dataStudioService.dbItemsChanged({connectionName:this.dataStudioService.getCurrentConnection()})}downloadApp(){if(!this.appTree)throw new Error("config is not initialized");this.dialogService.open(wi,{initialState:{app:this.app}}).onCloseAsync()}uploadApp(){var t=this;return(0,_.Z)(function*(){if(!t.app)throw new Error("app is not initialized");const n=t.dialogService.open(ki.b,{class:"modal-sm",initialState:{message:"Uploading files from zip..."}});try{yield t.appUploaderService.uploadApp(t.app),t.appTree?.refreshAppFiles(t.app)}finally{n.close()}})()}setExplorerSize(t){this.appContentSize=t||this.container.element.nativeElement.offsetHeight/2,this.collapsed=!1}activateTab(t){this.tabset?.tabs?.length&&("app"===t?this.tabset.tabs[0].active=!0:"sql"===t&&(this.tabset.tabs[1].active=!0))}}return(o=i).\u0275fac=function(t){return new(t||o)(e.Y36(Ae.F),e.Y36(e.s_b),e.Y36(ee.F),e.Y36(gt),e.Y36(ne.x),e.Y36(oe.x),e.Y36(ye.q))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-data-studio-sidebar"]],viewQuery:function(t,n){if(1&t&&(e.Gf(tn,5),e.Gf(Se.AH,7)),2&t){let a;e.iGM(a=e.CRH())&&(n.appTree=a.first),e.iGM(a=e.CRH())&&(n.tabset=a.first)}},decls:20,vars:3,consts:[[1,"d-flex","flex-column","overflow-hidden","h-100"],[1,"tabset-fx","nav-tabs-boxed","overflow-hidden","navs-bottom"],["heading","Apps",1,"p-0",3,"removable"],[1,"card","w-100","h-100","m-0"],[1,"card-header","px-2","py-1","d-flex","align-items-center","cursor-pointer"],[1,"bi","bi-app-indicator","mr-1"],["dropdown","","container","body","class","d-flex position-relative px-0 ml-auto","placement","bottom left",4,"ngIf"],[1,"card-body","overflow-hidden","p-0"],["heading","SQL",1,"p-0",3,"removable"],[1,"bi","bi-database","mr-1"],[1,"w-100","overflow-hidden"],["dropdown","","container","body","placement","bottom left",1,"d-flex","position-relative","pl-2","pr-0","ml-auto"],["dropdownToggle","","type","button",1,"px-0","btn","btn-primary-outline","py-0"],[1,"fa","fa-ellipsis-v"],["id","add-dropdown","class","dropdown-menu dropdown-menu-right","aria-labelledby","add-btn-dropdown",4,"dropdownMenu"],["dropdown","","container","body","placement","bottom left",1,"d-flex","position-relative","px-0","ml-auto"],["id","add-dropdown","aria-labelledby","add-btn-dropdown",1,"dropdown-menu","dropdown-menu-right"],[1,"dropdown-item",3,"click"],["aria-hidden","true",1,"bi","bi-table","mr-2"],["aria-hidden","true",1,"fa","fa-plus","mr-2"],[1,"divider","dropdown-divider"],["aria-hidden","true",1,"fa","fa-cog"],["aria-hidden","true",1,"fa","fa-refresh"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"app-data-studio-search-box"),e.TgZ(2,"tabset",1)(3,"tab",2)(4,"div",3)(5,"div",4),e._UZ(6,"i",5)(7,"app-selection"),e.YNc(8,eo,4,0,"span",6),e.qZA(),e._UZ(9,"app-tree",7),e.qZA()(),e.TgZ(10,"tab",8)(11,"div",3)(12,"div",4),e._UZ(13,"i",9)(14,"app-db-selection",10),e.TgZ(15,"span",11)(16,"button",12),e._UZ(17,"i",13),e.qZA(),e.YNc(18,to,14,0,"div",14),e.qZA()(),e._UZ(19,"app-db-tree",7),e.qZA()()()()),2&t&&(e.xp6(3),e.Q6J("removable",!1),e.xp6(5),e.Q6J("ngIf",n.app),e.xp6(2),e.Q6J("removable",!1))},dependencies:[G.Hz,G.Mq,G.TO,l.O5,Se.wW,Se.AH,Di,tn,Ii,Li,Xi],styles:["[_nghost-%COMP%]{height:100%;display:block}span.disabled[_ngcontent-%COMP%]{opacity:.5}.files-panel[_ngcontent-%COMP%]     .panel.card{height:100%}.files-panel[_ngcontent-%COMP%]     .panel-title .accordion-toggle>button{color:var(--color);padding-left:.5rem;text-decoration:none}.files-panel[_ngcontent-%COMP%]     .panel-body.card-block.card-body{padding:0}.files-panel[_ngcontent-%COMP%]     .panel-collapse.collapse.in.show{overflow:auto!important}.files-panel[_ngcontent-%COMP%]     app-tree{min-height:100px;display:block}.files-panel.panel-open[_ngcontent-%COMP%]{flex:1 1 auto}.files-panel[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{margin-bottom:8px}.files-panel[_ngcontent-%COMP%]   .fa.fa-folder-o[_ngcontent-%COMP%]{margin-left:-7px;position:absolute;top:11px}.files-panel[_ngcontent-%COMP%]   .fa.fa-file-o[_ngcontent-%COMP%]{margin-left:-6px;position:absolute;top:9px}accordion[_ngcontent-%COMP%]     .accordion-toggle{display:flex}accordion[_ngcontent-%COMP%]     .panel.card{margin-bottom:1px}accordion[_ngcontent-%COMP%]     .panel-body.card-block.card-body{padding:0}.disabled[_ngcontent-%COMP%]{opacity:.7}.card-header[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{color:var(--color)}.navs-bottom[_ngcontent-%COMP%]     .nav.nav-tabs{order:1}.navs-bottom[_ngcontent-%COMP%]     .tab-content{border-radius:.25rem .25rem .25rem 0}.navs-bottom[_ngcontent-%COMP%]     .nav-tabs .nav-item{margin-top:-1px;margin-bottom:0}.navs-bottom[_ngcontent-%COMP%]     .nav-tabs .nav-item:hover .nav-link, .navs-bottom[_ngcontent-%COMP%]     .nav-tabs .nav-item.active .nav-link{border-bottom-color:var(--border-color)}.navs-bottom[_ngcontent-%COMP%]     .nav-tabs .nav-link{border-top:none;border-top-left-radius:0;border-top-right-radius:0;border-bottom-left-radius:.25rem;border-bottom-right-radius:.25rem}"]}),i})();var an=p(93613);function io(o,i){if(1&o){const s=e.EpF();e.TgZ(0,"app-data-filters",5,6),e.NdJ("filtersBarChanged",function(n){e.CHM(s);const a=e.oxw();return e.KtG(null==a.tabContent?null:a.tabContent.onFiltersBarChanged(n))}),e.qZA()}if(2&o){const s=e.oxw();e.Q6J("filtersBar",null==s.tabContent||null==s.tabContent.queryInfo?null:s.tabContent.queryInfo.filtersBar)("dataSource",null==s.tabContent?null:s.tabContent.dataSource)}}let oo=(()=>{var o;class i{constructor(){this.ConnectionLevels=me.EQ,this.showFiltersBar=!1,this.showSearch=!1}ngOnChanges(t){t.currentTab?.currentValue&&(this.showFiltersBar=!1,ve.z.schedule(()=>{this.showFiltersBar=!0}))}get tabContent(){return this.currentTab?.content}}return(o=i).\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-tab-data-query-actions"]],inputs:{currentTab:"currentTab"},features:[e.TTD],decls:5,vars:2,consts:[[1,"d-flex","flex-row","mx-0","align-items-center"],[1,"mr-2","ml-auto"],[3,"filtersBar","dataSource","filtersBarChanged",4,"ngIf"],[1,"btn","px-2",3,"title","click"],[1,"fa","fa-cog"],[3,"filtersBar","dataSource","filtersBarChanged"],["filtersBar",""]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"div",1),e.YNc(2,io,2,2,"app-data-filters",2),e.TgZ(3,"button",3),e.NdJ("click",function(){return null==n.tabContent?null:n.tabContent.openQueryManager()}),e._UZ(4,"i",4),e.qZA()()),2&t&&(e.xp6(2),e.Q6J("ngIf",n.showFiltersBar&&(null==n.tabContent?null:n.tabContent.dataSource)),e.xp6(1),e.s9C("title",null==n.tabContent||null==n.tabContent.queryInfo||null==n.tabContent.queryInfo.sqlQuery?null:n.tabContent.queryInfo.sqlQuery.tableName))},dependencies:[l.O5,an.K],styles:[".fa.fa-cog[_ngcontent-%COMP%], .fa.fa-refresh[_ngcontent-%COMP%], .fa.fa-search[_ngcontent-%COMP%]{color:var(--color)}"]}),i})(),so=(()=>{var o;class i{constructor(){this.previewUrl=(0,e.tdS)("")}ngOnChanges({currentTab:t}){if(t){const{appOrSql:n,file:a,name:r,owner:c}=t.currentValue.tabParams;this.previewUrl.set(`/${n}/${c}/${r}/${a}`)}}}return(o=i).\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-dcml-actions"]],inputs:{currentTab:"currentTab"},features:[e.TTD],decls:3,vars:1,consts:[["data-toggle","buttons",1,"btn-group"],["target","_blank",1,"btn","btn-sm","btn-outline-success","button",3,"href"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"a",1),e._uU(2,"Preview"),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("href",n.previewUrl(),e.LSH))},encapsulation:2,changeDetection:0}),i})();var ao=p(61240),ro=p(92604);function lo(o,i){if(1&o&&(e.TgZ(0,"span",12),e._uU(1),e.qZA()),2&o){const s=i.ngIf;e.xp6(1),e.hij(" ",s/1e3,"s\n")}}function co(o,i){if(1&o){const s=e.EpF();e.TgZ(0,"li",15)(1,"a",16),e.NdJ("click",function(){const a=e.CHM(s).$implicit,r=e.oxw(2);return e.KtG(null==r.tabContent?null:r.tabContent.onSelectConnection(a.connectionName))}),e._uU(2),e.qZA()()}if(2&o){const s=i.$implicit;e.xp6(2),e.Oqu(s.connectionName)}}function uo(o,i){if(1&o&&(e.TgZ(0,"ul",13),e.YNc(1,co,3,1,"li",14),e.qZA()),2&o){const s=e.oxw();e.xp6(1),e.Q6J("ngForOf",null==s.tabContent?null:s.tabContent.connections)}}function po(o,i){1&o&&e._UZ(0,"span",17)}function ho(o,i){if(1&o&&(e.ynx(0),e._uU(1),e.BQk()),2&o){const s=e.oxw();e.xp6(1),e.hij(" ",((null==s.tabContent||null==s.tabContent.selectedText?null:s.tabContent.selectedText.length)||0)>5?"Run Selected SQL":"Run"," ")}}let fo=(()=>{var o;class i{constructor(){this.showSearch=!1}ngOnDestroy(){this.sub?.unsubscribe()}get tabContent(){return this.currentTab?.content}toggleDirection(){this.tabContent?.toggleDirection()}onRunClick(){var t=this;return(0,_.Z)(function*(){yield t.tabContent?.onRunClick()})()}}return(o=i).\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-tab-sql-content-actions"]],inputs:{currentTab:"currentTab"},decls:13,vars:6,consts:[["class","align-self-center badge badge-info p-2 mr-2",4,"ngIf"],["title","Show/ Hide loaded data search",1,"btn","btn-sm","px-1",3,"click"],[1,"fa","fa-search"],["dropdown","",1,"btn-group"],["id","button-basic","dropdownToggle","","type","button","disabled","disabled","aria-controls","dropdown-basic",1,"btn","btn-outline-primary","btn-sm","dropdown-toggle","px-3"],[1,"caret"],["id","dropdown-basic","class","dropdown-menu","role","menu","aria-labelledby","button-basic",4,"dropdownMenu"],["type","button",1,"btn","btn-sm","btn-success","mx-2","px-3",3,"disabled","click"],["class","spinner-border",4,"ngIf"],[4,"ngIf"],["title","Switch to horizontal/vertical layout",1,"cursor-pointer","btn","btn-outline-secondary","btn-sm",3,"click"],[1,"fa",3,"ngClass"],[1,"align-self-center","badge","badge-info","p-2","mr-2"],["id","dropdown-basic","role","menu","aria-labelledby","button-basic",1,"dropdown-menu"],["role","menuitem",4,"ngFor","ngForOf"],["role","menuitem"],[1,"dropdown-item",3,"click"],[1,"spinner-border"]],template:function(t,n){1&t&&(e.YNc(0,lo,2,1,"span",0),e.TgZ(1,"button",1),e.NdJ("click",function(){return n.showSearch=!n.showSearch}),e._UZ(2,"i",2),e.qZA(),e.TgZ(3,"div",3)(4,"button",4),e._uU(5),e._UZ(6,"span",5),e.qZA(),e.YNc(7,uo,2,1,"ul",6),e.qZA(),e.TgZ(8,"button",7),e.NdJ("click",function(){return n.onRunClick()}),e.YNc(9,po,1,0,"span",8),e.YNc(10,ho,2,1,"ng-container",9),e.qZA(),e.TgZ(11,"button",10),e.NdJ("click",function(){return n.toggleDirection()}),e._UZ(12,"i",11),e.qZA()),2&t&&(e.Q6J("ngIf",null==n.tabContent?null:n.tabContent.evaluationTime),e.xp6(5),e.Oqu(null==n.tabContent?null:n.tabContent.selectConnection),e.xp6(3),e.Q6J("disabled",null==n.tabContent?null:n.tabContent.evaluating),e.xp6(1),e.Q6J("ngIf",null==n.tabContent?null:n.tabContent.evaluating),e.xp6(1),e.Q6J("ngIf",!(null!=n.tabContent&&n.tabContent.evaluating)),e.xp6(2),e.Q6J("ngClass","vertical"===(null==n.tabContent?null:n.tabContent.direction)?"fa-arrows-h":"fa-arrows-v"))},dependencies:[G.Hz,G.Mq,G.TO,l.mk,l.sg,l.O5],styles:["ng-select[_ngcontent-%COMP%]{flex:0 1 150px}"]}),i})();function mo(o,i){if(1&o&&(e.TgZ(0,"span",5),e._uU(1),e.qZA()),2&o){const s=i.ngIf;e.xp6(1),e.hij("",s/1e3," s")}}function go(o,i){1&o&&e._UZ(0,"span",6)}function _o(o,i){if(1&o&&(e.ynx(0),e._uU(1),e.BQk()),2&o){const s=e.oxw();e.xp6(1),e.hij(" ",null!=s.tabContent&&s.tabContent.selectedText?"Run Selected SQL":"Run"," ")}}let bo=(()=>{var o;class i{constructor(){this.ConnectionLevels=me.EQ}get tabContent(){return this.currentTab?.content}}return(o=i).\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-tab-sql-function-actions"]],inputs:{currentTab:"currentTab"},decls:6,vars:4,consts:[["class","align-self-center badge badge-info p-2 mr-2",4,"ngIf"],["type","button",1,"btn","btn-sm","btn-success","mx-2","px-3",3,"disabled","click"],["class","spinner-border",4,"ngIf"],[4,"ngIf"],[1,"btn","btn-sm","btn-outline-danger","mr-0",3,"click"],[1,"align-self-center","badge","badge-info","p-2","mr-2"],[1,"spinner-border"]],template:function(t,n){1&t&&(e.YNc(0,mo,2,1,"span",0),e.TgZ(1,"button",1),e.NdJ("click",function(){return null==n.tabContent?null:n.tabContent.onRun()}),e.YNc(2,go,1,0,"span",2),e.YNc(3,_o,2,1,"ng-container",3),e.qZA(),e.TgZ(4,"button",4),e.NdJ("click",function(){return null==n.tabContent?null:n.tabContent.onDelete()}),e._uU(5,"Delete"),e.qZA()),2&t&&(e.Q6J("ngIf",null==n.tabContent?null:n.tabContent.evaluationTime),e.xp6(1),e.Q6J("disabled",null==n.tabContent?null:n.tabContent.evaluating),e.xp6(1),e.Q6J("ngIf",null==n.tabContent?null:n.tabContent.evaluating),e.xp6(1),e.Q6J("ngIf",!(null!=n.tabContent&&n.tabContent.evaluating)))},dependencies:[l.O5],styles:["ng-select[_ngcontent-%COMP%]{flex:0 1 150px}"]}),i})();function vo(o,i){if(1&o&&(e.TgZ(0,"span",5),e._uU(1),e.qZA()),2&o){const s=i.ngIf;e.xp6(1),e.hij("",s/1e3," s")}}function yo(o,i){1&o&&e._UZ(0,"span",6)}function Co(o,i){if(1&o&&(e.ynx(0),e._uU(1),e.BQk()),2&o){const s=e.oxw();e.xp6(1),e.hij(" ",null!=s.tabContent&&s.tabContent.selectedText?"Run Selected SQL":"Run"," ")}}let So=(()=>{var o;class i{constructor(){this.ConnectionLevels=me.EQ}get tabContent(){return this.currentTab?.content}}return(o=i).\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-tab-sql-procedure-actions"]],inputs:{currentTab:"currentTab"},decls:6,vars:4,consts:[["class","align-self-center badge badge-info p-2 mr-2",4,"ngIf"],["type","button",1,"btn","btn-sm","btn-success","mx-2","px-3",3,"disabled","click"],["class","spinner-border",4,"ngIf"],[4,"ngIf"],[1,"btn","btn-sm","btn-outline-danger","mr-0",3,"click"],[1,"align-self-center","badge","badge-info","p-2","mr-2"],[1,"spinner-border"]],template:function(t,n){1&t&&(e.YNc(0,vo,2,1,"span",0),e.TgZ(1,"button",1),e.NdJ("click",function(){return null==n.tabContent?null:n.tabContent.onRun()}),e.YNc(2,yo,1,0,"span",2),e.YNc(3,Co,2,1,"ng-container",3),e.qZA(),e.TgZ(4,"button",4),e.NdJ("click",function(){return null==n.tabContent?null:n.tabContent.onDelete()}),e._uU(5,"Delete"),e.qZA()),2&t&&(e.Q6J("ngIf",null==n.tabContent?null:n.tabContent.evaluationTime),e.xp6(1),e.Q6J("disabled",null==n.tabContent?null:n.tabContent.evaluating),e.xp6(1),e.Q6J("ngIf",null==n.tabContent?null:n.tabContent.evaluating),e.xp6(1),e.Q6J("ngIf",!(null!=n.tabContent&&n.tabContent.evaluating)))},dependencies:[l.O5],styles:["ng-select[_ngcontent-%COMP%]{flex:0 1 150px}"]}),i})();function To(o,i){if(1&o){const s=e.EpF();e.TgZ(0,"app-data-filters",6,7),e.NdJ("filtersBarChanged",function(n){e.CHM(s);const a=e.oxw();return e.KtG(null==a.tabContent?null:a.tabContent.onFiltersBarChanged(n))}),e.qZA()}if(2&o){const s=e.oxw();e.Q6J("dataSource",null==s.tabContent?null:s.tabContent.dataSource)("filtersBar",null==s.tabContent||null==s.tabContent.queryInfo?null:s.tabContent.queryInfo.filtersBar)}}let xo=(()=>{var o;class i{constructor(){this.ConnectionLevels=me.EQ}get tabContent(){return this.currentTab?.content}}return(o=i).\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-sql-table-actions"]],inputs:{currentTab:"currentTab"},decls:6,vars:2,consts:[[1,"d-flex","flex-row","mx-0","align-items-center"],["class","pl-2 d-none d-md-flex",3,"dataSource","filtersBar","filtersBarChanged",4,"ngIf"],[1,"btn","px-1",3,"click"],[1,"fa","fa-refresh"],[1,"btn","px-1","d-none","d-md-flex",3,"title","click"],[1,"fa","fa-cog"],[1,"pl-2","d-none","d-md-flex",3,"dataSource","filtersBar","filtersBarChanged"],["filtersBar",""]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.YNc(1,To,2,2,"app-data-filters",1),e.TgZ(2,"button",2),e.NdJ("click",function(){return null==n.currentTab||null==n.currentTab.content?null:n.currentTab.content.reload()}),e._UZ(3,"i",3),e.qZA(),e.TgZ(4,"button",4),e.NdJ("click",function(){return null==n.tabContent?null:n.tabContent.openQueryManager()}),e._UZ(5,"i",5),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("ngIf",null==n.tabContent?null:n.tabContent.dataSource),e.xp6(3),e.s9C("title",null==n.tabContent||null==n.tabContent.queryInfo||null==n.tabContent.queryInfo.sqlQuery?null:n.tabContent.queryInfo.sqlQuery.tableName))},dependencies:[l.O5,an.K],styles:[".fa.fa-cog[_ngcontent-%COMP%], .fa.fa-refresh[_ngcontent-%COMP%], .fa.fa-search[_ngcontent-%COMP%]{color:var(--color)}"]}),i})();function wo(o,i){if(1&o&&e._UZ(0,"app-jspy-actions",3),2&o){const s=e.oxw();e.Q6J("currentTab",s.currentTab)}}function ko(o,i){if(1&o&&e._UZ(0,"app-tab-sql-content-actions",4),2&o){const s=e.oxw();e.Q6J("currentTab",s.currentTab)}}function Ao(o,i){if(1&o&&e._UZ(0,"app-tab-sql-procedure-actions",3),2&o){const s=e.oxw();e.Q6J("currentTab",s.currentTab)}}function Oo(o,i){if(1&o&&e._UZ(0,"app-tab-sql-function-actions",3),2&o){const s=e.oxw();e.Q6J("currentTab",s.currentTab)}}function Mo(o,i){if(1&o&&e._UZ(0,"app-sql-table-actions",3),2&o){const s=e.oxw();e.Q6J("currentTab",s.currentTab)}}function Do(o,i){if(1&o&&e._UZ(0,"app-sql-table-actions",3),2&o){const s=e.oxw();e.Q6J("currentTab",s.currentTab)}}function Po(o,i){if(1&o&&e._UZ(0,"app-tab-json-content-actions",3),2&o){const s=e.oxw();e.Q6J("currentTab",s.currentTab)}}function Eo(o,i){if(1&o&&e._UZ(0,"app-tab-data-query-actions",3),2&o){const s=e.oxw();e.Q6J("currentTab",s.currentTab)}}function Io(o,i){if(1&o&&e._UZ(0,"app-dcml-actions",3),2&o){const s=e.oxw();e.Q6J("currentTab",s.currentTab)}}let Fo=(()=>{var o;class i{constructor(t){this.tabsService=t}ngOnInit(){this.tabsService.activeTab$.subscribe(t=>this.currentTab=t??void 0)}}return(o=i).\u0275fac=function(t){return new(t||o)(e.Y36(oe.x))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-tab-actions"]],decls:10,vars:10,consts:[[3,"ngSwitch"],["class","h-100 w-100 d-flex",3,"currentTab",4,"ngSwitchCase"],["class","h-100 w-100 d-flex align-items-baseline",3,"currentTab",4,"ngSwitchCase"],[1,"h-100","w-100","d-flex",3,"currentTab"],[1,"h-100","w-100","d-flex","align-items-baseline",3,"currentTab"]],template:function(t,n){1&t&&(e.ynx(0,0),e.YNc(1,wo,1,1,"app-jspy-actions",1),e.YNc(2,ko,1,1,"app-tab-sql-content-actions",2),e.YNc(3,Ao,1,1,"app-tab-sql-procedure-actions",1),e.YNc(4,Oo,1,1,"app-tab-sql-function-actions",1),e.YNc(5,Mo,1,1,"app-sql-table-actions",1),e.YNc(6,Do,1,1,"app-sql-table-actions",1),e.YNc(7,Po,1,1,"app-tab-json-content-actions",1),e.YNc(8,Eo,1,1,"app-tab-data-query-actions",1),e.YNc(9,Io,1,1,"app-dcml-actions",1),e.BQk()),2&t&&(e.Q6J("ngSwitch",null==n.currentTab?null:n.currentTab.tabType),e.xp6(1),e.Q6J("ngSwitchCase","jspy"),e.xp6(1),e.Q6J("ngSwitchCase","sql"),e.xp6(1),e.Q6J("ngSwitchCase","procedure"),e.xp6(1),e.Q6J("ngSwitchCase","function"),e.xp6(1),e.Q6J("ngSwitchCase","table"),e.xp6(1),e.Q6J("ngSwitchCase","view"),e.xp6(1),e.Q6J("ngSwitchCase","json"),e.xp6(1),e.Q6J("ngSwitchCase","query"),e.xp6(1),e.Q6J("ngSwitchCase","dcml"))},dependencies:[l.RF,l.n9,oo,so,ao.k,ro.A,fo,bo,So,xo]}),i})();function No(o,i){if(1&o){const s=e.EpF();e.TgZ(0,"a",7),e.NdJ("click",function(){const a=e.CHM(s).$implicit,r=e.oxw(2);return e.KtG(r.onAddNewTab(a.type))}),e._UZ(1,"i",8),e._uU(2),e.qZA()}if(2&o){const s=i.$implicit;e.xp6(2),e.hij("",s.title," ")}}function Zo(o,i){if(1&o){const s=e.EpF();e.TgZ(0,"a",7),e.NdJ("click",function(){const a=e.CHM(s).$implicit,r=e.oxw(2);return e.KtG(r.onTabItem(a))}),e._UZ(1,"i",9),e._uU(2),e.qZA()}if(2&o){const s=i.$implicit;e.xp6(2),e.hij("",s.label," ")}}function Ro(o,i){if(1&o&&(e.TgZ(0,"div",5),e.YNc(1,No,3,1,"a",6),e.YNc(2,Zo,3,1,"a",6),e.qZA()),2&o){const s=e.oxw();e.xp6(1),e.Q6J("ngForOf",s.createFileMenuItems),e.xp6(1),e.Q6J("ngForOf",s.tabsMenuItems)}}let qo=(()=>{var o;class i{constructor(t,n,a){this.tabsService=t,this.dataStudioService=n,this.authService=a,this.FileMenuItems=[{type:"jspy",title:"Jspy Script",allowAnonymous:!0},{type:"dcml",title:"DCML File",allowAnonymous:!0},{type:"json",title:"Json File",allowAnonymous:!0},{type:"query",title:"Data Query"},{type:"sql",title:"Sql Query"}],this.createFileMenuItems=[],this.tabsMenuItems=[{label:"Close All Tabs",click:()=>this.tabsService.removeAllTabs()},{label:"Close Other Tabs",click:()=>this.tabsService.removeUnActiveTabs()}],this.authService.isAuthenticated$.subscribe(r=>this.createFileMenuItems=this.FileMenuItems.filter(c=>r||c.allowAnonymous))}newFileContent(t){return"jspy"===t?le.EY:"dcml"===t?le.Ay:"\n"}onAddNewTab(t){this.tabsService.addNewAppTab(this.dataStudioService.currentApp,t,"",this.newFileContent(t))}onTabItem(t){t.click()}}return(o=i).\u0275fac=function(t){return new(t||o)(e.Y36(oe.x),e.Y36(ee.F),e.Y36(B.$h))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-tab-creation"]],decls:5,vars:0,consts:[["dropdown","","container","body","placement","top left",1,"d-flex","position-absolute","px-0"],["dropdownToggle","","type","button",1,"px-1","btn","btn-light","py-0"],[1,"fa","fa-plus"],[1,"fa","fa-caret-down"],["id","add-dropdown","class","dropdown-menu dropdown-menu-right","aria-labelledby","add-btn-dropdown",4,"dropdownMenu"],["id","add-dropdown","aria-labelledby","add-btn-dropdown",1,"dropdown-menu","dropdown-menu-right"],["class","dropdown-item",3,"click",4,"ngFor","ngForOf"],[1,"dropdown-item",3,"click"],[1,"bi","bi-plus","mr-1"],[1,"bi","bi-x","mr-1"]],template:function(t,n){1&t&&(e.TgZ(0,"span",0)(1,"button",1),e._UZ(2,"i",2)(3,"i",3),e.qZA(),e.YNc(4,Ro,3,2,"div",4),e.qZA())},dependencies:[G.Hz,G.Mq,G.TO,l.sg],encapsulation:2}),i})();function Jo(o,i){if(1&o){const s=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){e.CHM(s);const n=e.oxw();return e.KtG(n.onReloadContent())}),e._UZ(1,"i",20),e.qZA()}}function Lo(o,i){if(1&o){const s=e.EpF();e.TgZ(0,"button",21),e.NdJ("click",function(){e.CHM(s);const n=e.oxw();return e.KtG(n.onSave())}),e._uU(1,"Save"),e.qZA()}}function jo(o,i){if(1&o){const s=e.EpF();e.TgZ(0,"button",22),e.NdJ("click",function(){e.CHM(s);const n=e.oxw();return e.KtG(n.onShare())}),e._UZ(1,"i",23),e.qZA()}}function Ho(o,i){1&o&&(e.TgZ(0,"button",24),e._UZ(1,"i",25),e.qZA())}function Qo(o,i){1&o&&(e.TgZ(0,"button",26),e._UZ(1,"i",25),e.qZA())}function Bo(o,i){if(1&o){const s=e.EpF();e.TgZ(0,"li",31)(1,"a",32),e.NdJ("click",function(){e.CHM(s);const n=e.oxw().$implicit;return e.KtG(n.click(n))}),e._UZ(2,"i"),e._uU(3),e.qZA()()}if(2&o){const s=e.oxw().$implicit;e.xp6(2),e.Gre("fa ",s.icon||"fa-circle-thin"," mr-2"),e.xp6(1),e.Oqu(s.label)}}function Yo(o,i){1&o&&e._UZ(0,"li",33)}function zo(o,i){if(1&o&&(e.ynx(0),e.YNc(1,Bo,4,4,"li",29),e.YNc(2,Yo,1,0,"li",30),e.BQk()),2&o){const s=i.$implicit;e.xp6(1),e.Q6J("ngIf",!s.isDivider),e.xp6(1),e.Q6J("ngIf",s.isDivider)}}function $o(o,i){if(1&o&&(e.TgZ(0,"ul",27),e.YNc(1,zo,3,2,"ng-container",28),e.Hsn(2),e.qZA()),2&o){const s=e.oxw();e.xp6(1),e.Q6J("ngForOf",null==s.currentTab||null==s.currentTab.content?null:s.currentTab.content.menuItems)}}const Uo=["*"];let Go=(()=>{var o;class i{constructor(t,n,a,r,c,d,h){this.tabsService=t,this.resizeSvc=n,this.authService=a,this.sqlMetaDataService=r,this.dialogService=c,this.dataStudioService=d,this.document=h,this.menuDisabled=!1,this.layoutConfig={icon:"worksheets_logo",smIcon:"worksheets_logo",toggle:!0},this.collapsed=!1,this.destroy$=new N.x,(0,be.MJ)(fe,"python",new ti(()=>this.getDataContext(),()=>this.currentTab?.content?.currentFileLinks?.filter(m=>"jspy"===m.contentType||"json"===m.contentType)?.map(m=>`/${(0,O.nV)(m)}`)||[])),(0,be.MJ)(fe,"sql",new si(()=>this.currentTab?.content?.connectionName||this.currentTab?.content?.connection?.connectionName||"",m=>r.getObjects(m).then(f=>f.filter(C=>C.objectType!==te.HA.Procedure).map(C=>`${C.schemaName}.${C.objectName}`)),(m,f)=>r.getDbTableFields(m,f).then(C=>C.map(M=>M.fieldName))))}ngOnInit(){this.resizeSvc.onResize$.subscribe(t=>{this.size=t,this.collapsed=this.size<=O.yJ.MD}),this.tabsService.activeTab$.pipe((0,y.R)(this.destroy$)).subscribe(t=>this.currentTab=t),this.authService.isAuthenticated$.pipe((0,y.R)(this.destroy$),(0,F.h)(t=>t)).subscribe(()=>this.tabsService.initStateFromLocalStorage())}onToggleSidebar(){this.collapsed=!this.collapsed}onResized(){this.document.defaultView?.dispatchEvent(new Event("resize"))}onSave(){var t=this;return(0,_.Z)(function*(){"function"==typeof t.tabsService.activeTab?.content?.save&&(yield t.tabsService.activeTab.content.save())})()}onShare(){var t=this;return(0,_.Z)(function*(){const n=t.dataStudioService.currentApp;yield t.dialogService.open(ui,{class:"modal-lg",initialState:{config:{app:{...n},tab:t.tabsService.activeTab}}}).onCloseAsync()})()}onReloadContent(){this.tabsService.activeTab.content?.reload()}ngOnDestroy(){this.destroy$.next(null),this.destroy$.complete()}getDataContext(){const t="jspy"===this.currentTab?.tabType?this.currentTab?.content:null;return{...t?.interpreter?.lastExecutionContext||t?.interpreter?.initialExecutionContext}}}return(o=i).\u0275fac=function(t){return new(t||o)(e.Y36(oe.x),e.Y36(di._),e.Y36(B.$h),e.Y36(B.hp),e.Y36(ne.x),e.Y36(ee.F),e.Y36(l.K0))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-data-studio-layout"]],ngContentSelectors:Uo,decls:23,vars:10,consts:[[3,"config","toggleSidebar"],["title","",1,"mb-0","ml-0","top-sub-header","w-md-down-50","d-none","d-md-block"],[1,"text-primary"],["header","",1,"d-flex","flex-fill","align-items-center","ml-2"],[1,"tabs-title"],[1,"ml-auto"],["class","btn btn-sm px-1 ml-2","title","Reload content",3,"click",4,"ngIf"],["type","button","class","btn btn-primary btn-sm align-self-center ml-2 px-3",3,"click",4,"ngIf"],["type","button","class","btn btn-sm align-self-center ml-2",3,"click",4,"ngIf"],["settings","",1,"d-flex"],["dropdown","","placement","top left",1,"d-flex","position-relative","px-2"],["type","button","class","px-0 btn btn-primary-outline py-0 disabled",4,"ngIf"],["dropdownToggle","","type","button","class","px-0 btn btn-primary-outline py-0",4,"ngIf"],["class","dropdown-menu left-menu","role","menu",4,"dropdownMenu"],["content","","unit","pixel","direction","horizontal",3,"useTransition","gutterSize","transitionEnd","dragEnd"],[3,"size"],["sidebar",""],[1,"position-relative"],[1,"position-absolute"],["title","Reload content",1,"btn","btn-sm","px-1","ml-2",3,"click"],[1,"fa","fa-refresh","my-0"],["type","button",1,"btn","btn-primary","btn-sm","align-self-center","ml-2","px-3",3,"click"],["type","button",1,"btn","btn-sm","align-self-center","ml-2",3,"click"],[1,"fa","fa-share-alt","my-0"],["type","button",1,"px-0","btn","btn-primary-outline","py-0","disabled"],[1,"fa","fa-ellipsis-v"],["dropdownToggle","","type","button",1,"px-0","btn","btn-primary-outline","py-0"],["role","menu",1,"dropdown-menu","left-menu"],[4,"ngFor","ngForOf"],["role","menuitem",4,"ngIf"],["class","divider dropdown-divider",4,"ngIf"],["role","menuitem"],[1,"dropdown-item","cursor-pointer",3,"click"],[1,"divider","dropdown-divider"]],template:function(t,n){1&t&&(e.F$t(),e.TgZ(0,"app-layout",0),e.NdJ("toggleSidebar",function(){return n.onToggleSidebar()}),e.TgZ(1,"h2",1),e._uU(2,"WORKSHEETS "),e.TgZ(3,"span",2),e._uU(4,"DATA STUDIO"),e.qZA()(),e.TgZ(5,"div",3)(6,"span",4),e._uU(7),e.qZA(),e._UZ(8,"app-tab-actions",5),e.YNc(9,Jo,2,0,"button",6),e.YNc(10,Lo,2,0,"button",7),e.YNc(11,jo,2,0,"button",8),e.qZA(),e.TgZ(12,"div",9)(13,"span",10),e.YNc(14,Ho,2,0,"button",11),e.YNc(15,Qo,2,0,"button",12),e.YNc(16,$o,3,1,"ul",13),e.qZA()(),e.TgZ(17,"as-split",14),e.NdJ("transitionEnd",function(){return n.onResized()})("dragEnd",function(){return n.onResized()}),e.TgZ(18,"as-split-area",15),e._UZ(19,"app-data-studio-sidebar",16),e.qZA(),e.TgZ(20,"as-split-area",17),e._UZ(21,"app-tab-creation",18)(22,"router-outlet"),e.qZA()()()),2&t&&(e.Q6J("config",n.layoutConfig),e.xp6(7),e.Oqu(null==n.currentTab?null:n.currentTab.tabHeader),e.xp6(2),e.Q6J("ngIf",null==n.currentTab||null==n.currentTab.content?null:n.currentTab.content.canReload),e.xp6(1),e.Q6J("ngIf",null==n.currentTab||null==n.currentTab.content?null:n.currentTab.content.canSave),e.xp6(1),e.Q6J("ngIf",null==n.currentTab||null==n.currentTab.content?null:n.currentTab.content.canShare),e.xp6(3),e.Q6J("ngIf",n.menuDisabled),e.xp6(1),e.Q6J("ngIf",!n.menuDisabled),e.xp6(2),e.Q6J("useTransition",!0)("gutterSize",n.collapsed?0:11),e.xp6(1),e.Q6J("size",n.collapsed?0:300))},dependencies:[we.Mq,we.zE,G.Hz,G.Mq,G.TO,l.sg,l.O5,pi.$,K.lC,no,Fo,qo],styles:['.section[_ngcontent-%COMP%]{background:var(--bg)}tabset[_ngcontent-%COMP%]     .bs-remove-tab{visibility:hidden;position:relative}tabset[_ngcontent-%COMP%]     .bs-remove-tab:after{content:"\\f00d";font-family:FontAwesome;color:inherit;position:absolute;visibility:visible;right:0}tabset[_ngcontent-%COMP%]     .tab-content{position:relative}.fa.fa-refresh[_ngcontent-%COMP%], .fa.fa-share-alt[_ngcontent-%COMP%], .fa.fa-ellipsis-v[_ngcontent-%COMP%]{color:var(--color)}.tabs-title[_ngcontent-%COMP%]{font-family:Calibri;font-size:19px;font-weight:550}app-tab-creation[_ngcontent-%COMP%]{right:0;display:block;width:40px;z-index:2}']}),i})();var rn=p(13389),et=p(46183),He=p(13231),pe=p(30968),Vo=p(43093),Ze=p(99796);class _t{constructor(i,s){this.tabItem=i,this.userId=s,this.userId||console.error("TabContentStore instantiated before user is authentificated!")}get tabContentStoreKey(){return`store-${this.tabItem?.tabId}-${this.userId}`}getChanges(){const i=localStorage.getItem(this.tabContentStoreKey);if(!i)return null;try{const s=JSON.parse(i);if("object"!=typeof s||!s)throw new Error("Stored content in wrong format was removed");return s}catch(s){return this.removeChanges(),console.error(s),null}}hasChanges(){return localStorage.hasOwnProperty(this.tabContentStoreKey)}saveChanges(i){localStorage.setItem(this.tabContentStoreKey,JSON.stringify(i))}removeChanges(){localStorage.removeItem(this.tabContentStoreKey)}}const Ko=["editorEl"];let Re=(()=>{var o;class i{constructor(t,n,a,r,c,d,h,m){this.dataService=t,this.tabsService=n,this.dialogService=a,this.notificationService=r,this.dataStudioService=c,this.router=d,this.authService=h,this.commandsService=m,this.destroy$=new N.x,this.isActivated=!1,this._text="loading ...",this.contentChangeSubj$=new N.x,this.initialText$=new ht.X(null),this.tabItem={},this.appName="",this.appOwner="",this.appContent=null,this.loading=!1,this.menuItems=[],this.canSave=!1,this.selectedText="",this.menuItems.push(m.closeAllMenuItem()),this.menuItems.push(m.closeOthersMenuItem()),this.menuItems.push({isDivider:!0})}get text(){return this._text}set text(t){this._text!==t&&(this._text=t,this.contentChangeSubj$.next())}get content(){return this.text}get initialText(){return this.initialText$.getValue()}get canReload(){return!0}ngOnInit(){var t=this;return(0,_.Z)(function*(){if(!t.tabItem?.tabId)throw new Error("TabItem is not initialized");t.contentChangeSubj$.pipe((0,y.R)(t.destroy$),(0,pt.b)(()=>{t.canSave=!t.initialText||t.initialText!==t.content}),(0,Me.b)(2e3)).subscribe(()=>t.storeContentChanges()),t.tabItem.content=t,t.authService.user?.userId&&(t.tabContentStore=new _t(t.tabItem,t.authService.user.userId),t.canSave=t.tabContentStore.hasChanges())})()}initTab(){var t=this;return(0,_.Z)(function*(){yield t.initTabContent(),t.editorEl&&t.initializeEditor(t.editorEl.nativeElement),t.text&&!t.canReload&&t.storeContentChanges()})()}initializeEditor(t){this.editor=fe.editor.create(t,{tabSize:2,scrollBeyondLastLine:!1,value:this.text,...this.editorOptions}),this.editor.onDidChangeCursorSelection(n=>{const a=this.editor?.getSelection();if(!this.editor||!a)return void(this.selectedText="");const r=this.editor.getModel()?.getValueInRange(a);this.selectedText=r&&r!==this.selectedText?r:""}),this.editor.onDidChangeModelContent(()=>{this.text=this.editor?.getValue()||""}),this.initialText$.pipe((0,y.R)(this.destroy$),(0,Vo.Q)(ve.z),(0,F.h)(n=>null!==n)).subscribe(()=>this.editor?.setValue(this.text??""))}storeContentChanges(){if(this.canSave&&this.appContent){const t={content:this.content,contentKey:(0,Ze.nV)(this.appContent)};this.tabContentStore?.saveChanges(t)}else this.tabContentStore?.removeChanges()}deleteLocalChanges(){this.tabContentStore?.removeChanges()}ngOnDestroy(){this.destroy$.next(null),this.destroy$.complete()}resize(){this.editor?.layout()}save(){var t=this;return(0,_.Z)(function*(){const{owner:n,name:a,file:r}=t.tabItem.tabParams;try{if((0,be.$P)(r)){const c={...(0,Ze.x2)(r),appOwner:t.dataStudioService.currentApp?.appOwner,appName:t.dataStudioService.currentApp?.appName};c.name=c?.name?.replace("(new)-","");const d=yield t.dialogService.open(ft,{initialState:{config:{link:c,folders:[]}}}).onCloseAsync();if(d){const h={appName:d.appName,ownerName:d.appOwner,fileName:(0,Ze.nV)(d),content:t.content},m=h.fileName;yield t.dataService.saveAppContent(h),t.dataStudioService.appContentAdded(h.ownerName,h.appName,h.fileName),t.tabsService.removeTab(t.tabItem),t.notificationService.success(`File '${m}' created`),t.router.navigate(["data-studio/app",h.ownerName,h.appName],{queryParams:{file:m}})}}else{const c={appName:a,ownerName:n,content:t.content,fileName:(0,Ze.nV)(t.appContent)};yield t.dataService.saveAppContent(c),t.notificationService.success("File saved"),t.canSave=!1}t.tabContentStore?.removeChanges()}catch(c){t.notificationService.error(c)}})()}reload(){var t=this;return(0,_.Z)(function*(){const{owner:n,name:a,file:r}=t.tabItem.tabParams;t.appContent=yield t.dataService.loadAppFileContent(n,a,(0,Ze.x2)(r),!0),t.tabContentStore?.removeChanges();const c=t.appContent?.content||"";t.initialText$.next(c),t.text=c})()}onReload(t){return Promise.resolve()}activated(){var t=this;return(0,_.Z)(function*(){ve.z.schedule(()=>t.resize()),t.isActivated||(t.isActivated=!0,yield t.initTab())})()}initTabContent(){var t=this;return(0,_.Z)(function*(){t.loading=!0;const{owner:n,name:a,file:r}=t.tabItem.tabParams;t.appName=a,t.appOwner=n;try{const c=t.tabContentStore?.getChanges();(0,be.$P)(r)?(t.text=c?.content??(t.tabsService.popContentParameter(r)||"\n"),ve.z.schedule(()=>t.resize())):c?(t.appContent=(0,Ze.x2)(t.tabItem.tabParams.file),t.text=c.content):yield t.reload(),yield t.onReload(t.appContent)}catch(c){t.notificationService.error(c)}finally{t.loading=!1}})()}}return(o=i).\u0275fac=function(t){return new(t||o)(e.Y36(mt.U),e.Y36(oe.x),e.Y36(ne.x),e.Y36(ie.g),e.Y36(ee.F),e.Y36(K.F0),e.Y36(B.$h),e.Y36(ye.q))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-tab-app-content"]],viewQuery:function(t,n){if(1&t&&e.Gf(Ko,5),2&t){let a;e.iGM(a=e.CRH())&&(n.editorEl=a.first)}},inputs:{tabItem:"tabItem"},decls:0,vars:0,template:function(t,n){},encapsulation:2}),i})();var Xo=p(63411);function Wo(o,i){if(1&o){const s=e.EpF();e.TgZ(0,"app-data-query",2,3),e.NdJ("gridDataModified",function(n){e.CHM(s);const a=e.oxw();return e.KtG(a.onGridDataModified(n))})("queryInfoChange",function(n){e.CHM(s);const a=e.oxw();return e.KtG(a.onQueryInfoChange(n))}),e.qZA()}if(2&o){const s=e.oxw();e.Q6J("hidden",!!s.loading)("queryInfo",s.queryInfo)}}function es(o,i){1&o&&(e.TgZ(0,"div",4)(1,"div",5)(2,"span",6),e._uU(3,"Loading..."),e.qZA()()())}let ts=(()=>{var o;class i extends Re{constructor(t,n,a,r,c,d,h,m){super(n,a,r,c,d,h,m,t),this.loading=!1,this.gridContext={},this.queryInfo={},this.canShare=!0,this.menuItems.push(t.exportToCsvMenuItem(()=>this.dataQuery?.dataGrid?.grid?.rowData,()=>this.tabItem.tabHeader)),this.menuItems.push(t.exportToExcelMenuItem(()=>this.dataQuery?.dataGrid?.grid,()=>this.tabItem.tabHeader)),this.menuItems.push(t.saveToDatabaseMenuItem(()=>this.dataQuery?.dataGrid?.grid?.rowData||[])),this.menuItems.push({isDivider:!0}),this.menuItems.push({label:"Clone as Data Query",icon:"fa-clone",click:()=>t.addDataQueryTabFromQuery(this.queryInfo)}),this.menuItems.push({isDivider:!0}),this.menuItems.push({label:"Generate JSPY (Sql Data Api)",click:()=>t.addSelectWithSqlDataApiJspyTab(this.queryInfo?.sqlQuery)}),this.menuItems.push({label:"Generate SQL",click:()=>t.addSelectSqlTab(this.queryInfo?.sqlQuery)}),(0,pe.setBearerToken)(m.token),(0,pe.setBaseUrl)(Ie.Z.worksheetsApi)}ngOnInit(){var t=()=>super.ngOnInit,n=this;return(0,_.Z)(function*(){yield t().call(n)})()}reload(){var t=()=>super.reload,n=this;return(0,_.Z)(function*(){n.queryInfo={},yield t().call(n),n.onReload()})()}onReload(){var t=this;return(0,_.Z)(function*(){t.text?.trim()?t.queryInfo=JSON.parse(t.text):(t.queryInfo=yield t.createDataQuery(),t.queryInfo?.sqlQuery&&(t.text=JSON.stringify(t.queryInfo)))})()}createDataQuery(){var t=this;return(0,_.Z)(function*(){return{sqlQuery:yield t.dialogService.open(Xo._,{class:"modal-xl full-height",keyboard:!1,initialState:{config:t.queryInfo?.sqlQuery,configQueryInfo:t.queryInfo}}).onCloseAsync(),dataGrid:(0,He.o8)(),viewType:He.bW.DataGrid}})()}save(){var t=()=>super.save,n=this;return(0,_.Z)(function*(){n.text=JSON.stringify(n.queryInfo),yield t().call(n);const{connectionName:a,tableName:r}=n.queryInfo.sqlQuery;if(!a||!r)throw new Error("connectionName || !tableName is not defined");(n.gridContext?.state?.added||n.gridContext?.state?.deleted||n.gridContext?.state?.edited)&&(yield n.commandsService.saveGridData(a,r,n.gridContext))})()}get dataSource(){return this.dataQuery?.dataSource}onFiltersBarChanged(t){if(!this.dataQuery)throw new Error("dataQuery is not initialized");this.dataQuery.onFiltersBarChanged(t)}openQueryManager(){var t=this;return(0,_.Z)(function*(){if(!t.dataQuery)throw new Error("dataQuery is not initialized");yield t.dataQuery.openQueryManager()})()}onQueryInfoChange(t){this.text=JSON.stringify(t)}onGridDataModified(t){this.gridContext=t,this.canSave=!0}}return(o=i).\u0275fac=function(t){return new(t||o)(e.Y36(ye.q),e.Y36(mt.U),e.Y36(oe.x),e.Y36(ne.x),e.Y36(ie.g),e.Y36(ee.F),e.Y36(K.F0),e.Y36(B.$h))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-tab-data-query"]],viewQuery:function(t,n){if(1&t&&e.Gf(et.n,5),2&t){let a;e.iGM(a=e.CRH())&&(n.dataQuery=a.first)}},features:[e.qOj],decls:2,vars:2,consts:[["class","h-100",3,"hidden","queryInfo","gridDataModified","queryInfoChange",4,"ngIf"],["class","d-flex justify-content-center position-absolute align-items-center w-100 h-100 spinner flex-column",4,"ngIf"],[1,"h-100",3,"hidden","queryInfo","gridDataModified","queryInfoChange"],["dataQuery",""],[1,"d-flex","justify-content-center","position-absolute","align-items-center","w-100","h-100","spinner","flex-column"],["role","status",1,"spinner-border"],[1,"sr-only"]],template:function(t,n){1&t&&(e.YNc(0,Wo,2,2,"app-data-query",0),e.YNc(1,es,4,0,"div",1)),2&t&&(e.Q6J("ngIf",null==n.queryInfo?null:n.queryInfo.sqlQuery),e.xp6(1),e.Q6J("ngIf",n.loading))},dependencies:[l.O5,et.n],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}app-export-menu[_ngcontent-%COMP%]{margin-bottom:-.5rem}"]}),i})();function ns(o,i){1&o&&(e.TgZ(0,"div",4)(1,"div",5)(2,"span",6),e._uU(3,"Loading..."),e.qZA()()())}let is=(()=>{var o;class i extends Re{constructor(){super(...arguments),this.editorOptions={language:"html"}}handleKeyboardEvent(t){this.tabsService.activeTab===this.tabItem&&t.ctrlKey&&("s"===t.key||"S"===t.key)&&(t.preventDefault(),t.stopImmediatePropagation(),this.save())}}return(o=i).\u0275fac=function(){let s;return function(n){return(s||(s=e.n5z(o)))(n||o)}}(),o.\u0275cmp=e.Xpm({type:o,selectors:[["app-tab-dcml"]],hostBindings:function(t,n){1&t&&e.NdJ("keydown",function(r){return n.handleKeyboardEvent(r)},!1,e.evT)},features:[e.qOj],decls:4,vars:1,consts:[[1,"h-100","position-relative"],[1,"h-100","w-100"],["editorEl",""],["class","d-flex justify-content-center position-absolute align-items-center w-100 h-100 spinner flex-column",4,"ngIf"],[1,"d-flex","justify-content-center","position-absolute","align-items-center","w-100","h-100","spinner","flex-column"],["role","status",1,"spinner-border"],[1,"sr-only"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"div",1,2),e.YNc(3,ns,4,0,"div",3),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngIf",n.loading))},dependencies:[l.O5]}),i})();function os(o,i){1&o&&(e.TgZ(0,"div",4)(1,"div",5)(2,"span",6),e._uU(3,"Loading..."),e.qZA()()())}let ss=(()=>{var o;class i extends Re{constructor(){super(...arguments),this.editorOptions={language:"javascript"}}handleKeyboardEvent(t){this.tabsService.activeTab===this.tabItem&&t.ctrlKey&&("s"===t.key||"S"===t.key)&&(t.preventDefault(),t.stopImmediatePropagation(),this.save())}}return(o=i).\u0275fac=function(){let s;return function(n){return(s||(s=e.n5z(o)))(n||o)}}(),o.\u0275cmp=e.Xpm({type:o,selectors:[["app-tab-js"]],hostBindings:function(t,n){1&t&&e.NdJ("keydown",function(r){return n.handleKeyboardEvent(r)},!1,e.evT)},features:[e.qOj],decls:4,vars:1,consts:[[1,"h-100","position-relative"],[1,"h-100","w-100"],["editorEl",""],["class","d-flex justify-content-center position-absolute align-items-center w-100 h-100 spinner flex-column",4,"ngIf"],[1,"d-flex","justify-content-center","position-absolute","align-items-center","w-100","h-100","spinner","flex-column"],["role","status",1,"spinner-border"],[1,"sr-only"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"div",1,2),e.YNc(3,os,4,0,"div",3),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngIf",n.loading))},dependencies:[l.O5]}),i})();var ln=p(76662);function as(o,i){1&o&&(e.TgZ(0,"div",4)(1,"div",5)(2,"span",6),e._uU(3,"Loading..."),e.qZA()()())}let rs=(()=>{var o;class i extends Re{ngOnInit(){var t=()=>super.ngOnInit,n=this;return(0,_.Z)(function*(){yield t().call(n),n.initialText$.pipe((0,y.R)(n.destroy$),(0,F.h)(a=>null!==a)).subscribe(a=>n.contentExplorer?.reload(a))})()}initTab(){var t=()=>super.initTab,n=this;return(0,_.Z)(function*(){yield t().call(n),n.contentExplorer?.reload(n.text)})()}setJsonText(t){this.contentExplorer?.reload(t)}onTextChanged(t){this.text=t,this.contentChangeSubj$.next()}handleKeyboardEvent(t){this.tabsService.activeTab===this.tabItem&&t.ctrlKey&&("s"===t.key||"S"===t.key)&&(t.preventDefault(),t.stopImmediatePropagation(),this.save())}resize(){this.contentExplorer?.resize()}save(){var t=()=>super.save,n=this;return(0,_.Z)(function*(){n.text=n.contentExplorer?.contentEditor?.getValue()||"",yield t().call(n)})()}}return(o=i).\u0275fac=function(){let s;return function(n){return(s||(s=e.n5z(o)))(n||o)}}(),o.\u0275cmp=e.Xpm({type:o,selectors:[["app-tab-json"]],viewQuery:function(t,n){if(1&t&&e.Gf(ln.S,5),2&t){let a;e.iGM(a=e.CRH())&&(n.contentExplorer=a.first)}},hostBindings:function(t,n){1&t&&e.NdJ("keydown",function(r){return n.handleKeyboardEvent(r)},!1,e.evT)},features:[e.qOj],decls:4,vars:2,consts:[[1,"h-100","position-relative"],[1,"h-100","w-100",3,"formatter","textChanged"],["contentExplorer",""],["class","d-flex justify-content-center position-absolute align-items-center w-100 h-100 spinner flex-column",4,"ngIf"],[1,"d-flex","justify-content-center","position-absolute","align-items-center","w-100","h-100","spinner","flex-column"],["role","status",1,"spinner-border"],[1,"sr-only"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"app-content-explorer",1,2),e.NdJ("textChanged",function(r){return n.onTextChanged(r)}),e.qZA(),e.YNc(3,as,4,0,"div",3),e.qZA()),2&t&&(e.xp6(1),e.Q6J("formatter",!0),e.xp6(2),e.Q6J("ngIf",n.loading))},dependencies:[l.O5,ln.S]}),i})();var cn=p(50834),ls=p(25482);function cs(o,i){1&o&&(e.TgZ(0,"div",4)(1,"div",5)(2,"span",6),e._uU(3,"Loading..."),e.qZA()()())}let us=(()=>{var o;class i extends Re{constructor(){super(...arguments),this.currentFileLinks=[],this.canShare=!0}ngOnInit(){var t=()=>super.ngOnInit,n=this;return(0,_.Z)(function*(){var a;yield t().call(n),n.menuItems.push({label:"Toggle Direction",click:()=>n.contentEditor?.toggleDirection()}),n.contentEditor?.setSettings({entryModule:n.tabItem?.tabParams?.file,moduleLoader:function(c){return(a=a||(0,_.Z)(function*(d){return yield n.jspyModuleLoader(d)})).apply(this,arguments)},settingsKey:`jspy-editor-${n.appOwner}-${n.appName}-${n.appContent?.name}`}),n.initialText$.pipe((0,y.R)(n.destroy$),(0,F.h)(r=>null!==r)).subscribe(r=>n.contentEditor?.reload(r))})()}get interpreter(){return this.contentEditor?.interpreter}initTab(){var t=()=>super.initTab,n=this;return(0,_.Z)(function*(){yield t().call(n),n.appOwner&&n.appName&&(n.linksSubscription=n.dataService.getAppFileLinks$(n.appOwner,n.appName).subscribe(a=>n.currentFileLinks=a)),n.contentEditor?.reload(n.text)})()}ngOnDestroy(){var t=()=>super.ngOnDestroy,n=this;return(0,_.Z)(function*(){n.linksSubscription&&n.linksSubscription.unsubscribe(),yield t().call(n)})()}handleKeyboardEvent(t){this.tabsService.activeTab===this.tabItem&&t.ctrlKey&&("s"===t.key||"S"===t.key)&&(t.preventDefault(),t.stopImmediatePropagation(),this.save())}scheduleRun(t){var n=this;return(0,_.Z)(function*(){yield n.dialogService.open(ls.s,{class:"modal-w-45",initialState:{config:{taskId:0,name:n.appContent?.name??"Content",appName:`${n.appOwner}/${n.appName}`,jspyFilePath:`${n.appContent?.name}.${n.appContent?.contentType}`,functionName:t,scheduleTime:"10:00",scheduleDays:"*",isEnabled:!0,notifyOn:0}}}).onCloseAsync()})()}resize(){super.resize(),ve.z.schedule(()=>{this.contentEditor?.resize()})}onTextChanged(t){this.text=t,this.contentChangeSubj$.next()}jspyModuleLoader(t){var n=this;return(0,_.Z)(function*(){return t.startsWith("./")&&(t=t.substring(2)),t.startsWith("/")&&(t=t.substring(1)),(yield n.dataService.loadAppFileContent(n.appOwner,n.appName,(0,O.x2)(t))).content||""})()}}return(o=i).\u0275fac=function(){let s;return function(n){return(s||(s=e.n5z(o)))(n||o)}}(),o.\u0275cmp=e.Xpm({type:o,selectors:[["app-tab-jspy"]],viewQuery:function(t,n){if(1&t&&e.Gf(cn.N,7),2&t){let a;e.iGM(a=e.CRH())&&(n.contentEditor=a.first)}},hostBindings:function(t,n){1&t&&e.NdJ("keydown",function(r){return n.handleKeyboardEvent(r)},!1,e.evT)},features:[e.qOj],decls:4,vars:1,consts:[[1,"d-flex","h-100","flex-column"],[1,"h-100","w-100",3,"textChanged"],["contentEditor",""],["class","d-flex justify-content-center position-absolute align-items-center w-100 h-100 spinner flex-column",4,"ngIf"],[1,"d-flex","justify-content-center","position-absolute","align-items-center","w-100","h-100","spinner","flex-column"],["role","status",1,"spinner-border"],[1,"sr-only"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"app-jspy-content-editor",1,2),e.NdJ("textChanged",function(r){return n.onTextChanged(r)}),e.qZA(),e.YNc(3,cs,4,0,"div",3),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngIf",n.loading))},dependencies:[l.O5,cn.N],styles:[".help-toggle[_ngcontent-%COMP%]{top:5px;right:13px;z-index:1}"]}),i})();var ds=p(41614),qe=p(53473),ps=p(38325),tt=p(3202),hs=p(30160);class bt extends hs.T{constructor(){super()}getData(i,s){var t=this;return(0,_.Z)(function*(){const n=i;try{const a=yield(0,pe.sqlDataApi)(n.connectionName).setAbortController(s).sqlExecuteRaw(n.sql,n.sqlParams,n.sqlParamDirections);if(!a?.table)throw new Error("Table is not arrived from sqlExecuteRaw");return{message:t.getMessage(a),items:(0,tt.fromTable)(a.table),outputParameters:a.outputParameters,fields:a.table.fieldNames.map((r,c)=>({name:r,dataType:a.table?.fieldDataTypes?a.table.fieldDataTypes[c]:ps.DataTypeName.String}))}}catch(a){return{errorMessage:(0,O.e$)(a)}}})()}getMessage(i){return i.table?.rows?.length||i.message?i.message:"Sql Command Completed Successfully"}}var fs=p(18937);let ms=(()=>{var o;class i extends Re{get text(){return super.text}set text(t){const n=this.getConnection(t);let a=!1;n&&(a=this.connectionName!==n,this.connectionName=n,t=this.getSqlCode(t)),a&&t===this.text&&this.contentChangeSubj$.next(),super.text=t}get content(){return`-- Connection: ${this.connectionName}\n${super.text}`}get selectConnection(){return this.connections?.map(t=>t.connectionName).includes(this.connectionName)?this.connectionName:"Select connection"}reloadCancelled(){this.abortController?.abort()}handleKeyboardEvent(t){this.tabsService.activeTab===this.tabItem&&("F5"===t.key||t.ctrlKey&&"Enter"===t.key)&&(t.preventDefault(),t.stopImmediatePropagation(),this.onRunClick())}constructor(t,n,a,r,c,d,h,m,f){super(t,n,r,c,d,h,f,a),this.connectionsService=m,this.connections=[],this.connectionName="",this.direction=Ne.Ar.horizontal,this.sqlDataSource=new bt,this.isReadOnly=!1,this.evaluationTime=0,this.evaluating=!1,this.editorOptions={language:"sql",readOnly:this.isReadOnly},(0,pe.setBearerToken)(f.token),(0,pe.setBaseUrl)(Ie.Z.worksheetsApi),this.menuItems.push(a.exportToCsvMenuItem(()=>this.dataGrid?.grid?.rowData||[],()=>this.tabItem?.tabHeader)),this.menuItems.push(a.exportToExcelMenuItem(()=>this.dataGrid?.grid,()=>this.tabItem.tabHeader)),this.menuItems.push(a.saveToDatabaseMenuItem(()=>this.dataGrid?.grid?.rowData||[]))}onRunClick(){var t=this;return(0,_.Z)(function*(){const n=t.selectedText||t.editor?.getValue();t.evaluating=!0;const a=(new Date).getTime();t.abortController=new AbortController,n&&(yield t.sqlDataSource.reload({connectionName:t.connectionName,sql:n},t.abortController)),t.evaluationTime=+new Date-a,t.evaluating=!1})()}ngOnInit(){var t=()=>super.ngOnInit,n=this;return(0,_.Z)(function*(){var a;n.connectionsService.dbConnectionsList$.pipe((0,y.R)(n.destroy$),(0,F.h)(r=>!!r.length)).subscribe(function(r){return(a=a||(0,_.Z)(function*(c){n.connections=c,yield t().call(n),n.resize()})).apply(this,arguments)})})()}onSelectConnection(t){this.connectionName=t,this.canSave=!0,this.contentChangeSubj$.next()}toggleDirection(){this.direction=this.direction===Ne.Ar.vertical?Ne.Ar.horizontal:Ne.Ar.vertical,this.resize()}resize(){ds.Z.schedule(()=>{this.editor?.layout()})}getSqlCode(t){return(t=t.trimStart()).substring(t.indexOf("\n")+1)}getConnection(t){if(!t)return"";const a=t.split("\n")[0].match(/--\sConnection:\s(.*)/);return a&&a[1]}}return(o=i).\u0275fac=function(t){return new(t||o)(e.Y36(B.UW),e.Y36(oe.x),e.Y36(ye.q),e.Y36(ne.x),e.Y36(ie.g),e.Y36(ee.F),e.Y36(K.F0),e.Y36(Ae.F),e.Y36(B.$h))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-tab-sql"]],viewQuery:function(t,n){if(1&t&&e.Gf(qe.Z,7),2&t){let a;e.iGM(a=e.CRH())&&(n.dataGrid=a.first)}},hostBindings:function(t,n){1&t&&e.NdJ("keydown",function(r){return n.handleKeyboardEvent(r)},!1,e.evT)},features:[e.qOj],decls:12,vars:2,consts:[[1,"h-100","overflow-hidden",3,"direction","resized"],["left","",1,"w-100","overflow-hidden"],["editorEl",""],["right",""],[3,"dataSource","reloadCancelled"],["dataGrid",""],["left-label",""],[1,"fa","fa-cogs","fa-lg","mr-2"],["right-label",""],[1,"fa","fa-table","fa-lg","mr-2"]],template:function(t,n){1&t&&(e.TgZ(0,"app-split-content",0),e.NdJ("resized",function(){return null==n.editor?null:n.editor.layout()}),e._UZ(1,"div",1,2),e.ynx(3,3),e.TgZ(4,"app-ag-data-grid",4,5),e.NdJ("reloadCancelled",function(){return n.reloadCancelled()}),e.qZA(),e.BQk(),e.ynx(6,6),e._UZ(7,"i",7),e._uU(8," SQL "),e.BQk(),e.ynx(9,8),e._UZ(10,"i",9),e._uU(11," Data "),e.BQk(),e.qZA()),2&t&&(e.Q6J("direction",n.direction),e.xp6(4),e.Q6J("dataSource",n.sqlDataSource))},dependencies:[qe.Z,fs.Y],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}app-export-menu[_ngcontent-%COMP%]{margin-bottom:-.5rem}"]}),i})();var nt=p(37282),un=p(94246);const gs=["sqlEditor"];function _s(o,i){1&o&&(e.TgZ(0,"div",27)(1,"div",28)(2,"span",29),e._uU(3,"Loading..."),e.qZA()()())}let dn=(()=>{var o;class i{constructor(t,n,a,r,c){this.notificationService=t,this.dialogService=n,this.sqlMetaDataService=a,this.route=r,this.router=c,this.functionChanged=new e.vpe,this.isChanged=!1,this.paramRows=[],this.codeContentSize=50,this.parametersSize=30,this.modeState={code:!0,result:!0,parameters:!0},this.loading=!1,this.selectedText="",this.ConnectionLevels=me.EQ,this.defaultColDef={editable:!0,sortable:!1,suppressFiltersToolPanel:!0,suppressMovable:!0,suppressColumnsToolPanel:!0,suppressMenu:!0},this.gridOptions={},this.columnDefs=[{field:"name",width:200},{field:"value",minWidth:50},{field:"dataType",width:80},{field:"direction"},{field:"isNullable"}],this.sqlEditor={},this.destroy$=new N.x,this.editorChange$=new N.x,this.dataSource=new bt,this.dataSource.data$.pipe((0,y.R)(this.destroy$),(0,F.h)(d=>!!d?.outputParameters)).subscribe(d=>{const h=Object.keys(d?.outputParameters);for(const m of h){const f=this.paramRows.find(C=>C.name.toLowerCase()===`@${m.toLowerCase()}`);f&&(f.value=(d?.outputParameters||{})[m])}})}reloadCancelled(){this.abortController?.abort()}onGridReady(t){}ngOnInit(){if(!this.sqlElement)throw new Error("sqlElement is not initialized");if(!this.dataObject)throw new Error("dataObject is not initialized");this.sqlEditor=fe.editor.create(this.sqlElement.nativeElement,{language:"sql",value:this.dataObject.sqlText||"",tabSize:2,scrollBeyondLastLine:!1,readOnly:(this.connection?.codeAccessLevel||0)<me.EQ.SqlExecute}),this.sqlEditor.onDidChangeCursorSelection(a=>{const r=this.sqlEditor?.getModel()?.getValueInRange(this.sqlEditor?.getSelection());r!==this.selectedText&&(this.selectedText=r||"")}),this.sqlEditor.onDidChangeModelContent(()=>{this.editorChange$.next(null)}),this.editorChange$.pipe((0,y.R)(this.destroy$),(0,Me.b)(200)).subscribe(()=>{const a=this.sqlEditor.getValue();this.isChanged=this.dataObject?.sqlText!==a;const r=this.isChanged?{structure:{...this.dataObject,sqlText:a},connection:this.connection}:null;this.functionChanged.emit(r)});const n=this.route.snapshot.queryParams;this.paramRows=(this.dataObject.parameters||[]).map(a=>({name:a.parameterName,direction:a.parameterDirection,value:n.hasOwnProperty(a.parameterName)?n[a.parameterName]:null,isNullable:a.isNullable})),ve.z.schedule(()=>{this.resize()})}ngOnDestroy(){this.destroy$.next(null),this.destroy$.complete()}ngOnChanges({dataObject:t}){t.firstChange||(this.isChanged=!1)}onRun(){var t=this;return(0,_.Z)(function*(){t.loading=!0;const n=t.paramRows.filter(d=>null!=d.value).reduce((d,h)=>(d[h.name.replace("@","")]=(0,tt.parseNumberOrNull)(h.value)||h.value,d),{}),a=t.paramRows.filter(d=>null!=d.value).reduce((d,h)=>(d[h.name.replace("@","")]=h.direction,d),{});let r="";for(var c=0;c<Object.values(n).length;c++)Object.values(n),"number"==typeof Object.values(n)[c]&&(r+=`${Object.values(n)[c]}, `),"string"==typeof Object.values(n)[c]&&(r+=`'${Object.values(n)[c]}', `);try{t.abortController=new AbortController,t.selectedText?yield t.dataSource.reload({connectionName:t.connection?.connectionName||"",sql:t.selectedText},t.abortController):yield t.dataSource.reload({commandType:"Function",connectionName:t.connection?.connectionName,sqlParams:n,sqlParamDirections:a,sql:`select * from ${t.dataObject?.schemaName}.${t.dataObject?.objectName}(${r.slice(0,-2)})`},t.abortController),t.syncQueryParams()}catch(d){t.notificationService.error(d)}finally{t.loading=!1}})()}syncQueryParams(){const t=this.paramRows.filter(n=>null!==n.value).reduce((n,a)=>(n[a.name]=a.value,n),{});this.router.navigate([],{relativeTo:this.route,queryParams:t})}onSave(){var t=this;return(0,_.Z)(function*(){if(!t.dataObject)throw new Error("dataObject is not initialized");const n=t.sqlEditor.getValue();if(!t.connection)throw new Error("Connection is not initialized");return yield t.sqlMetaDataService.saveDbObject(t.connection.connectionName,{...t.dataObject,sqlText:n})})()}onDelete(){var t=this;return(0,_.Z)(function*(){if(!t.connection)throw new Error("Connection is not initialized");yield t.sqlMetaDataService.deleteObject(t.connection.connectionName,t.dataObject)})()}onModeState(){const t=this.modeState.parameters||this.modeState.result;this.codeContentSize=this.modeState.code&&!t?100:this.modeState.code&&t?50:0,this.parametersSize=this.modeState.parameters&&!this.modeState.result?100:this.modeState.parameters&&this.modeState.result?30:0}resize(){this.sqlEditor?.layout()}}return(o=i).\u0275fac=function(t){return new(t||o)(e.Y36(ie.g),e.Y36(ne.x),e.Y36(B.hp),e.Y36(K.gz),e.Y36(K.F0))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-db-function"]],viewQuery:function(t,n){if(1&t&&(e.Gf(gs,7),e.Gf(qe.Z,7)),2&t){let a;e.iGM(a=e.CRH())&&(n.sqlElement=a.first),e.iGM(a=e.CRH())&&(n.dataGrid=a.first)}},inputs:{dataObject:"dataObject",connection:"connection"},outputs:{functionChanged:"functionChanged"},features:[e.TTD],decls:34,vars:27,consts:[[1,"card","overflow-hidden","mb-0","w-100","h-100"],[1,"card-body","d-flex","p-0","flex-column","h-100","position-relative"],[3,"useTransition","gutterSize","dragEnd","transitionEnd"],[1,"d-flex","mb-0","position-relative",3,"size"],["area0","asSplitArea"],["left","",1,"h-100","overflow-hidden","w-100"],["sqlEditor",""],[1,"d-flex","overflow-auto","flex-column","explorer-section",3,"size"],["area1","asSplitArea"],["direction","vertical",3,"hidden","restrictMove","useTransition","gutterSize"],[3,"size"],[1,"d-flex","flex-column","p-2","h-100"],[1,"mb-2"],["rowSelection","single",1,"ag-theme-balham","h-100","w-100",3,"columnDefs","defaultColDef","rowData","gridOptions","gridReady"],[1,"d-flex","flex-column","p-2","h-100","h-100","overflow-hidden"],[1,"d-flex","flex-row"],[1,"ml-auto",3,"grid","saveToTable"],[1,"h-100","overflow-hidden",3,"dataSource","reloadCancelled"],["dataGrid",""],["class","d-flex justify-content-center align-items-center w-100 h-100 spinner flex-column",4,"ngIf"],[1,"btn-group","d-block","mode"],["ngDefaultControl","","btnCheckbox","","tabindex","0","role","button","name","mode-code","title","SQL Function panel",1,"btn","btn-secondary","btn-sm","cursor-pointer","mb-0",3,"ngModel","ngModelChange","click"],[1,"fa","fa-code","fa-lg","mr-2"],["ngDefaultControl","","btnCheckbox","","tabindex","0","role","button","name","mode-result","title","Result panel",1,"btn","btn-secondary","btn-sm","cursor-pointer","mb-0",3,"ngModel","ngModelChange","click"],[1,"fa","fa-table","fa-lg","mr-2"],["ngDefaultControl","","btnCheckbox","","tabindex","0","role","button","name","mode-parameters",1,"btn","btn-secondary","btn-sm","cursor-pointer","mb-0",3,"ngModel","ngModelChange","click"],[1,"fa","fa-check","fa-lg","mr-2"],[1,"d-flex","justify-content-center","align-items-center","w-100","h-100","spinner","flex-column"],["role","status",1,"spinner-border"],[1,"sr-only"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"as-split",2),e.NdJ("dragEnd",function(){return n.resize()})("transitionEnd",function(){return n.resize()}),e.TgZ(3,"as-split-area",3,4),e._UZ(5,"div",5,6),e.qZA(),e.TgZ(7,"as-split-area",7,8)(9,"as-split",9)(10,"as-split-area",10)(11,"div",11)(12,"h4",12),e._uU(13,"Parameters"),e.qZA(),e.TgZ(14,"ag-grid-angular",13),e.NdJ("gridReady",function(r){return n.onGridReady(r)}),e.qZA()()(),e.TgZ(15,"as-split-area",10)(16,"div",14)(17,"div",15)(18,"h4",12),e._uU(19,"Results"),e.qZA(),e._UZ(20,"app-export-menu",16),e.qZA(),e.TgZ(21,"app-ag-data-grid",17,18),e.NdJ("reloadCancelled",function(){return n.reloadCancelled()}),e.qZA()()()(),e.YNc(23,_s,4,0,"div",19),e.qZA()()()(),e.TgZ(24,"div",20)(25,"label",21),e.NdJ("ngModelChange",function(r){return n.modeState.code=r})("click",function(){return n.onModeState()}),e._UZ(26,"i",22),e._uU(27," SQL Function "),e.qZA(),e.TgZ(28,"label",23),e.NdJ("ngModelChange",function(r){return n.modeState.result=r})("click",function(){return n.onModeState()}),e._UZ(29,"i",24),e._uU(30," Results "),e.qZA(),e.TgZ(31,"label",25),e.NdJ("ngModelChange",function(r){return n.modeState.parameters=r})("click",function(){return n.onModeState()}),e._UZ(32,"i",26),e._uU(33," Parameters "),e.qZA()()),2&t){const a=e.MAs(22);e.xp6(2),e.Q6J("useTransition",!0)("gutterSize",50===n.codeContentSize?11:0),e.xp6(1),e.Q6J("size",n.codeContentSize),e.xp6(4),e.Q6J("size",100-n.codeContentSize),e.xp6(2),e.Q6J("hidden",n.loading)("restrictMove",!0)("useTransition",!0)("gutterSize",30===n.parametersSize?11:0),e.xp6(1),e.Q6J("size",n.parametersSize),e.xp6(4),e.Q6J("columnDefs",n.columnDefs)("defaultColDef",n.defaultColDef)("rowData",n.paramRows)("gridOptions",n.gridOptions),e.xp6(1),e.Q6J("size",100-n.parametersSize),e.xp6(5),e.Q6J("grid",a.grid)("saveToTable",!0),e.xp6(1),e.Q6J("dataSource",n.dataSource),e.xp6(2),e.Q6J("ngIf",n.loading),e.xp6(2),e.ekj("active",n.modeState.code),e.Q6J("ngModel",n.modeState.code),e.xp6(3),e.ekj("active",n.modeState.result),e.Q6J("ngModel",n.modeState.result),e.xp6(3),e.ekj("active",n.modeState.parameters),e.Q6J("ngModel",n.modeState.parameters)}},dependencies:[Ee.N8,we.Mq,we.zE,nt.DF,l.O5,qe.Z,un.U,u.Fj,u.JJ,u.On],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}"]}),i})();function bs(o,i){if(1&o){const s=e.EpF();e.TgZ(0,"app-db-function",2),e.NdJ("functionChanged",function(n){e.CHM(s);const a=e.oxw();return e.KtG(a.onChange(n))})("functionDeleted",function(){e.CHM(s);const n=e.oxw();return e.KtG(n.onDelete())}),e.qZA()}if(2&o){const s=e.oxw();e.Q6J("dataObject",s.dataObject)("connection",s.connection)}}function vs(o,i){1&o&&(e.TgZ(0,"div",3)(1,"div",4)(2,"span",5),e._uU(3,"Loading..."),e.qZA()()())}let ys=(()=>{var o;class i{constructor(t,n,a,r,c,d){this.notificationService=t,this.sqlMetaDataService=n,this.tabsService=a,this.authService=r,this.dbConnectionService=d,this.destroy$=new N.x,this.dataObject={},this.loading=!1,this.connections=[],this.evaluationTime=0,this.evaluating=!1,this.isActivated=!1,this.canSave=!1,this.canReload=!0,this.menuItems=[],(0,pe.setBearerToken)(r.token),(0,pe.setBaseUrl)(Ie.Z.worksheetsApi),this.menuItems.push(c.exportToCsvMenuItem(()=>this.functionComponent?.dataGrid?.grid?.rowData||[],()=>this.tabItem?.tabHeader||"")),this.menuItems.push(c.exportToExcelMenuItem(()=>this.functionComponent?.dataGrid?.grid,()=>this.tabItem?.tabHeader)),this.menuItems.push(c.saveToDatabaseMenuItem(()=>this.functionComponent?.dataGrid?.grid?.rowData||[])),this.menuItems.push({isDivider:!0}),this.menuItems.push(c.closeAllMenuItem()),this.menuItems.push(c.closeOthersMenuItem())}save(){var t=this;return(0,_.Z)(function*(){if(!t.functionComponent)throw Error("Component is not initialized");try{const n=yield t.functionComponent.onSave();t.canSave=!1,t.notificationService.success(`Function ${n.schemaName}.${n.objectName} saved`),t.tabStore?.removeChanges()}catch(n){t.notificationService.error(n)}})()}get selectedText(){return this.functionComponent?.selectedText||""}activated(){var t=this;return(0,_.Z)(function*(){t.isActivated||(t.isActivated=!0,t.dbConnectionService.dbConnectionsList$.pipe((0,y.R)(t.destroy$),(0,F.h)(n=>!!n.length)).subscribe(n=>{t.connections=n,t.initTab()})),t.functionComponent?.syncQueryParams()})()}ngOnDestroy(){this.destroy$.next(null),this.destroy$.complete()}ngOnInit(){var t=this;return(0,_.Z)(function*(){if(!t.tabItem)throw new Error("tabItem is not initialized");t.tabItem.content=t,t.authService.isAuthenticated$.pipe((0,y.R)(t.destroy$),(0,F.h)(n=>n)).subscribe(()=>{const n=t.authService.user?.userId;t.tabStore=new _t(t.tabItem,n),t.canSave=t.tabStore.hasChanges()})})()}initTab(){var t=this;return(0,_.Z)(function*(){const n=t.tabStore?.getChanges();if(n){const a=t.tabItem?.tabParams.owner;t.connection=t.connections.find(r=>r.connectionName===a),t.dataObject=n,t.canSave=!0,t.canReload=!0}else t.reload()})()}reload(){var t=this;return(0,_.Z)(function*(){if(!t.tabItem)throw new Error("tabItem is not initialized");const n=t.tabItem.tabParams.owner,a=(t.tabItem.tabParams.name||"").split("."),r=n,c=a[0],d=a[1];t.connection=t.connections.find(h=>h.connectionName===r);try{t.loading=!0,t.dataObject=yield t.sqlMetaDataService.getMetaDataObject(r,c,d,te.HA.Procedure),t.canSave=!1,t.tabStore?.removeChanges()}catch{t.notificationService.error(`Failed to load meta data ${c}.${d}`)}finally{t.loading=!1}})()}handleKeyboardEvent(t){this.tabsService.activeTab===this.tabItem&&("F5"===t.key||t.ctrlKey&&"Enter"===t.key)&&(t.preventDefault(),t.stopImmediatePropagation(),this.onRun())}onRun(){var t=this;return(0,_.Z)(function*(){if(!t.functionComponent)throw new Error("functionComponent is not initialized");t.canSave&&!t.selectedText&&(yield t.notificationService.confirmation("Do you want to save latest changes, before 'Run'?"))&&(yield t.save()),t.evaluating=!0;const n=(new Date).getTime();yield t.functionComponent.onRun(),t.evaluationTime=+new Date-n,t.evaluating=!1})()}onDelete(){var t=this;return(0,_.Z)(function*(){if(!t.functionComponent)throw new Error("functionComponent is not initialized");if(yield t.notificationService.confirmation("Are you sure you want to delete this Function?"))try{yield t.functionComponent.onDelete();const{objectName:n,schemaName:a}=t.dataObject;t.notificationService.success(`Function '${a}.${n}'' deleted`)}catch(n){t.notificationService.error(n)}})()}onChange({structure:t}){var n=this;return(0,_.Z)(function*(){n.tabStore?.saveChanges(t),n.canSave=!0})()}}return(o=i).\u0275fac=function(t){return new(t||o)(e.Y36(ie.g),e.Y36(B.hp),e.Y36(oe.x),e.Y36(B.$h),e.Y36(ye.q),e.Y36(Ae.F))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-tab-function"]],viewQuery:function(t,n){if(1&t&&e.Gf(dn,5),2&t){let a;e.iGM(a=e.CRH())&&(n.functionComponent=a.first)}},hostBindings:function(t,n){1&t&&e.NdJ("keydown",function(r){return n.handleKeyboardEvent(r)},!1,e.evT)},inputs:{tabItem:"tabItem"},decls:2,vars:2,consts:[[3,"dataObject","connection","functionChanged","functionDeleted",4,"ngIf"],["class","d-flex justify-content-center position-absolute align-items-center w-100 h-100 spinner flex-column",4,"ngIf"],[3,"dataObject","connection","functionChanged","functionDeleted"],[1,"d-flex","justify-content-center","position-absolute","align-items-center","w-100","h-100","spinner","flex-column"],["role","status",1,"spinner-border"],[1,"sr-only"]],template:function(t,n){1&t&&(e.YNc(0,bs,1,2,"app-db-function",0),e.YNc(1,vs,4,0,"div",1)),2&t&&(e.Q6J("ngIf",!n.loading&&n.dataObject&&n.connection),e.xp6(1),e.Q6J("ngIf",n.loading))},dependencies:[l.O5,dn]}),i})();const Cs=["sqlEditor"];function Ss(o,i){1&o&&(e.TgZ(0,"div",27)(1,"div",28)(2,"span",29),e._uU(3,"Loading..."),e.qZA()()())}let pn=(()=>{var o;class i{constructor(t,n,a,r,c){this.notificationService=t,this.dialogService=n,this.sqlMetaDataService=a,this.route=r,this.router=c,this.procedureChanged=new e.vpe,this.isChanged=!1,this.codeContentSize=50,this.parametersSize=30,this.modeState={code:!0,result:!0,parameters:!0},this.loading=!1,this.selectedText="",this.ConnectionLevels=me.EQ,this.paramRows=[],this.sqlEditor={},this.destroy$=new N.x,this.editorChange$=new N.x,this.defaultColDef={editable:!0,sortable:!1,suppressFiltersToolPanel:!0,suppressMovable:!0,suppressColumnsToolPanel:!0,suppressMenu:!0},this.gridOptions={},this.columnDefs=[{field:"name",width:200},{field:"value",minWidth:50},{field:"dataType",width:80},{field:"direction"},{field:"isNullable"}],this.dataSource=new bt,this.dataSource.data$.pipe((0,y.R)(this.destroy$),(0,F.h)(d=>!!d?.outputParameters)).subscribe(d=>{const h=Object.keys(d?.outputParameters);for(const m of h){const f=this.paramRows.find(C=>C.name.toLowerCase()===`@${m.toLowerCase()}`);f&&(f.value=(d?.outputParameters||{})[m])}})}reloadCancelled(){this.abortController?.abort()}ngOnInit(){if(!this.sqlElement)throw new Error("sqlElement is not initialized");if(!this.dataObject)throw new Error("dataObject is not initialized");this.sqlEditor=fe.editor.create(this.sqlElement.nativeElement,{language:"sql",value:this.dataObject.sqlText||"",tabSize:2,scrollBeyondLastLine:!1,readOnly:(this.connection?.codeAccessLevel||0)<me.EQ.SqlExecute}),this.sqlEditor.onDidChangeCursorSelection(n=>{const a=this.sqlEditor?.getModel()?.getValueInRange(this.sqlEditor?.getSelection());a!==this.selectedText&&(this.selectedText=a||"")}),this.sqlEditor.onDidChangeModelContent(()=>{this.editorChange$.next(null)}),this.editorChange$.pipe((0,y.R)(this.destroy$),(0,Me.b)(200)).subscribe(()=>{const n=this.sqlEditor.getValue();this.isChanged=this.dataObject?.sqlText!==n;const a=this.isChanged?{structure:{...this.dataObject,sqlText:n},connection:this.connection}:null;this.procedureChanged.emit(a)}),ve.z.schedule(()=>{this.resize()})}onGridReady(t){this.gridApi=t.api;const n=this.route.snapshot.queryParams;this.paramRows=(this.dataObject?.parameters||[]).map(a=>({name:a.parameterName,direction:a.parameterDirection,value:n.hasOwnProperty(a.parameterName)?n[a.parameterName]:null,isNullable:a.isNullable,dataType:a.dataType}))}ngOnDestroy(){this.destroy$.next(null),this.destroy$.complete()}ngOnChanges({dataObject:t}){t.firstChange||(this.isChanged=!1)}onRun(){var t=this;return(0,_.Z)(function*(){t.loading=!0;const n=t.paramRows.filter(r=>null!=r.value).reduce((r,c)=>(r[c.name.replace("@","")]=function Ts(o,i){return!i||(i=i.toLowerCase()).indexOf("char")>=0?o:i.indexOf("date")>=0?(0,tt.parseDatetimeOrNull)(o):i.indexOf("int")>=0||i.indexOf("float")>=0||i.indexOf("double")>=0||i.indexOf("money")>=0||i.indexOf("numeric")>=0?(0,tt.parseNumberOrNull)(o):o}(c.value,c.dataType),r),{}),a=t.paramRows.filter(r=>null!=r.value).reduce((r,c)=>(r[c.name.replace("@","")]=c.direction,r),{});try{t.abortController=new AbortController,t.selectedText?yield t.dataSource.reload({connectionName:t.connection?.connectionName||"",sql:t.selectedText},t.abortController):yield t.dataSource.reload({commandType:"StoredProcedure",connectionName:t.connection?.connectionName,sqlParams:n,sqlParamDirections:a,sql:`${t.dataObject?.schemaName}.${t.dataObject?.objectName}`},t.abortController),t.syncQueryParams()}catch(r){t.notificationService.error(r)}finally{t.loading=!1}})()}syncQueryParams(){const t=this.paramRows.filter(n=>null!==n.value).reduce((n,a)=>(n[a.name]=a.value,n),{});this.router.navigate([],{relativeTo:this.route,queryParams:t})}onSave(){var t=this;return(0,_.Z)(function*(){if(!t.dataObject)throw new Error("dataObject is not initialized");const n=t.sqlEditor.getValue();if(!t.connection)throw new Error("Connection is not initialized");return yield t.sqlMetaDataService.saveDbObject(t.connection.connectionName,{...t.dataObject,sqlText:n})})()}onDelete(){var t=this;return(0,_.Z)(function*(){if(!t.connection)throw new Error("Connection is not initialized");yield t.sqlMetaDataService.deleteObject(t.connection.connectionName,t.dataObject)})()}onModeState(){const t=this.modeState.parameters||this.modeState.result;this.codeContentSize=this.modeState.code&&!t?100:this.modeState.code&&t?50:0,this.parametersSize=this.modeState.parameters&&!this.modeState.result?100:this.modeState.parameters&&this.modeState.result?30:0}resize(){this.sqlEditor?.layout()}}return(o=i).\u0275fac=function(t){return new(t||o)(e.Y36(ie.g),e.Y36(ne.x),e.Y36(B.hp),e.Y36(K.gz),e.Y36(K.F0))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-db-procedure"]],viewQuery:function(t,n){if(1&t&&(e.Gf(Cs,7),e.Gf(qe.Z,7)),2&t){let a;e.iGM(a=e.CRH())&&(n.sqlElement=a.first),e.iGM(a=e.CRH())&&(n.dataGrid=a.first)}},inputs:{dataObject:"dataObject",connection:"connection"},outputs:{procedureChanged:"procedureChanged"},features:[e.TTD],decls:34,vars:27,consts:[[1,"card","overflow-hidden","mb-0","w-100","h-100"],[1,"card-body","d-flex","p-0","flex-column","h-100","position-relative"],[3,"useTransition","gutterSize","dragEnd","transitionEnd"],[1,"d-flex","mb-0","position-relative",3,"size"],["area0","asSplitArea"],["left","",1,"h-100","overflow-hidden","w-100"],["sqlEditor",""],[1,"d-flex","overflow-auto","flex-column","explorer-section",3,"size"],["area1","asSplitArea"],["direction","vertical",3,"hidden","restrictMove","useTransition","gutterSize"],[3,"size"],[1,"d-flex","flex-column","p-2","h-100"],[1,"mb-2"],["rowSelection","single",1,"ag-theme-balham","h-100","w-100",3,"columnDefs","defaultColDef","rowData","gridOptions","gridReady"],[1,"d-flex","flex-column","p-2","h-100","h-100","overflow-hidden"],[1,"d-flex","flex-row"],[1,"ml-auto",3,"grid","saveToTable"],[1,"h-100","overflow-hidden",3,"dataSource","reloadCancelled"],["dataGrid",""],["class","d-flex justify-content-center align-items-center w-100 h-100 spinner flex-column",4,"ngIf"],[1,"btn-group","d-block","mode"],["ngDefaultControl","","btnCheckbox","","tabindex","0","role","button","name","mode-code","title","SQL Procedure panel",1,"btn","btn-secondary","btn-sm","cursor-pointer","mb-0",3,"ngModel","ngModelChange","click"],[1,"fa","fa-code","fa-lg","mr-2"],["ngDefaultControl","","btnCheckbox","","tabindex","0","role","button","name","mode-result","title","Result panel",1,"btn","btn-secondary","btn-sm","cursor-pointer","mb-0",3,"ngModel","ngModelChange","click"],[1,"fa","fa-table","fa-lg","mr-2"],["ngDefaultControl","","btnCheckbox","","tabindex","0","role","button","name","mode-parameters",1,"btn","btn-secondary","btn-sm","cursor-pointer","mb-0",3,"ngModel","ngModelChange","click"],[1,"fa","fa-check","fa-lg","mr-2"],[1,"d-flex","justify-content-center","align-items-center","w-100","h-100","spinner","flex-column"],["role","status",1,"spinner-border"],[1,"sr-only"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"as-split",2),e.NdJ("dragEnd",function(){return n.resize()})("transitionEnd",function(){return n.resize()}),e.TgZ(3,"as-split-area",3,4),e._UZ(5,"div",5,6),e.qZA(),e.TgZ(7,"as-split-area",7,8)(9,"as-split",9)(10,"as-split-area",10)(11,"div",11)(12,"h4",12),e._uU(13,"Parameters"),e.qZA(),e.TgZ(14,"ag-grid-angular",13),e.NdJ("gridReady",function(r){return n.onGridReady(r)}),e.qZA()()(),e.TgZ(15,"as-split-area",10)(16,"div",14)(17,"div",15)(18,"h4",12),e._uU(19,"Results"),e.qZA(),e._UZ(20,"app-export-menu",16),e.qZA(),e.TgZ(21,"app-ag-data-grid",17,18),e.NdJ("reloadCancelled",function(){return n.reloadCancelled()}),e.qZA()()()(),e.YNc(23,Ss,4,0,"div",19),e.qZA()()()(),e.TgZ(24,"div",20)(25,"label",21),e.NdJ("ngModelChange",function(r){return n.modeState.code=r})("click",function(){return n.onModeState()}),e._UZ(26,"i",22),e._uU(27," SQL Procedure "),e.qZA(),e.TgZ(28,"label",23),e.NdJ("ngModelChange",function(r){return n.modeState.result=r})("click",function(){return n.onModeState()}),e._UZ(29,"i",24),e._uU(30," Results "),e.qZA(),e.TgZ(31,"label",25),e.NdJ("ngModelChange",function(r){return n.modeState.parameters=r})("click",function(){return n.onModeState()}),e._UZ(32,"i",26),e._uU(33," Parameters "),e.qZA()()),2&t){const a=e.MAs(22);e.xp6(2),e.Q6J("useTransition",!0)("gutterSize",50===n.codeContentSize?11:0),e.xp6(1),e.Q6J("size",n.codeContentSize),e.xp6(4),e.Q6J("size",100-n.codeContentSize),e.xp6(2),e.Q6J("hidden",n.loading)("restrictMove",!0)("useTransition",!0)("gutterSize",30===n.parametersSize?11:0),e.xp6(1),e.Q6J("size",n.parametersSize),e.xp6(4),e.Q6J("columnDefs",n.columnDefs)("defaultColDef",n.defaultColDef)("rowData",n.paramRows)("gridOptions",n.gridOptions),e.xp6(1),e.Q6J("size",100-n.parametersSize),e.xp6(5),e.Q6J("grid",a.grid)("saveToTable",!0),e.xp6(1),e.Q6J("dataSource",n.dataSource),e.xp6(2),e.Q6J("ngIf",n.loading),e.xp6(2),e.ekj("active",n.modeState.code),e.Q6J("ngModel",n.modeState.code),e.xp6(3),e.ekj("active",n.modeState.result),e.Q6J("ngModel",n.modeState.result),e.xp6(3),e.ekj("active",n.modeState.parameters),e.Q6J("ngModel",n.modeState.parameters)}},dependencies:[Ee.N8,we.Mq,we.zE,nt.DF,l.O5,qe.Z,un.U,u.Fj,u.JJ,u.On],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}"]}),i})();function xs(o,i){if(1&o){const s=e.EpF();e.TgZ(0,"app-db-procedure",2),e.NdJ("procedureChanged",function(n){e.CHM(s);const a=e.oxw();return e.KtG(a.onChange(n))})("procedureDeleted",function(){e.CHM(s);const n=e.oxw();return e.KtG(n.onDelete())}),e.qZA()}if(2&o){const s=e.oxw();e.Q6J("dataObject",s.dataObject)("connection",s.connection)}}function ws(o,i){1&o&&(e.TgZ(0,"div",3)(1,"div",4)(2,"span",5),e._uU(3,"Loading..."),e.qZA()()())}let ks=(()=>{var o;class i{constructor(t,n,a,r,c,d){this.notificationService=t,this.sqlMetaDataService=n,this.tabsService=a,this.authService=r,this.dbConnectionService=d,this.destroy$=new N.x,this.dataObject={},this.loading=!1,this.connections=[],this.evaluationTime=0,this.evaluating=!1,this.isActivated=!1,this.canSave=!1,this.canReload=!0,this.menuItems=[],(0,pe.setBearerToken)(r.token),(0,pe.setBaseUrl)(Ie.Z.worksheetsApi),this.menuItems.push(c.exportToCsvMenuItem(()=>this.procedureComponent?.dataGrid?.grid?.rowData||[],()=>this.tabItem?.tabHeader||"")),this.menuItems.push(c.exportToExcelMenuItem(()=>this.procedureComponent?.dataGrid?.grid,()=>this.tabItem?.tabHeader)),this.menuItems.push(c.saveToDatabaseMenuItem(()=>this.procedureComponent?.dataGrid?.grid?.rowData||[])),this.menuItems.push({isDivider:!0}),this.menuItems.push(c.closeAllMenuItem()),this.menuItems.push(c.closeOthersMenuItem())}save(){var t=this;return(0,_.Z)(function*(){if(!t.procedureComponent)throw Error("Component is not initialized");try{const n=yield t.procedureComponent.onSave();t.canSave=!1,t.notificationService.success(`Procedure ${n.schemaName}.${n.objectName} saved`),t.tabStore?.removeChanges()}catch(n){t.notificationService.error(n)}})()}get selectedText(){return this.procedureComponent?.selectedText||""}activated(){var t=this;return(0,_.Z)(function*(){t.isActivated||(t.isActivated=!0,t.dbConnectionService.dbConnectionsList$.pipe((0,y.R)(t.destroy$),(0,F.h)(n=>!!n.length)).subscribe(n=>{t.connections=n,t.initTab()})),t.procedureComponent?.syncQueryParams()})()}ngOnDestroy(){this.destroy$.next(null),this.destroy$.complete()}ngOnInit(){var t=this;return(0,_.Z)(function*(){if(!t.tabItem)throw new Error("tabItem is not initialized");t.tabItem.content=t,t.authService.isAuthenticated$.pipe((0,y.R)(t.destroy$),(0,F.h)(n=>n)).subscribe(()=>{const n=t.authService.user?.userId;t.tabStore=new _t(t.tabItem,n),t.canSave=t.tabStore.hasChanges()})})()}initTab(){var t=this;return(0,_.Z)(function*(){const n=t.tabStore?.getChanges();if(n){const a=t.tabItem?.tabParams.owner;t.connection=t.connections.find(r=>r.connectionName===a),t.dataObject=n,t.canSave=!0,t.canReload=!0}else t.reload()})()}reload(){var t=this;return(0,_.Z)(function*(){if(!t.tabItem)throw new Error("tabItem is not initialized");const n=t.tabItem.tabParams.owner,a=(t.tabItem.tabParams.name||"").split(".");t.loading=!0;const r=n,c=a[0],d=a[1];try{t.connection=t.connections.find(h=>h.connectionName===r),t.dataObject=yield t.sqlMetaDataService.getMetaDataObject(r,c,d,te.HA.Procedure),t.canSave=!1,t.tabStore?.removeChanges()}catch{t.notificationService.error(`Failed to load meta data ${c}.${d}`)}finally{t.loading=!1}})()}handleKeyboardEvent(t){this.tabsService.activeTab===this.tabItem&&("F5"===t.key||t.ctrlKey&&"Enter"===t.key)&&(t.preventDefault(),t.stopImmediatePropagation(),this.onRun())}onRun(){var t=this;return(0,_.Z)(function*(){if(!t.procedureComponent)throw new Error("procedureComponent is not initialized");t.canSave&&!t.selectedText&&(yield t.notificationService.confirmation("Do you want to save latest changes, before 'Run'?"))&&(yield t.save()),t.evaluating=!0;const n=(new Date).getTime();yield t.procedureComponent.onRun(),t.evaluationTime=+new Date-n,t.evaluating=!1})()}onDelete(){var t=this;return(0,_.Z)(function*(){if(!t.procedureComponent)throw new Error("procedureComponent is not initialized");if(yield t.notificationService.confirmation("Are you sure you want to delete this Stored Procedure?"))try{yield t.procedureComponent.onDelete();const{objectName:n,schemaName:a}=t.dataObject;t.notificationService.success(`Procedure '${a}.${n}'' deleted`)}catch(n){t.notificationService.error(n)}})()}onChange({structure:t}){var n=this;return(0,_.Z)(function*(){n.tabStore?.saveChanges(t),n.canSave=!0})()}}return(o=i).\u0275fac=function(t){return new(t||o)(e.Y36(ie.g),e.Y36(B.hp),e.Y36(oe.x),e.Y36(B.$h),e.Y36(ye.q),e.Y36(Ae.F))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-tab-procedure"]],viewQuery:function(t,n){if(1&t&&e.Gf(pn,5),2&t){let a;e.iGM(a=e.CRH())&&(n.procedureComponent=a.first)}},hostBindings:function(t,n){1&t&&e.NdJ("keydown",function(r){return n.handleKeyboardEvent(r)},!1,e.evT)},inputs:{tabItem:"tabItem"},decls:2,vars:2,consts:[[3,"dataObject","connection","procedureChanged","procedureDeleted",4,"ngIf"],["class","d-flex justify-content-center position-absolute align-items-center w-100 h-100 spinner flex-column",4,"ngIf"],[3,"dataObject","connection","procedureChanged","procedureDeleted"],[1,"d-flex","justify-content-center","position-absolute","align-items-center","w-100","h-100","spinner","flex-column"],["role","status",1,"spinner-border"],[1,"sr-only"]],template:function(t,n){1&t&&(e.YNc(0,xs,1,2,"app-db-procedure",0),e.YNc(1,ws,4,0,"div",1)),2&t&&(e.Q6J("ngIf",!n.loading&&n.dataObject&&n.connection),e.xp6(1),e.Q6J("ngIf",n.loading))},dependencies:[l.O5,pn]}),i})();var As=p(81196);function Os(o,i){if(1&o){const s=e.EpF();e.TgZ(0,"app-data-query",2,3),e.NdJ("dblClick",function(n){e.CHM(s);const a=e.oxw();return e.KtG(a.onDblClick(n))})("gridDataModified",function(n){e.CHM(s);const a=e.oxw();return e.KtG(a.onGridDataModified(n))})("queryInfoChange",function(n){e.CHM(s);const a=e.oxw();return e.KtG(a.onQueryInfoChange(n))})("additionalFiltersChange",function(n){e.CHM(s);const a=e.oxw();return e.KtG(a.onAdditionalFiltersChange(n))}),e.qZA()}if(2&o){const s=e.oxw();e.Q6J("hidden",!!s.loading)("queryInfo",s.queryInfo)("reflectUrl",!0)}}function Ms(o,i){1&o&&(e.TgZ(0,"div",4)(1,"div",5)(2,"span",6),e._uU(3,"Loading..."),e.qZA()()())}let Ds=(()=>{var o;class i{constructor(t,n,a,r,c){this.notificationService=t,this.commandsService=a,this.filtersSerializer=r,this.zone=c,this.destroy$=new N.x,this._pubSubBus={},this.canSave=!1,this.canReload=!1,this.menuItems=[],this.loading=!1,(0,pe.setBearerToken)(n.token),(0,pe.setBaseUrl)(Ie.Z.worksheetsApi),this.menuItems.push(a.exportToFileMenuItem(()=>this.dataQuery?.dataGrid?.grid,()=>this.tabItem?.tabHeader)),this.menuItems.push(a.saveToDatabaseMenuItem(()=>this.dataQuery?.dataGrid?.grid?.rowData||[])),this.menuItems.push({label:"Import CSV Data",icon:"fa-cloud-upload",click:()=>a.importCsvData()}),this.menuItems.push({isDivider:!0}),this.menuItems.push({label:"Clone as Data Query",icon:"fa-clone",click:()=>a.addDataQueryTabFromQuery(this.queryInfo)}),this.menuItems.push({label:"Design Table",icon:"fa-cog",click:()=>a.editSqlTableMetadata(this.dbItemLink)}),this.menuItems.push({label:"Delete Table",icon:"fa-times",click:()=>a.deleteSqlTable(this.dbItemLink)}),this.menuItems.push({isDivider:!0}),this.menuItems.push({label:"Generate JSPY (Sql Data Api)",click:()=>a.addSelectWithSqlDataApiJspyTab(this.queryInfo?.sqlQuery,this.dataSource?.additionalFilters)}),this.menuItems.push({label:"Generate SQL",click:()=>a.addSelectSqlTab(this.queryInfo?.sqlQuery,this.dataSource?.additionalFilters)}),this.menuItems.push({isDivider:!0}),this.menuItems.push({label:"Publish / Subscribe",icon:"fa-gg",click:()=>a.openPubSubSetting(this.queryInfo).subscribe(d=>{this.queryInfo.pubSub=d,this.onQueryInfoChange(this.queryInfo)})}),this.menuItems.push({isDivider:!0}),this.menuItems.push(a.closeAllMenuItem()),this.menuItems.push(a.closeOthersMenuItem())}get dataSource(){return this.dataQuery?.dataSource}onFiltersBarChanged(t){this.dataQuery?.onFiltersBarChanged(t)}ngOnInit(){var t=this;return(0,_.Z)(function*(){if(!t.tabItem)throw new Error("this.tabItem is not initilized");t.tabItem.content=t;const n=t.tabItem.tabParams.owner,r=t.tabItem.tabParams.name.split(".");if(3===r.length){if(t.dbItemLink={connectionName:n,schemaName:r[0],objectName:r[1],objectType:"view"===r[2].toLowerCase()?te.HA.View:te.HA.Table},t.dbItemLink.objectType===te.HA.View){const c=t.menuItems.findIndex(h=>"Design Table"===h.label);c>=0&&t.menuItems.splice(c,1,{label:"Edit View",icon:"fa-cog",click:()=>t.commandsService.editViewInNewSqlTab(t.dbItemLink)});const d=t.menuItems.find(h=>"Delete Table"===h.label);d&&(d.label="Delete View")}}else t.notificationService.error("Incorrect URL (name)")})()}ngOnDestroy(){const t=Object.keys(this._pubSubBus);for(const n of t)this._pubSubBus[n].close(),delete this._pubSubBus[n];this.destroy$.next(null),this.destroy$.complete()}save(){var t=this;return(0,_.Z)(function*(){if(!t.queryInfo)throw new Error("this.config is not initilized");if(!t.gridContext)return void t.notificationService.error("Grid Context is not initialized");const{connectionName:n,tableName:a}=t.queryInfo.sqlQuery,r=yield t.commandsService.saveGridData(n,a,t.gridContext);t.canSave=!r})()}reload(t=!1){var n=this;return(0,_.Z)(function*(){if(!n.dataQuery)throw new Error("this.config is not initilized");return!1===t?n.dataQuery?.reload():(n.queryInfo=void 0,new Promise(a=>{ve.z.schedule((0,_.Z)(function*(){n.initializeQueryInfo(),yield n.dataQuery?.reload(),n.canSave=!1,a()}))}))})()}onDblClick(t){this.queryInfo?.pubSub?.publish?.isEnabled&&3===t.cellType&&this.publishSelectedRow(this.queryInfo.pubSub.publish.topic,t.rowData)}onQueryInfoChange(t){this.subscribeOnTopic(t.pubSub?.subscribe?.isEnabled?t.pubSub?.subscribe?.topic:void 0),this.tabItem&&this.dataQuery?.queryInfoSerializer&&(this.tabItem.queryParams={...this.tabItem.queryParams,...this.dataQuery.queryInfoSerializer.serialize(t)})}onAdditionalFiltersChange(t){this.tabItem&&this.dataQuery?.queryInfoSerializer&&(this.tabItem.queryParams={...this.tabItem.queryParams,filter:this.filtersSerializer.getQueryParam(t)})}onGridDataModified(t){this.canSave=!0,this.gridContext=t}openQueryManager(){var t=this;return(0,_.Z)(function*(){if(!t.dataQuery)throw new Error("this.config is not initilized");yield t.dataQuery.openQueryManager()})()}activated(){var t=this;return(0,_.Z)(function*(){t.queryInfo||t.initializeQueryInfo()})()}subscribeOnTopic(t){this._pubSubBus[t=`${t}`]||(this._pubSubBus[t]=new BroadcastChannel(t)),this._pubSubBus[t].onmessage=n=>{const a=this.queryInfo?.pubSub?.subscribe||{};"applyFilter"===a.action&&this.zone.run(()=>this.applyFilter(a,n.data))}}publishSelectedRow(t,n){this._pubSubBus[t=`${t}`]||(this._pubSubBus[t]=new BroadcastChannel(t)),this._pubSubBus[t].postMessage(n)}applyFilter(t,n){const a=Object.entries(t.actionParams);for(let[r,c]of a)r=Object.keys(n).find(d=>d.toLowerCase()===r.toLowerCase()),c=this.queryInfo?.sqlQuery?.fields?.find(d=>d.name.toLowerCase()===c.toLowerCase())?.name,this.dataSource&&r&&c&&this.dataSource.addAdditionalFilter({columnName:c,filterValue:[n[r]],operation:He.OX.In})}initializeQueryInfo(){this.dbItemLink&&(this.queryInfo={sqlQuery:{connectionName:this.dbItemLink.connectionName,tableName:`${this.dbItemLink.schemaName}.${this.dbItemLink.objectName}`,tableAlias:"t",limitRowsCount:1e3},dataGrid:(0,He.o8)(),viewType:He.bW.DataGrid},this.queryInfo?.pubSub?.subscribe?.isEnabled&&this.subscribeOnTopic(this.queryInfo.pubSub.subscribe.topic))}}return(o=i).\u0275fac=function(t){return new(t||o)(e.Y36(ie.g),e.Y36(B.$h),e.Y36(ye.q),e.Y36(As.R),e.Y36(e.R0b))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-tab-db-table"]],viewQuery:function(t,n){if(1&t&&e.Gf(et.n,5),2&t){let a;e.iGM(a=e.CRH())&&(n.dataQuery=a.first)}},inputs:{tabItem:"tabItem"},decls:2,vars:2,consts:[["class","h-100",3,"hidden","queryInfo","reflectUrl","dblClick","gridDataModified","queryInfoChange","additionalFiltersChange",4,"ngIf"],["class","d-flex justify-content-center position-absolute align-items-center w-100 h-100 spinner flex-column",4,"ngIf"],[1,"h-100",3,"hidden","queryInfo","reflectUrl","dblClick","gridDataModified","queryInfoChange","additionalFiltersChange"],["dataQuery",""],[1,"d-flex","justify-content-center","position-absolute","align-items-center","w-100","h-100","spinner","flex-column"],["role","status",1,"spinner-border"],[1,"sr-only"]],template:function(t,n){1&t&&(e.YNc(0,Os,2,3,"app-data-query",0),e.YNc(1,Ms,4,0,"div",1)),2&t&&(e.Q6J("ngIf",n.queryInfo),e.xp6(1),e.Q6J("ngIf",n.loading))},dependencies:[l.O5,et.n]}),i})();const Ps=function(o,i){return["/data-studio","app",o,i]},Es=function(o){return{file:o}};function Is(o,i){if(1&o&&(e.TgZ(0,"div",8),e._UZ(1,"i"),e.TgZ(2,"a",9),e._uU(3),e.qZA()()),2&o){const s=i.$implicit,t=e.oxw(2);e.xp6(1),e.Gre("ml-3 fa ",t.getIcon(s.contentType),""),e.xp6(1),e.Q6J("routerLink",e.WLB(6,Ps,null==t.currentApp?null:t.currentApp.appOwner,null==t.currentApp?null:t.currentApp.appName))("queryParams",e.VKq(9,Es,t.fromPathFile(s))),e.xp6(1),e.Oqu(t.fromPathFile(s).replace("/"," / "))}}function Fs(o,i){if(1&o&&(e.TgZ(0,"div",5)(1,"h2",6),e._uU(2),e.qZA(),e.YNc(3,Is,4,11,"div",7),e.qZA()),2&o){const s=e.oxw();e.xp6(2),e.AsE("",null==s.currentApp?null:s.currentApp.appOwner," / ",null==s.currentApp?null:s.currentApp.appName,""),e.xp6(1),e.Q6J("ngForOf",s.links)}}let Ns=(()=>{var o;class i{constructor(t,n){this.studioService=t,this.appService=n,this.destroy$=new N.x,this.currentApp=null,this.links=null}ngOnInit(){var t=this;return(0,_.Z)(function*(){var n;t.studioService.currentApp$.pipe((0,y.R)(t.destroy$)).subscribe(function(a){return(n=n||(0,_.Z)(function*(r){return yield t.onAppChanged(r)})).apply(this,arguments)})})()}ngOnDestroy(){this.destroy$.next(null),this.destroy$.complete()}onAppChanged(t){var n=this;return(0,_.Z)(function*(){n.currentApp=t,t&&(n.links=yield n.appService.loadAppFileLinks(t.appOwner,t.appName,!0))})()}getIcon(t){return Gt(t)}fromPathFile(t){return(0,O.nV)(t)}}return(o=i).\u0275fac=function(t){return new(t||o)(e.Y36(ee.F),e.Y36(B.UW))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-welcome-project"]],decls:6,vars:1,consts:[[1,"h-100","w-100","overflow-auto"],[1,"d-flex","flex-column","w-100","container"],[1,"d-flex","flex-column","flex-md-row","w-100"],["class","flex-fill w-100 d-flex flex-column pt-4",4,"ngIf"],[1,"flex-fill","w-100"],[1,"flex-fill","w-100","d-flex","flex-column","pt-4"],[1,"pr-2"],["class","d-flex flex-row align-items-center",4,"ngFor","ngForOf"],[1,"d-flex","flex-row","align-items-center"],[1,"btn-link","ml-2",3,"routerLink","queryParams"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e.YNc(3,Fs,4,3,"div",3),e.TgZ(4,"div",4),e._UZ(5,"app-welcome-core"),e.qZA()()()()),2&t&&(e.xp6(3),e.Q6J("ngIf",null==n.currentApp?null:n.currentApp.appOwner))},dependencies:[l.sg,l.O5,dt.P,K.rH],styles:['[_ngcontent-%COMP%]:root{--bg: #fff;--body-bg: #e4e5e6;--header-bg: #ebedef;--color: #4f5d73;--border-color: #c4c9d0;--ws-alt: #f7f7f7;--form-input-bg: #fff;--form-input-color: #768192;--nav-link-color: #8a93a2;--secondary-color: #c4c9d0;--opacity: .05;--hover: "#f0f3f5";--ag-edited-cell-bg: "rgba(255, 218, 218, 0.6)";--ag-added-cell-bg: "rgba(226, 255, 226, 0.5)"}[_nghost-%COMP%]{display:flex;background:var(--bg);height:100%}ul[_ngcontent-%COMP%]{padding-inline-start:.8em}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{list-style:none}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#20a8d8}']}),i})();function Zs(o,i){if(1&o&&(e.TgZ(0,"span",9),e._uU(1),e.qZA()),2&o){const s=e.oxw().$implicit;e.oxw();const t=e.MAs(5);e.Q6J("cdkContextMenuTriggerFor",t)("title",s.tabId),e.xp6(1),e.AsE("",null!=s&&null!=s.content&&s.content.canSave?"* ":"","",s.tabHeader,"")}}function Rs(o,i){if(1&o&&e._UZ(0,"app-tab-jspy",10),2&o){const s=e.oxw().$implicit;e.Q6J("tabItem",s)}}function qs(o,i){if(1&o&&e._UZ(0,"app-tab-dcml",10),2&o){const s=e.oxw().$implicit;e.Q6J("tabItem",s)}}function Js(o,i){if(1&o&&e._UZ(0,"app-tab-js",10),2&o){const s=e.oxw().$implicit;e.Q6J("tabItem",s)}}function Ls(o,i){if(1&o&&e._UZ(0,"app-tab-json",10),2&o){const s=e.oxw().$implicit;e.Q6J("tabItem",s)}}function js(o,i){if(1&o&&e._UZ(0,"app-tab-data-query",10),2&o){const s=e.oxw().$implicit;e.Q6J("tabItem",s)}}function Hs(o,i){if(1&o&&e._UZ(0,"app-tab-db-table",10),2&o){const s=e.oxw().$implicit;e.Q6J("tabItem",s)}}function Qs(o,i){if(1&o&&e._UZ(0,"app-tab-db-table",10),2&o){const s=e.oxw().$implicit;e.Q6J("tabItem",s)}}function Bs(o,i){if(1&o&&e._UZ(0,"app-tab-procedure",10),2&o){const s=e.oxw().$implicit;e.Q6J("tabItem",s)}}function Ys(o,i){if(1&o&&e._UZ(0,"app-tab-function",10),2&o){const s=e.oxw().$implicit;e.Q6J("tabItem",s)}}function zs(o,i){if(1&o&&e._UZ(0,"app-tab-sql",10),2&o){const s=e.oxw().$implicit;e.Q6J("tabItem",s)}}function $s(o,i){if(1&o&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&o){const s=e.oxw().$implicit;e.xp6(1),e.hij(" ",s.tabHeader," ")}}function Us(o,i){if(1&o){const s=e.EpF();e.TgZ(0,"tab",4),e.NdJ("removed",function(){const a=e.CHM(s).$implicit,r=e.oxw();return e.KtG(r.onTabRemove(a))})("selectTab",function(){const a=e.CHM(s).$implicit,r=e.oxw();return e.KtG(r.onSelectTab(a))}),e.YNc(1,Zs,2,4,"ng-template",5),e.ynx(2,6),e.YNc(3,Rs,1,1,"app-tab-jspy",7),e.YNc(4,qs,1,1,"app-tab-dcml",7),e.YNc(5,Js,1,1,"app-tab-js",7),e.YNc(6,Ls,1,1,"app-tab-json",7),e.YNc(7,js,1,1,"app-tab-data-query",7),e.YNc(8,Hs,1,1,"app-tab-db-table",7),e.YNc(9,Qs,1,1,"app-tab-db-table",7),e.YNc(10,Bs,1,1,"app-tab-procedure",7),e.YNc(11,Ys,1,1,"app-tab-function",7),e.YNc(12,zs,1,1,"app-tab-sql",7),e.YNc(13,$s,2,1,"div",8),e.BQk(),e.qZA()}if(2&o){const s=i.$implicit;e.Q6J("removable",!0)("id",s.tabId),e.xp6(2),e.Q6J("ngSwitch",s.tabType),e.xp6(1),e.Q6J("ngSwitchCase","jspy"),e.xp6(1),e.Q6J("ngSwitchCase","dcml"),e.xp6(1),e.Q6J("ngSwitchCase","js"),e.xp6(1),e.Q6J("ngSwitchCase","json"),e.xp6(1),e.Q6J("ngSwitchCase","query"),e.xp6(1),e.Q6J("ngSwitchCase","table"),e.xp6(1),e.Q6J("ngSwitchCase","view"),e.xp6(1),e.Q6J("ngSwitchCase","procedure"),e.xp6(1),e.Q6J("ngSwitchCase","function"),e.xp6(1),e.Q6J("ngSwitchCase","sql")}}function Gs(o,i){if(1&o){const s=e.EpF();e.TgZ(0,"button",15),e.NdJ("cdkMenuItemTriggered",function(){e.CHM(s);const n=e.oxw().$implicit,a=e.oxw(2);return e.KtG(a.onContextMenuClick(n))}),e._UZ(1,"i"),e._uU(2),e.qZA()}if(2&o){const s=e.oxw().$implicit;e.xp6(1),e.Gre("fa ",s.icon||"fa-circle-thin"," mr-2"),e.xp6(1),e.hij("",s.label," ")}}function Vs(o,i){1&o&&e._UZ(0,"hr")}function Ks(o,i){if(1&o&&(e.ynx(0),e.YNc(1,Gs,3,4,"button",13),e.YNc(2,Vs,1,0,"hr",14),e.BQk()),2&o){const s=i.$implicit;e.xp6(1),e.Q6J("ngIf",!s.isDivider),e.xp6(1),e.Q6J("ngIf",s.isDivider)}}function Xs(o,i){if(1&o&&(e.TgZ(0,"div",11),e.YNc(1,Ks,3,2,"ng-container",12),e.qZA()),2&o){const s=e.oxw();e.xp6(1),e.Q6J("ngForOf",s.activeTabMenuItems)}}let Ws=(()=>{var o;class i{constructor(t,n,a){this.tabsService=t,this.router=n,this.route=a,this.activeTabMenuItems=[],this.contentsToResize=new Set,this.destroy$=new N.x,this.tabs=t.tabs,t.activeTab$.subscribe(r=>{this.activeTabMenuItems.splice(0,this.activeTabMenuItems.length),r?.content?.menuItems?.forEach(c=>this.activeTabMenuItems.push(c))})}ngOnInit(){var t=this;return(0,_.Z)(function*(){var n;t.subscribeOnRouter(),t.tabsService.activeTab$.pipe((0,y.R)(t.destroy$),(0,F.h)(a=>!!a)).subscribe(function(a){return(n=n||(0,_.Z)(function*(r){return yield t.selectTab(r)})).apply(this,arguments)})})()}ngOnDestroy(){this.destroy$.next(null),this.destroy$.complete(),this.tabsService.removeAllTabs(),this.tabsService.destroy()}onTabRemove(t){let n=this.tabsService.tabs.indexOf(t);if(n<0)return;const a=this.tabsService.activeTab?.tabId===t.tabId;this.tabsService.removeTab(t),"function"==typeof t.content.deleteLocalChanges&&t.content.deleteLocalChanges(),a&&this.tabsService.tabs.length?this.onSelectTab(this.tabsService.tabs[Math.max(0,n-1)]):this.tabsService.tabs.length||this.router.navigate([],{relativeTo:this.route,queryParams:{}})}onSelectTab(t){const{appOrSql:n,owner:a,name:r}=t.tabParams;this.router.navigate([`data-studio/${n}`,a,r],{queryParams:t.queryParams})}resize(){const t=this.tabsService.activeTab;t&&(t.content?.resize?.(),this.tabs.forEach(n=>{n!==t&&this.contentsToResize.add(n.content)}))}selectTab(t){var n=this;return(0,_.Z)(function*(){if(!n.tabset)throw new Error("this.tabset is not initilized");const a=(n.tabset?.tabs||[]).map(r=>r.id).indexOf(n.tabsService.getTabKey(t));-1!==a&&(n.tabset.tabs[a].active=!0,"function"==typeof t.content?.activated?(yield t.content.activated(),n.contentsToResize.has(t.content)&&(t.content.resize?.(),n.contentsToResize.delete(t.content))):console.warn("activate is not implemented here"))})()}subscribeOnRouter(){this.route.queryParams.pipe((0,y.R)(this.destroy$),(0,F.h)(t=>"app"===this.route.snapshot.params.appOrSql&&t.file)).subscribe(t=>this.tabsService.activateTab(this.createAppContentTabFromUrl())),this.route.params.pipe((0,y.R)(this.destroy$),(0,F.h)(t=>"sql"===t.appOrSql)).subscribe(t=>this.tabsService.activateTab(this.createSqlTabFromUrl()))}createAppContentTabFromUrl(){const{appOrSql:t}=this.route.snapshot.params,{file:r}=this.route.snapshot.queryParams;if("app"!==t||!r)throw new Error("Can't create App Content Tab. appOrSql !== 'app' || !file ");const c=(0,O.x2)(r);let d=`${c.name||""}${c.name?".":""}${c.contentType}`;d=d.length<25?d:"..."+d.substring(d.length-25);const{params:h,queryParams:m}=this.route.snapshot,f={...h,...m};return new rn.E({tabId:this.tabsService.getTabKeyFromUrlParams(h,m),queryParams:m,tabParams:f,tabType:c.contentType,tabHeader:d})}createSqlTabFromUrl(){const t=this.route.snapshot.params.name,n=`${t.substring(0,t.lastIndexOf("."))}`,{params:a,queryParams:r}=this.route.snapshot,c={...a,...r},d=String(t).toLowerCase().substring(String(t).lastIndexOf(".")+1);return new rn.E({tabHeader:n,tabType:d,queryParams:r,tabParams:c,tabId:this.tabsService.getTabKeyFromUrlParams(a,r)})}onContextMenuClick(t){const n=this.tabsService.activeTab?.content?.menuItems?.find(a=>a.label===t.label);n?.click(n)}}return(o=i).\u0275fac=function(t){return new(t||o)(e.Y36(oe.x),e.Y36(K.F0),e.Y36(K.gz))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-tabs"]],viewQuery:function(t,n){if(1&t&&e.Gf(Se.AH,7),2&t){let a;e.iGM(a=e.CRH())&&(n.tabset=a.first)}},hostBindings:function(t,n){1&t&&e.NdJ("resize",function(r){return n.resize(r)},!1,e.Jf7)},decls:6,vars:3,consts:[[1,"h-100",3,"hidden"],[1,"tabset-fx","nav-tabs-boxed","overflow-hidden",3,"hidden"],[3,"removable","id","removed","selectTab",4,"ngFor","ngForOf"],["ctxMenu",""],[3,"removable","id","removed","selectTab"],["tabHeading",""],[3,"ngSwitch"],["class","h-100 w-100",3,"tabItem",4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"cdkContextMenuTriggerFor","title"],[1,"h-100","w-100",3,"tabItem"],["cdkMenu","",1,"context-menu"],[4,"ngFor","ngForOf"],["class","context-menu-item","cdkMenuItem","",3,"cdkMenuItemTriggered",4,"ngIf"],[4,"ngIf"],["cdkMenuItem","",1,"context-menu-item",3,"cdkMenuItemTriggered"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"app-welcome-project"),e.qZA(),e.TgZ(2,"tabset",1),e.YNc(3,Us,14,13,"tab",2),e.qZA(),e.YNc(4,Xs,2,1,"ng-template",null,3,e.W1O)),2&t&&(e.Q6J("hidden",!!n.tabs.length),e.xp6(2),e.Q6J("hidden",!n.tabs.length),e.xp6(1),e.Q6J("ngForOf",n.tabs))},dependencies:[Jt,De,Lt,l.sg,l.O5,l.RF,l.n9,l.ED,Se.wW,Se.AH,Se.y3,ts,is,ss,rs,us,ms,ys,ks,Ds,Ns],styles:['tabset[_ngcontent-%COMP%]     .bs-remove-tab{visibility:hidden;position:relative}tabset[_ngcontent-%COMP%]     .bs-remove-tab:after{content:"\\f00d";font-family:FontAwesome;color:inherit;position:absolute;visibility:visible;right:0}tabset[_ngcontent-%COMP%]     .tab-content{position:relative}']}),i})();var ea=p(22096),ta=p(37398),na=p(58504);let hn=(()=>{var o;class i{constructor(t,n,a){this.router=t,this.authenticationService=n,this.appStateService=a}canActivate(t,n){var a=this;return(0,_.Z)(function*(){const{appOrSql:r,owner:c,name:d}=t.params;return d!==le.b5&&a.appStateService.setAppOrSql(r),"app"===r&&d===le.b5||("app"===r?yield(0,$t.n)(a.navigateToApp(c,d)):"sql"===r&&a.navigateToSql(c,d))})()}navigateToApp(t,n){return t===le.m5||n===le.b5?(this.appStateService.setCurrentApp(null),(0,ea.of)(!0)):this.appStateService.getApp(t,n).pipe((0,ta.U)(a=>(a||(0,na._)(`No access to application ${t}/${n}`),this.appStateService.setCurrentApp(a),!!a)))}navigateToSql(t,n){return this.appStateService.setCurrentConnection(t),!0}}return(o=i).\u0275fac=function(t){return new(t||o)(e.LFG(K.F0),e.LFG(B.$h),e.LFG(ee.F))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac}),i})(),fn=(()=>{var o;class i{constructor(t,n){this.router=t,this.studioStateService=n}canActivate(t,n){const{connection:a}=t.params;return this.studioStateService.setAppOrSql("sql"),this.studioStateService.setCurrentConnection(a),!0}}return(o=i).\u0275fac=function(t){return new(t||o)(e.LFG(K.F0),e.LFG(ee.F))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac}),i})();const ia=[{path:"editors",loadChildren:()=>p.e(964).then(p.bind(p,50964)).then(o=>o.EditorModule)},{path:"",component:Go,children:[{path:"",component:dt.P},{path:"sql/:connection",canActivate:[fn],component:dt.P},{path:":appOrSql/:owner/:name",component:Ws,canActivate:[hn]}]}];let oa=(()=>{var o;class i{}return(o=i).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[K.Bz.forChild(ia),K.Bz]}),i})();var sa=p(20362),aa=p(52667);let ra=(()=>{var o;class i{}return(o=i).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[l.ez,ut.nM,u.u5,jt.fx.forRoot(),G.mr.forRoot(),nt.Fq.forRoot()]}),i})();var la=p(2268);let ca=(()=>{var o;class i{}return(o=i).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[hn,gt,ye.q,fn,ee.F,ne.x,Ne.j5,Ht.h,oe.x],imports:[jt.fx.forRoot(),Ee.sF,ut.nM,we.fX,G.mr.forRoot(),nt.Fq.forRoot(),Gn,l.ez,Vn.I,sa.T,oa,u.u5,se.JF,aa.c,Ke.A0,on.UU.forRoot(),ra,Se.P4.forRoot(),la.z8.forRoot()]}),i})()},37282:(Je,ae,p)=>{p.d(ae,{DF:()=>e,Fq:()=>V});var l=p(65879),u=p(56223);const se={provide:u.JU,useExisting:(0,l.Gpc)(()=>e),multi:!0};let e=(()=>{var y;class J{constructor(){this.btnCheckboxTrue=!0,this.btnCheckboxFalse=!1,this.state=!1,this.isDisabled=!1,this.onChange=Function.prototype,this.onTouched=Function.prototype}onClick(){this.isDisabled||(this.toggle(!this.state),this.onChange(this.value))}ngOnInit(){this.toggle(this.trueValue===this.value)}get trueValue(){return!(typeof this.btnCheckboxTrue<"u")||this.btnCheckboxTrue}get falseValue(){return typeof this.btnCheckboxFalse<"u"&&this.btnCheckboxFalse}toggle(b){this.state=b,this.value=this.state?this.trueValue:this.falseValue}writeValue(b){this.state=this.trueValue===b,this.value=b?this.trueValue:this.falseValue}setDisabledState(b){this.isDisabled=b}registerOnChange(b){this.onChange=b}registerOnTouched(b){this.onTouched=b}}return(y=J).\u0275fac=function(b){return new(b||y)},y.\u0275dir=l.lG2({type:y,selectors:[["","btnCheckbox",""]],hostVars:3,hostBindings:function(b,k){1&b&&l.NdJ("click",function(){return k.onClick()}),2&b&&(l.uIk("aria-pressed",k.state),l.ekj("active",k.state))},inputs:{btnCheckboxTrue:"btnCheckboxTrue",btnCheckboxFalse:"btnCheckboxFalse"},features:[l._Bn([se])]}),J})();const X={provide:u.JU,useExisting:(0,l.Gpc)(()=>E),multi:!0};let E=(()=>{var y;class J{get value(){return this.group?this.group.value:this._value}set value(b){this.group?this.group.value=b:(this._value=b,this._onChange(b))}get disabled(){return this._disabled}set disabled(b){this.setDisabledState(b)}get controlOrGroupDisabled(){return!!(this.disabled||this.group&&this.group.disabled)||void 0}get hasDisabledClass(){return this.controlOrGroupDisabled&&!this.isActive}get isActive(){return this.btnRadio===this.value}get tabindex(){if(!this.controlOrGroupDisabled)return this.isActive||null==this.group?0:-1}get hasFocus(){return this._hasFocus}constructor(b,k,H,x){this.el=b,this.cdr=k,this.renderer=H,this.group=x,this.onChange=Function.prototype,this.onTouched=Function.prototype,this.uncheckable=!1,this.role="radio",this._disabled=!1,this._hasFocus=!1}toggleIfAllowed(){this.canToggle()&&(this.value=this.uncheckable&&this.btnRadio===this.value?void 0:this.btnRadio)}onSpacePressed(b){this.toggleIfAllowed(),b.preventDefault()}focus(){this.el.nativeElement.focus()}onFocus(){this._hasFocus=!0}onBlur(){this._hasFocus=!1,this.onTouched()}canToggle(){return!this.controlOrGroupDisabled&&(this.uncheckable||this.btnRadio!==this.value)}ngOnChanges(b){"uncheckable"in b&&(this.uncheckable=!1!==this.uncheckable&&typeof this.uncheckable<"u")}_onChange(b){this.group?this.group.value=b:(this.onTouched(),this.onChange(b))}writeValue(b){this.value=b,this.cdr.markForCheck()}registerOnChange(b){this.onChange=b}registerOnTouched(b){this.onTouched=b}setDisabledState(b){this._disabled=b,b?this.renderer.setAttribute(this.el.nativeElement,"disabled","disabled"):this.renderer.removeAttribute(this.el.nativeElement,"disabled")}}return(y=J).\u0275fac=function(b){return new(b||y)(l.Y36(l.SBq),l.Y36(l.sBO),l.Y36(l.Qsj),l.Y36((0,l.Gpc)(()=>F),8))},y.\u0275dir=l.lG2({type:y,selectors:[["","btnRadio",""]],hostVars:8,hostBindings:function(b,k){1&b&&l.NdJ("click",function(){return k.toggleIfAllowed()})("keydown.space",function(x){return k.onSpacePressed(x)})("focus",function(){return k.onFocus()})("blur",function(){return k.onBlur()}),2&b&&(l.uIk("aria-disabled",k.controlOrGroupDisabled)("aria-checked",k.isActive)("role",k.role)("tabindex",k.tabindex),l.ekj("disabled",k.hasDisabledClass)("active",k.isActive))},inputs:{btnRadio:"btnRadio",uncheckable:"uncheckable",value:"value",disabled:"disabled"},features:[l._Bn([X]),l.TTD]}),J})();const U={provide:u.JU,useExisting:(0,l.Gpc)(()=>F),multi:!0};let F=(()=>{var y;class J{constructor(b){this.cdr=b,this.onChange=Function.prototype,this.onTouched=Function.prototype,this.role="radiogroup",this._disabled=!1}get value(){return this._value}set value(b){this._value=b,this.onChange(b)}get disabled(){return this._disabled}get tabindex(){return this._disabled?null:0}writeValue(b){this._value=b,this.cdr.markForCheck()}registerOnChange(b){this.onChange=b}registerOnTouched(b){this.onTouched=b}setDisabledState(b){this.radioButtons&&(this._disabled=b,this.radioButtons.forEach(k=>{k.setDisabledState(b)}),this.cdr.markForCheck())}onFocus(){if(this._disabled)return;const b=this.getActiveOrFocusedRadio();if(b)b.focus();else if(this.radioButtons){const k=this.radioButtons.find(H=>!H.disabled);k&&k.focus()}}onBlur(){this.onTouched&&this.onTouched()}selectNext(b){this.selectInDirection("next"),b.preventDefault()}selectPrevious(b){this.selectInDirection("previous"),b.preventDefault()}selectInDirection(b){if(this._disabled)return;function k(x,W){let z=(x+("next"===b?1:-1))%W.length;return z<0&&(z=W.length-1),z}const H=this.getActiveOrFocusedRadio();if(H&&this.radioButtons){const x=this.radioButtons.toArray(),W=x.indexOf(H);for(let I=k(W,x);I!==W;I=k(I,x))if(x[I].canToggle()){x[I].toggleIfAllowed(),x[I].focus();break}}}getActiveOrFocusedRadio(){if(this.radioButtons)return this.radioButtons.find(b=>b.isActive)||this.radioButtons.find(b=>b.hasFocus)}}return(y=J).\u0275fac=function(b){return new(b||y)(l.Y36(l.sBO))},y.\u0275dir=l.lG2({type:y,selectors:[["","btnRadioGroup",""]],contentQueries:function(b,k,H){if(1&b&&l.Suo(H,E,4),2&b){let x;l.iGM(x=l.CRH())&&(k.radioButtons=x)}},hostVars:2,hostBindings:function(b,k){1&b&&l.NdJ("focus",function(){return k.onFocus()})("blur",function(){return k.onBlur()})("keydown.ArrowRight",function(x){return k.selectNext(x)})("keydown.ArrowDown",function(x){return k.selectNext(x)})("keydown.ArrowLeft",function(x){return k.selectPrevious(x)})("keydown.ArrowUp",function(x){return k.selectPrevious(x)}),2&b&&l.uIk("role",k.role)("tabindex",k.tabindex)},features:[l._Bn([U])]}),J})(),V=(()=>{var y;class J{static forRoot(){return{ngModule:J,providers:[]}}}return(y=J).\u0275fac=function(b){return new(b||y)},y.\u0275mod=l.oAB({type:y}),y.\u0275inj=l.cJS({}),J})()}}]);